nohup: ignoring input
Your CPU supports instructions that this binary was not compiled to use: SSE4.1 SSE4.2 AVX
For maximum performance, you can install NMSLIB from sources 
pip install --no-binary :all: nmslib
./bin/hoppy-sample-cli.py --train /home/baadalvm/ctp/data/nations/train.tsv --test /home/baadalvm/ctp/data/nations/test.tsv --dev /home/baadalvm/ctp/data/nations/dev.tsv -e 20 -b 100 --seed 1 --eval-batch-size 100 --save nations_params.txt -k 100
{'GNTP_R': None,
 'N2': None,
 'N3': None,
 'batch_size': 100,
 'dev': '/home/baadalvm/ctp/data/nations/dev.tsv',
 'embedding_size': 100,
 'epochs': 20,
 'eval_batch_size': 100,
 'freeze_entities': None,
 'hops': ['1', '2'],
 'index_type': 'faiss',
 'init': 'uniform',
 'init_size': 1.0,
 'input_type': 'standard',
 'k_max': 3,
 'learning_rate': 0.001,
 'load': None,
 'lower_bound': -1.0,
 'nb_negatives': 1,
 'nb_rules': 4,
 'optimizer': 'adam',
 'quiet': False,
 'ref_init': 'uniform',
 'reformulator': 'linear',
 'refresh_interval': None,
 'save': 'nations_params.txt',
 'seed': 1,
 'slow_eval': False,
 'test': '/home/baadalvm/ctp/data/nations/test.tsv',
 'test_i': None,
 'test_ii': None,
 'train': '/home/baadalvm/ctp/data/nations/train.tsv',
 'upper_bound': 1.0,
 'validate_every': None}
INFO:hoppy-sample-cli.py:Device: cpu
triples reading and predicates.. Done!
size of training triples is  1592
reciprocals.. Done!
Read all test, train, dev triples..!
size of all triples is  1992
entity indexes are set!
for loop is done..!
INFO:hoppy-sample-cli.py:	torch.Size([100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([14, 100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([100])	cpu
INFO:hoppy-sample-cli.py:	torch.Size([55, 100])	cpu

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.062 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.062    1.062 simple.py:52(score)
        3    0.000    0.000    1.056    0.352 profilehooks.py:257(new_fn)
        3    0.001    0.000    1.056    0.352 profilehooks.py:348(__call__)
        3    0.001    0.000    1.018    0.339 kb.py:122(neighbors)
        9    0.880    0.098    0.881    0.098 nms.py:31(build)
        2    0.001    0.000    0.724    0.362 kb.py:75(score)
        1    0.000    0.000    0.331    0.331 simple.py:29(hop)
        1    0.000    0.000    0.331    0.331 kb.py:156(forward)
        3    0.123    0.041    0.124    0.041 nms.py:51(query)
       18    0.024    0.001    0.024    0.001 {built-in method cat}
    18/15    0.000    0.000    0.014    0.001 module.py:715(_call_impl)
       13    0.000    0.000    0.010    0.001 sparse.py:123(forward)
       13    0.000    0.000    0.009    0.001 functional.py:1774(embedding)
       13    0.009    0.001    0.009    0.001 {built-in method embedding}
        3    0.005    0.002    0.008    0.003 gaussian.py:28(__call__)
        3    0.000    0.000    0.007    0.002 kb.py:68(generate_facts)
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
       15    0.004    0.000    0.004    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        1    0.000    0.000    0.000    0.000 {built-in method min}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 1/16	Loss 7.666725

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.047 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.047    1.047 simple.py:52(score)
        3    0.000    0.000    1.045    0.348 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.045    0.348 profilehooks.py:348(__call__)
        3    0.001    0.000    1.022    0.341 kb.py:122(neighbors)
        9    0.864    0.096    0.865    0.096 nms.py:31(build)
        2    0.000    0.000    0.692    0.346 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.352    0.352 kb.py:156(forward)
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 2/16	Loss 7.611594

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.233 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.233    1.233 simple.py:52(score)
        3    0.000    0.000    1.231    0.410 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.231    0.410 profilehooks.py:348(__call__)
        3    0.001    0.000    1.214    0.405 kb.py:122(neighbors)
        9    0.972    0.108    0.973    0.108 nms.py:31(build)
        2    0.000    0.000    0.836    0.418 kb.py:75(score)
        1    0.000    0.000    0.395    0.395 simple.py:29(hop)
        1    0.000    0.000    0.395    0.395 kb.py:156(forward)
        3    0.235    0.078    0.236    0.079 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 3/16	Loss 7.536008

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.090 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.090    1.090 simple.py:52(score)
        3    0.000    0.000    1.087    0.362 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.087    0.362 profilehooks.py:348(__call__)
        3    0.001    0.000    1.070    0.357 kb.py:122(neighbors)
        9    0.875    0.097    0.876    0.097 nms.py:31(build)
        2    0.000    0.000    0.746    0.373 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.341    0.341 kb.py:156(forward)
        3    0.188    0.063    0.189    0.063 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 4/16	Loss 7.568010

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.165 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.165    1.165 simple.py:52(score)
        3    0.000    0.000    1.163    0.388 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.163    0.388 profilehooks.py:348(__call__)
        3    0.001    0.000    1.142    0.381 kb.py:122(neighbors)
        9    0.988    0.110    0.988    0.110 nms.py:31(build)
        2    0.000    0.000    0.790    0.395 kb.py:75(score)
        1    0.000    0.000    0.373    0.373 simple.py:29(hop)
        1    0.000    0.000    0.373    0.373 kb.py:156(forward)
        3    0.148    0.049    0.149    0.050 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 5/16	Loss 7.505320

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.078 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.078    1.078 simple.py:52(score)
        3    0.000    0.000    1.076    0.359 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.076    0.359 profilehooks.py:348(__call__)
        3    0.001    0.000    1.065    0.355 kb.py:122(neighbors)
        9    0.891    0.099    0.892    0.099 nms.py:31(build)
        2    0.000    0.000    0.753    0.376 kb.py:75(score)
        1    0.000    0.000    0.323    0.323 simple.py:29(hop)
        1    0.000    0.000    0.323    0.323 kb.py:156(forward)
        3    0.167    0.056    0.169    0.056 nms.py:51(query)
       18    0.004    0.000    0.004    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.000    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 6/16	Loss 7.527532

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.158 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.158    1.158 simple.py:52(score)
        3    0.000    0.000    1.155    0.385 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.155    0.385 profilehooks.py:348(__call__)
        3    0.001    0.000    1.136    0.379 kb.py:122(neighbors)
        9    0.984    0.109    0.985    0.109 nms.py:31(build)
        2    0.000    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.342    0.342 simple.py:29(hop)
        1    0.000    0.000    0.342    0.342 kb.py:156(forward)
        3    0.146    0.049    0.147    0.049 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 7/16	Loss 7.398645

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.156 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.156    1.156 simple.py:52(score)
        3    0.000    0.000    1.154    0.385 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.154    0.385 profilehooks.py:348(__call__)
        3    0.001    0.000    1.143    0.381 kb.py:122(neighbors)
        9    0.942    0.105    0.943    0.105 nms.py:31(build)
        2    0.000    0.000    0.785    0.392 kb.py:75(score)
        1    0.000    0.000    0.369    0.369 simple.py:29(hop)
        1    0.000    0.000    0.369    0.369 kb.py:156(forward)
        3    0.194    0.065    0.195    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.000    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 8/16	Loss 7.543149

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.062 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.062    1.062 simple.py:52(score)
        3    0.000    0.000    1.056    0.352 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.056    0.352 profilehooks.py:348(__call__)
        3    0.001    0.000    1.042    0.347 kb.py:122(neighbors)
        9    0.914    0.102    0.915    0.102 nms.py:31(build)
        2    0.000    0.000    0.715    0.358 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.121    0.040    0.122    0.041 nms.py:51(query)
       18    0.008    0.000    0.008    0.000 {built-in method cat}
    18/15    0.000    0.000    0.008    0.001 module.py:715(_call_impl)
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 9/16	Loss 7.435881

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.228 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.228    1.228 simple.py:52(score)
        3    0.000    0.000    1.226    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.226    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.204    0.401 kb.py:122(neighbors)
        9    0.982    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.817    0.409 kb.py:75(score)
        1    0.000    0.000    0.408    0.408 simple.py:29(hop)
        1    0.000    0.000    0.408    0.408 kb.py:156(forward)
        3    0.215    0.072    0.216    0.072 nms.py:51(query)
       18    0.014    0.001    0.014    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 10/16	Loss 7.386719

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.168 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.168    1.168 simple.py:52(score)
        3    0.000    0.000    1.166    0.389 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.166    0.389 profilehooks.py:348(__call__)
        3    0.001    0.000    1.150    0.383 kb.py:122(neighbors)
        9    0.925    0.103    0.926    0.103 nms.py:31(build)
        2    0.000    0.000    0.782    0.391 kb.py:75(score)
        1    0.000    0.000    0.384    0.384 simple.py:29(hop)
        1    0.000    0.000    0.384    0.384 kb.py:156(forward)
        3    0.217    0.072    0.218    0.073 nms.py:51(query)
       18    0.009    0.000    0.009    0.000 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 11/16	Loss 7.390108

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.154 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.154    1.154 simple.py:52(score)
        3    0.000    0.000    1.152    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.152    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.140    0.380 kb.py:122(neighbors)
        9    0.943    0.105    0.944    0.105 nms.py:31(build)
        2    0.000    0.000    0.772    0.386 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.190    0.063    0.191    0.064 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 12/16	Loss 7.402376

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.073 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.073    1.073 simple.py:52(score)
        3    0.000    0.000    1.070    0.357 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.070    0.357 profilehooks.py:348(__call__)
        3    0.001    0.000    1.057    0.352 kb.py:122(neighbors)
        9    0.920    0.102    0.921    0.102 nms.py:31(build)
        2    0.000    0.000    0.729    0.365 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.341    0.341 kb.py:156(forward)
        3    0.130    0.043    0.132    0.044 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 13/16	Loss 7.421267

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.195 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.195    1.195 simple.py:52(score)
        3    0.000    0.000    1.193    0.398 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.193    0.398 profilehooks.py:348(__call__)
        3    0.001    0.000    1.174    0.391 kb.py:122(neighbors)
        9    0.929    0.103    0.930    0.103 nms.py:31(build)
        2    0.000    0.000    0.857    0.428 kb.py:75(score)
        1    0.000    0.000    0.336    0.336 simple.py:29(hop)
        1    0.000    0.000    0.336    0.336 kb.py:156(forward)
        3    0.228    0.076    0.229    0.076 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 14/16	Loss 7.223680

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.149 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.149    1.149 simple.py:52(score)
        3    0.000    0.000    1.147    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.147    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.127    0.376 kb.py:122(neighbors)
        9    0.942    0.105    0.942    0.105 nms.py:31(build)
        2    0.001    0.000    0.780    0.390 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.366    0.366 kb.py:156(forward)
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 15/16	Loss 7.354683

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.082 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.082    1.082 simple.py:52(score)
        3    0.000    0.000    1.079    0.360 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.079    0.360 profilehooks.py:348(__call__)
        3    0.001    0.000    1.055    0.352 kb.py:122(neighbors)
        9    0.924    0.103    0.925    0.103 nms.py:31(build)
        2    0.000    0.000    0.728    0.364 kb.py:75(score)
        1    0.000    0.000    0.351    0.351 simple.py:29(hop)
        1    0.000    0.000    0.351    0.351 kb.py:156(forward)
        3    0.124    0.041    0.125    0.042 nms.py:51(query)
       18    0.016    0.001    0.016    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 1/20	Batch 16/16	Loss 7.328581

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.086 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.086    1.086 simple.py:52(score)
        3    0.000    0.000    1.083    0.361 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.083    0.361 profilehooks.py:348(__call__)
        3    0.001    0.000    1.070    0.357 kb.py:122(neighbors)
        9    0.920    0.102    0.921    0.102 nms.py:31(build)
        2    0.001    0.000    0.733    0.366 kb.py:75(score)
        1    0.000    0.000    0.351    0.351 simple.py:29(hop)
        1    0.000    0.000    0.351    0.351 kb.py:156(forward)
        3    0.143    0.048    0.145    0.048 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 1/16	Loss 7.158923

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.138 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.138    1.138 simple.py:52(score)
        3    0.000    0.000    1.135    0.378 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.135    0.378 profilehooks.py:348(__call__)
        3    0.001    0.000    1.121    0.374 kb.py:122(neighbors)
        9    0.952    0.106    0.953    0.106 nms.py:31(build)
        2    0.001    0.000    0.770    0.385 kb.py:75(score)
        1    0.000    0.000    0.365    0.365 simple.py:29(hop)
        1    0.000    0.000    0.365    0.365 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 2/16	Loss 7.331351

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.331 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.331    1.331 simple.py:52(score)
        3    0.000    0.000    1.328    0.443 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.328    0.443 profilehooks.py:348(__call__)
        3    0.001    0.000    1.317    0.439 kb.py:122(neighbors)
        9    1.059    0.118    1.059    0.118 nms.py:31(build)
        2    0.000    0.000    0.884    0.442 kb.py:75(score)
        1    0.000    0.000    0.444    0.444 simple.py:29(hop)
        1    0.000    0.000    0.444    0.444 kb.py:156(forward)
        3    0.251    0.084    0.252    0.084 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 3/16	Loss 7.301908

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.159 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.159    1.159 simple.py:52(score)
        3    0.000    0.000    1.157    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.157    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.144    0.381 kb.py:122(neighbors)
        9    0.935    0.104    0.936    0.104 nms.py:31(build)
        2    0.001    0.000    0.816    0.408 kb.py:75(score)
        1    0.000    0.000    0.340    0.340 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.202    0.067    0.204    0.068 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 4/16	Loss 7.130356

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.038 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.038    1.038 simple.py:52(score)
        3    0.000    0.000    1.036    0.345 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.036    0.345 profilehooks.py:348(__call__)
        3    0.001    0.000    1.019    0.340 kb.py:122(neighbors)
        9    0.883    0.098    0.883    0.098 nms.py:31(build)
        2    0.000    0.000    0.698    0.349 kb.py:75(score)
        1    0.000    0.000    0.338    0.338 simple.py:29(hop)
        1    0.000    0.000    0.337    0.337 kb.py:156(forward)
        3    0.130    0.043    0.131    0.044 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 5/16	Loss 7.309588

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.142 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.142    1.142 simple.py:52(score)
        3    0.000    0.000    1.139    0.380 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.139    0.380 profilehooks.py:348(__call__)
        3    0.001    0.000    1.126    0.375 kb.py:122(neighbors)
        9    0.932    0.104    0.932    0.104 nms.py:31(build)
        2    0.000    0.000    0.771    0.385 kb.py:75(score)
        1    0.000    0.000    0.368    0.368 simple.py:29(hop)
        1    0.000    0.000    0.368    0.368 kb.py:156(forward)
        3    0.188    0.063    0.189    0.063 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 6/16	Loss 7.184827

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.197 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.197    1.197 simple.py:52(score)
        3    0.000    0.000    1.195    0.398 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.195    0.398 profilehooks.py:348(__call__)
        3    0.001    0.000    1.176    0.392 kb.py:122(neighbors)
        9    0.986    0.110    0.987    0.110 nms.py:31(build)
        2    0.000    0.000    0.812    0.406 kb.py:75(score)
        1    0.000    0.000    0.383    0.383 simple.py:29(hop)
        1    0.000    0.000    0.383    0.383 kb.py:156(forward)
        3    0.184    0.061    0.185    0.062 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 7/16	Loss 7.099946

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.250 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.250    1.250 simple.py:52(score)
        3    0.000    0.000    1.247    0.416 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.247    0.416 profilehooks.py:348(__call__)
        3    0.001    0.000    1.228    0.409 kb.py:122(neighbors)
        9    0.996    0.111    0.997    0.111 nms.py:31(build)
        2    0.000    0.000    0.885    0.442 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.225    0.075    0.226    0.075 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 8/16	Loss 7.014839

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.197 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.197    1.197 simple.py:52(score)
        3    0.000    0.000    1.194    0.398 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.194    0.398 profilehooks.py:348(__call__)
        3    0.001    0.000    1.171    0.390 kb.py:122(neighbors)
        9    0.969    0.108    0.969    0.108 nms.py:31(build)
        2    0.001    0.000    0.817    0.408 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.195    0.065    0.196    0.065 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 9/16	Loss 7.098587

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.216 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.216    1.216 simple.py:52(score)
        3    0.000    0.000    1.214    0.405 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.214    0.405 profilehooks.py:348(__call__)
        3    0.001    0.000    1.201    0.400 kb.py:122(neighbors)
        9    1.007    0.112    1.008    0.112 nms.py:31(build)
        2    0.000    0.000    0.832    0.416 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.188    0.063    0.189    0.063 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 10/16	Loss 7.049083

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.201 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.201    1.201 simple.py:52(score)
        3    0.000    0.000    1.199    0.400 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.199    0.400 profilehooks.py:348(__call__)
        3    0.001    0.000    1.172    0.391 kb.py:122(neighbors)
        9    0.934    0.104    0.935    0.104 nms.py:31(build)
        2    0.000    0.000    0.868    0.434 kb.py:75(score)
        1    0.000    0.000    0.331    0.331 simple.py:29(hop)
        1    0.000    0.000    0.331    0.331 kb.py:156(forward)
        3    0.231    0.077    0.232    0.077 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 11/16	Loss 7.089321

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.210 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.210    1.210 simple.py:52(score)
        3    0.000    0.000    1.207    0.402 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.207    0.402 profilehooks.py:348(__call__)
        3    0.001    0.000    1.194    0.398 kb.py:122(neighbors)
        9    1.027    0.114    1.028    0.114 nms.py:31(build)
        2    0.001    0.000    0.830    0.415 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.160    0.053    0.162    0.054 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 12/16	Loss 7.113039

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.223 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.223    1.223 simple.py:52(score)
        3    0.000    0.000    1.220    0.407 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.220    0.407 profilehooks.py:348(__call__)
        3    0.001    0.000    1.201    0.400 kb.py:122(neighbors)
        9    1.010    0.112    1.011    0.112 nms.py:31(build)
        2    0.000    0.000    0.832    0.416 kb.py:75(score)
        1    0.000    0.000    0.388    0.388 simple.py:29(hop)
        1    0.000    0.000    0.388    0.388 kb.py:156(forward)
        3    0.184    0.061    0.185    0.062 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 13/16	Loss 7.031967

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.187    1.187 simple.py:52(score)
        3    0.000    0.000    1.185    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.185    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.173    0.391 kb.py:122(neighbors)
        9    0.981    0.109    0.982    0.109 nms.py:31(build)
        2    0.001    0.000    0.856    0.428 kb.py:75(score)
        1    0.000    0.000    0.329    0.329 simple.py:29(hop)
        1    0.000    0.000    0.329    0.329 kb.py:156(forward)
        3    0.185    0.062    0.186    0.062 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 14/16	Loss 7.101425

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.174 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.174    1.174 simple.py:52(score)
        3    0.000    0.000    1.172    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.172    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.153    0.384 kb.py:122(neighbors)
        9    0.980    0.109    0.981    0.109 nms.py:31(build)
        2    0.001    0.000    0.796    0.398 kb.py:75(score)
        1    0.000    0.000    0.376    0.376 simple.py:29(hop)
        1    0.000    0.000    0.376    0.376 kb.py:156(forward)
        3    0.166    0.055    0.167    0.056 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 15/16	Loss 7.031174

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.177 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.177    1.177 simple.py:52(score)
        3    0.000    0.000    1.175    0.392 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.175    0.392 profilehooks.py:348(__call__)
        3    0.001    0.000    1.161    0.387 kb.py:122(neighbors)
        9    0.942    0.105    0.943    0.105 nms.py:31(build)
        2    0.002    0.001    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.361    0.361 simple.py:29(hop)
        1    0.000    0.000    0.360    0.360 kb.py:156(forward)
        3    0.212    0.071    0.213    0.071 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 2/20	Batch 16/16	Loss 7.057507

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.197 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.197    1.197 simple.py:52(score)
        3    0.000    0.000    1.195    0.398 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.195    0.398 profilehooks.py:348(__call__)
        3    0.001    0.000    1.174    0.391 kb.py:122(neighbors)
        9    1.007    0.112    1.008    0.112 nms.py:31(build)
        2    0.001    0.000    0.833    0.416 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.160    0.053    0.161    0.054 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 1/16	Loss 7.128339

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.243 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.243    1.243 simple.py:52(score)
        3    0.000    0.000    1.240    0.413 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.240    0.413 profilehooks.py:348(__call__)
        3    0.001    0.000    1.227    0.409 kb.py:122(neighbors)
        9    1.048    0.116    1.049    0.117 nms.py:31(build)
        2    0.000    0.000    0.830    0.415 kb.py:75(score)
        1    0.000    0.000    0.410    0.410 simple.py:29(hop)
        1    0.000    0.000    0.410    0.410 kb.py:156(forward)
        3    0.171    0.057    0.173    0.058 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.002    0.001    0.002    0.001 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 2/16	Loss 6.805005

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.151 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.151    1.151 simple.py:52(score)
        3    0.000    0.000    1.149    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.149    0.383 profilehooks.py:348(__call__)
        3    0.001    0.000    1.137    0.379 kb.py:122(neighbors)
        9    1.002    0.111    1.003    0.111 nms.py:31(build)
        2    0.000    0.000    0.811    0.406 kb.py:75(score)
        1    0.000    0.000    0.337    0.337 simple.py:29(hop)
        1    0.000    0.000    0.337    0.337 kb.py:156(forward)
        3    0.128    0.043    0.130    0.043 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 3/16	Loss 6.718171

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.105 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.105    1.105 simple.py:52(score)
        3    0.000    0.000    1.102    0.367 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.102    0.367 profilehooks.py:348(__call__)
        3    0.001    0.000    1.088    0.363 kb.py:122(neighbors)
        9    0.944    0.105    0.944    0.105 nms.py:31(build)
        2    0.000    0.000    0.776    0.388 kb.py:75(score)
        1    0.000    0.000    0.326    0.326 simple.py:29(hop)
        1    0.000    0.000    0.326    0.326 kb.py:156(forward)
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 4/16	Loss 6.919285

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.185 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.185    1.185 simple.py:52(score)
        3    0.000    0.000    1.183    0.394 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.183    0.394 profilehooks.py:348(__call__)
        3    0.001    0.000    1.171    0.390 kb.py:122(neighbors)
        9    1.016    0.113    1.017    0.113 nms.py:31(build)
        2    0.001    0.000    0.804    0.402 kb.py:75(score)
        1    0.000    0.000    0.379    0.379 simple.py:29(hop)
        1    0.000    0.000    0.379    0.379 kb.py:156(forward)
        3    0.148    0.049    0.150    0.050 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 5/16	Loss 6.950036

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.199 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.199    1.199 simple.py:52(score)
        3    0.000    0.000    1.196    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.196    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.184    0.395 kb.py:122(neighbors)
        9    1.004    0.112    1.005    0.112 nms.py:31(build)
        2    0.001    0.000    0.793    0.396 kb.py:75(score)
        1    0.000    0.000    0.403    0.403 simple.py:29(hop)
        1    0.000    0.000    0.403    0.403 kb.py:156(forward)
        3    0.172    0.057    0.173    0.058 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 6/16	Loss 6.662703

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.422 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.422    1.422 simple.py:52(score)
        3    0.000    0.000    1.420    0.473 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.420    0.473 profilehooks.py:348(__call__)
        3    0.001    0.000    1.401    0.467 kb.py:122(neighbors)
        9    1.102    0.122    1.103    0.123 nms.py:31(build)
        2    0.000    0.000    1.019    0.509 kb.py:75(score)
        1    0.000    0.000    0.401    0.401 simple.py:29(hop)
        1    0.000    0.000    0.401    0.401 kb.py:156(forward)
        3    0.293    0.098    0.294    0.098 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 7/16	Loss 7.020182

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.188 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.188    1.188 simple.py:52(score)
        3    0.000    0.000    1.186    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.186    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.160    0.387 kb.py:122(neighbors)
        9    0.975    0.108    0.976    0.108 nms.py:31(build)
        2    0.000    0.000    0.820    0.410 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.366    0.366 kb.py:156(forward)
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.002    0.001    0.010    0.003 gaussian.py:28(__call__)
        3    0.007    0.002    0.007    0.002 {built-in method sum}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 8/16	Loss 6.679727

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.097 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.097    1.097 simple.py:52(score)
        3    0.000    0.000    1.094    0.365 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.094    0.365 profilehooks.py:348(__call__)
        3    0.001    0.000    1.081    0.360 kb.py:122(neighbors)
        9    0.925    0.103    0.926    0.103 nms.py:31(build)
        2    0.000    0.000    0.731    0.366 kb.py:75(score)
        1    0.000    0.000    0.363    0.363 simple.py:29(hop)
        1    0.000    0.000    0.363    0.363 kb.py:156(forward)
        3    0.149    0.050    0.150    0.050 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 9/16	Loss 6.693868

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.237 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.237    1.237 simple.py:52(score)
        3    0.000    0.000    1.228    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.228    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.209    0.403 kb.py:122(neighbors)
        9    1.044    0.116    1.045    0.116 nms.py:31(build)
        2    0.000    0.000    0.851    0.425 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.158    0.053    0.160    0.053 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.010    0.001 module.py:715(_call_impl)
        2    0.000    0.000    0.007    0.004 base.py:142(forward)
        2    0.000    0.000    0.007    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {method 't' of 'torch._C._TensorBase' objects}
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 10/16	Loss 6.790504

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.096 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.096    1.096 simple.py:52(score)
        3    0.000    0.000    1.094    0.365 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.094    0.365 profilehooks.py:348(__call__)
        3    0.001    0.000    1.080    0.360 kb.py:122(neighbors)
        9    0.936    0.104    0.936    0.104 nms.py:31(build)
        2    0.000    0.000    0.743    0.372 kb.py:75(score)
        1    0.000    0.000    0.350    0.350 simple.py:29(hop)
        1    0.000    0.000    0.350    0.350 kb.py:156(forward)
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 11/16	Loss 6.704037

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.239 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.239    1.239 simple.py:52(score)
        3    0.000    0.000    1.237    0.412 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.237    0.412 profilehooks.py:348(__call__)
        3    0.001    0.000    1.218    0.406 kb.py:122(neighbors)
        9    0.998    0.111    0.999    0.111 nms.py:31(build)
        2    0.000    0.000    0.848    0.424 kb.py:75(score)
        1    0.000    0.000    0.389    0.389 simple.py:29(hop)
        1    0.000    0.000    0.389    0.389 kb.py:156(forward)
        3    0.213    0.071    0.214    0.071 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 12/16	Loss 6.712343

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.219 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.219    1.219 simple.py:52(score)
        3    0.000    0.000    1.217    0.406 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.217    0.406 profilehooks.py:348(__call__)
        3    0.001    0.000    1.200    0.400 kb.py:122(neighbors)
        9    1.031    0.115    1.031    0.115 nms.py:31(build)
        2    0.000    0.000    0.797    0.399 kb.py:75(score)
        1    0.000    0.000    0.420    0.420 simple.py:29(hop)
        1    0.000    0.000    0.419    0.419 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 13/16	Loss 6.545417

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.176 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.176    1.176 simple.py:52(score)
        3    0.000    0.000    1.174    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.174    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.162    0.387 kb.py:122(neighbors)
        9    0.958    0.106    0.959    0.107 nms.py:31(build)
        2    0.000    0.000    0.806    0.403 kb.py:75(score)
        1    0.000    0.000    0.368    0.368 simple.py:29(hop)
        1    0.000    0.000    0.368    0.368 kb.py:156(forward)
        3    0.197    0.066    0.198    0.066 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 14/16	Loss 6.815983

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.250 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.250    1.250 simple.py:52(score)
        3    0.000    0.000    1.247    0.416 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.247    0.416 profilehooks.py:348(__call__)
        3    0.001    0.000    1.221    0.407 kb.py:122(neighbors)
        9    0.980    0.109    0.981    0.109 nms.py:31(build)
        2    0.000    0.000    0.875    0.438 kb.py:75(score)
        1    0.000    0.000    0.372    0.372 simple.py:29(hop)
        1    0.000    0.000    0.372    0.372 kb.py:156(forward)
        3    0.231    0.077    0.233    0.078 nms.py:51(query)
       18    0.021    0.001    0.021    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 15/16	Loss 6.510984

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.225 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.225    1.225 simple.py:52(score)
        3    0.000    0.000    1.223    0.408 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.223    0.408 profilehooks.py:348(__call__)
        3    0.001    0.000    1.211    0.404 kb.py:122(neighbors)
        9    1.048    0.116    1.049    0.117 nms.py:31(build)
        2    0.000    0.000    0.831    0.415 kb.py:75(score)
        1    0.000    0.000    0.392    0.392 simple.py:29(hop)
        1    0.000    0.000    0.392    0.392 kb.py:156(forward)
        3    0.156    0.052    0.157    0.052 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 3/20	Batch 16/16	Loss 6.381446

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.194 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.194    1.194 simple.py:52(score)
        3    0.000    0.000    1.192    0.397 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.192    0.397 profilehooks.py:348(__call__)
        3    0.001    0.000    1.167    0.389 kb.py:122(neighbors)
        9    0.991    0.110    0.992    0.110 nms.py:31(build)
        2    0.000    0.000    0.855    0.427 kb.py:75(score)
        1    0.000    0.000    0.337    0.337 simple.py:29(hop)
        1    0.000    0.000    0.337    0.337 kb.py:156(forward)
        3    0.168    0.056    0.169    0.056 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 1/16	Loss 6.447966

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.127 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.127    1.127 simple.py:52(score)
        3    0.000    0.000    1.124    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.124    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.110    0.370 kb.py:122(neighbors)
        9    0.939    0.104    0.940    0.104 nms.py:31(build)
        2    0.000    0.000    0.773    0.387 kb.py:75(score)
        1    0.000    0.000    0.351    0.351 simple.py:29(hop)
        1    0.000    0.000    0.351    0.351 kb.py:156(forward)
        3    0.164    0.055    0.165    0.055 nms.py:51(query)
       18    0.008    0.000    0.008    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 2/16	Loss 6.539820

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.147 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.147    1.147 simple.py:52(score)
        3    0.000    0.000    1.144    0.381 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.144    0.381 profilehooks.py:348(__call__)
        3    0.001    0.000    1.131    0.377 kb.py:122(neighbors)
        9    0.945    0.105    0.946    0.105 nms.py:31(build)
        2    0.000    0.000    0.780    0.390 kb.py:75(score)
        1    0.000    0.000    0.365    0.365 simple.py:29(hop)
        1    0.000    0.000    0.365    0.365 kb.py:156(forward)
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 3/16	Loss 6.499557

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.220 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.220    1.220 simple.py:52(score)
        3    0.000    0.000    1.217    0.406 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.217    0.406 profilehooks.py:348(__call__)
        3    0.001    0.000    1.190    0.397 kb.py:122(neighbors)
        9    1.035    0.115    1.036    0.115 nms.py:31(build)
        2    0.001    0.000    0.850    0.425 kb.py:75(score)
        1    0.000    0.000    0.367    0.367 simple.py:29(hop)
        1    0.000    0.000    0.367    0.367 kb.py:156(forward)
        3    0.147    0.049    0.148    0.049 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 4/16	Loss 6.747091

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.345 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.345    1.345 simple.py:52(score)
        3    0.000    0.000    1.342    0.447 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.342    0.447 profilehooks.py:348(__call__)
        3    0.001    0.000    1.330    0.443 kb.py:122(neighbors)
        9    1.082    0.120    1.082    0.120 nms.py:31(build)
        2    0.000    0.000    0.904    0.452 kb.py:75(score)
        1    0.000    0.000    0.438    0.438 simple.py:29(hop)
        1    0.000    0.000    0.438    0.438 kb.py:156(forward)
        3    0.241    0.080    0.242    0.081 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 5/16	Loss 6.614480

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.172 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.172    1.172 simple.py:52(score)
        3    0.000    0.000    1.170    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.170    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.158    0.386 kb.py:122(neighbors)
        9    0.989    0.110    0.990    0.110 nms.py:31(build)
        2    0.000    0.000    0.789    0.395 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 6/16	Loss 6.170218

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.108 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.108    1.108 simple.py:52(score)
        3    0.000    0.000    1.105    0.368 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.105    0.368 profilehooks.py:348(__call__)
        3    0.001    0.000    1.081    0.360 kb.py:122(neighbors)
        9    0.918    0.102    0.919    0.102 nms.py:31(build)
        2    0.000    0.000    0.786    0.393 kb.py:75(score)
        1    0.000    0.000    0.319    0.319 simple.py:29(hop)
        1    0.000    0.000    0.319    0.319 kb.py:156(forward)
        3    0.153    0.051    0.155    0.052 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 7/16	Loss 6.142818

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.089 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.089    1.089 simple.py:52(score)
        3    0.000    0.000    1.086    0.362 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.086    0.362 profilehooks.py:348(__call__)
        3    0.001    0.000    1.068    0.356 kb.py:122(neighbors)
        9    0.932    0.104    0.933    0.104 nms.py:31(build)
        2    0.000    0.000    0.765    0.383 kb.py:75(score)
        1    0.000    0.000    0.321    0.321 simple.py:29(hop)
        1    0.000    0.000    0.321    0.321 kb.py:156(forward)
        3    0.129    0.043    0.130    0.043 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 8/16	Loss 6.486586

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.029 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.029    1.029 simple.py:52(score)
        3    0.000    0.000    1.027    0.342 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.027    0.342 profilehooks.py:348(__call__)
        3    0.001    0.000    1.001    0.334 kb.py:122(neighbors)
        9    0.899    0.100    0.900    0.100 nms.py:31(build)
        2    0.001    0.000    0.728    0.364 kb.py:75(score)
        1    0.000    0.000    0.299    0.299 simple.py:29(hop)
        1    0.000    0.000    0.299    0.299 kb.py:156(forward)
        3    0.095    0.032    0.096    0.032 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 9/16	Loss 6.304768

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.272 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.272    1.272 simple.py:52(score)
        3    0.000    0.000    1.269    0.423 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.269    0.423 profilehooks.py:348(__call__)
        3    0.001    0.000    1.258    0.419 kb.py:122(neighbors)
        9    1.054    0.117    1.055    0.117 nms.py:31(build)
        2    0.000    0.000    0.864    0.432 kb.py:75(score)
        1    0.000    0.000    0.406    0.406 simple.py:29(hop)
        1    0.000    0.000    0.406    0.406 kb.py:156(forward)
        3    0.197    0.066    0.198    0.066 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 10/16	Loss 6.331637

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.233 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.233    1.233 simple.py:52(score)
        3    0.000    0.000    1.230    0.410 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.230    0.410 profilehooks.py:348(__call__)
        3    0.001    0.000    1.218    0.406 kb.py:122(neighbors)
        9    1.002    0.111    1.003    0.111 nms.py:31(build)
        2    0.000    0.000    0.810    0.405 kb.py:75(score)
        1    0.000    0.000    0.420    0.420 simple.py:29(hop)
        1    0.000    0.000    0.420    0.420 kb.py:156(forward)
        3    0.209    0.070    0.210    0.070 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 11/16	Loss 6.343789

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.270 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.270    1.270 simple.py:52(score)
        3    0.000    0.000    1.267    0.422 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.267    0.422 profilehooks.py:348(__call__)
        3    0.001    0.000    1.246    0.415 kb.py:122(neighbors)
        9    1.004    0.112    1.005    0.112 nms.py:31(build)
        2    0.000    0.000    0.869    0.435 kb.py:75(score)
        1    0.000    0.000    0.398    0.398 simple.py:29(hop)
        1    0.000    0.000    0.398    0.398 kb.py:156(forward)
        3    0.235    0.078    0.236    0.079 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 12/16	Loss 6.250247

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.154 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.154    1.154 simple.py:52(score)
        3    0.000    0.000    1.151    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.151    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.139    0.380 kb.py:122(neighbors)
        9    0.997    0.111    0.998    0.111 nms.py:31(build)
        2    0.000    0.000    0.810    0.405 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.341    0.341 kb.py:156(forward)
        3    0.135    0.045    0.137    0.046 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 13/16	Loss 6.226264

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.260 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.260    1.260 simple.py:52(score)
        3    0.000    0.000    1.257    0.419 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.257    0.419 profilehooks.py:348(__call__)
        3    0.001    0.000    1.246    0.415 kb.py:122(neighbors)
        9    1.042    0.116    1.043    0.116 nms.py:31(build)
        2    0.000    0.000    0.823    0.412 kb.py:75(score)
        1    0.000    0.000    0.434    0.434 simple.py:29(hop)
        1    0.000    0.000    0.434    0.434 kb.py:156(forward)
        3    0.197    0.066    0.199    0.066 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 14/16	Loss 6.250065

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.104 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.104    1.104 simple.py:52(score)
        3    0.000    0.000    1.101    0.367 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.101    0.367 profilehooks.py:348(__call__)
        3    0.001    0.000    1.075    0.358 kb.py:122(neighbors)
        9    0.922    0.102    0.923    0.103 nms.py:31(build)
        2    0.000    0.000    0.785    0.393 kb.py:75(score)
        1    0.000    0.000    0.316    0.316 simple.py:29(hop)
        1    0.000    0.000    0.316    0.316 kb.py:156(forward)
        3    0.146    0.049    0.147    0.049 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 15/16	Loss 6.261008

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.130 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.130    1.130 simple.py:52(score)
        3    0.000    0.000    1.128    0.376 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.128    0.376 profilehooks.py:348(__call__)
        3    0.001    0.000    1.116    0.372 kb.py:122(neighbors)
        9    0.947    0.105    0.948    0.105 nms.py:31(build)
        2    0.000    0.000    0.743    0.371 kb.py:75(score)
        1    0.000    0.000    0.385    0.385 simple.py:29(hop)
        1    0.000    0.000    0.385    0.385 kb.py:156(forward)
        3    0.158    0.053    0.159    0.053 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 4/20	Batch 16/16	Loss 5.961215

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.126 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.126    1.126 simple.py:52(score)
        3    0.000    0.000    1.124    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.124    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.104    0.368 kb.py:122(neighbors)
        9    0.947    0.105    0.948    0.105 nms.py:31(build)
        2    0.001    0.000    0.774    0.387 kb.py:75(score)
        1    0.000    0.000    0.350    0.350 simple.py:29(hop)
        1    0.000    0.000    0.349    0.349 kb.py:156(forward)
        3    0.150    0.050    0.151    0.050 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 nms.py:55(<listcomp>)


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 1/16	Loss 6.303218

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.163 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.163    1.163 simple.py:52(score)
        3    0.000    0.000    1.161    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.161    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.145    0.382 kb.py:122(neighbors)
        9    0.942    0.105    0.942    0.105 nms.py:31(build)
        2    0.000    0.000    0.824    0.412 kb.py:75(score)
        1    0.000    0.000    0.337    0.337 simple.py:29(hop)
        1    0.000    0.000    0.337    0.337 kb.py:156(forward)
        3    0.197    0.066    0.198    0.066 nms.py:51(query)
        3    0.005    0.002    0.006    0.002 gaussian.py:28(__call__)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 2/16	Loss 6.126338

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.142 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.142    1.142 simple.py:52(score)
        3    0.000    0.000    1.140    0.380 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.140    0.380 profilehooks.py:348(__call__)
        3    0.001    0.000    1.128    0.376 kb.py:122(neighbors)
        9    0.964    0.107    0.964    0.107 nms.py:31(build)
        2    0.000    0.000    0.782    0.391 kb.py:75(score)
        1    0.000    0.000    0.358    0.358 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.158    0.053    0.159    0.053 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 3/16	Loss 6.323668

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.151    0.384 kb.py:122(neighbors)
        9    0.990    0.110    0.991    0.110 nms.py:31(build)
        2    0.000    0.000    0.805    0.403 kb.py:75(score)
        1    0.000    0.000    0.357    0.357 simple.py:29(hop)
        1    0.000    0.000    0.357    0.357 kb.py:156(forward)
        3    0.155    0.052    0.156    0.052 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 4/16	Loss 6.127972

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.208 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.208    1.208 simple.py:52(score)
        3    0.000    0.000    1.206    0.402 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.206    0.402 profilehooks.py:348(__call__)
        3    0.001    0.000    1.195    0.398 kb.py:122(neighbors)
        9    0.999    0.111    1.000    0.111 nms.py:31(build)
        2    0.000    0.000    0.816    0.408 kb.py:75(score)
        1    0.000    0.000    0.390    0.390 simple.py:29(hop)
        1    0.000    0.000    0.390    0.390 kb.py:156(forward)
        3    0.190    0.063    0.191    0.064 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 5/16	Loss 6.288391

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.260 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.260    1.260 simple.py:52(score)
        3    0.000    0.000    1.258    0.419 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.258    0.419 profilehooks.py:348(__call__)
        3    0.001    0.000    1.237    0.412 kb.py:122(neighbors)
        9    0.988    0.110    0.989    0.110 nms.py:31(build)
        2    0.001    0.000    0.882    0.441 kb.py:75(score)
        1    0.000    0.000    0.376    0.376 simple.py:29(hop)
        1    0.000    0.000    0.376    0.376 kb.py:156(forward)
        3    0.241    0.080    0.243    0.081 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 6/16	Loss 5.861495

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.121 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.121    1.121 simple.py:52(score)
        3    0.000    0.000    1.118    0.373 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.118    0.373 profilehooks.py:348(__call__)
        3    0.001    0.000    1.099    0.366 kb.py:122(neighbors)
        9    0.964    0.107    0.965    0.107 nms.py:31(build)
        2    0.000    0.000    0.773    0.387 kb.py:75(score)
        1    0.000    0.000    0.345    0.345 simple.py:29(hop)
        1    0.000    0.000    0.345    0.345 kb.py:156(forward)
        3    0.128    0.043    0.129    0.043 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 7/16	Loss 5.947660

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.179 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.179    1.179 simple.py:52(score)
        3    0.000    0.000    1.177    0.392 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.177    0.392 profilehooks.py:348(__call__)
        3    0.001    0.000    1.156    0.385 kb.py:122(neighbors)
        9    1.005    0.112    1.006    0.112 nms.py:31(build)
        2    0.000    0.000    0.810    0.405 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.366    0.366 kb.py:156(forward)
        3    0.144    0.048    0.145    0.048 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 8/16	Loss 5.543464

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.116 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.116    1.116 simple.py:52(score)
        3    0.000    0.000    1.114    0.371 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.114    0.371 profilehooks.py:348(__call__)
        3    0.001    0.000    1.102    0.367 kb.py:122(neighbors)
        9    0.950    0.106    0.951    0.106 nms.py:31(build)
        2    0.000    0.000    0.768    0.384 kb.py:75(score)
        1    0.000    0.000    0.346    0.346 simple.py:29(hop)
        1    0.000    0.000    0.345    0.345 kb.py:156(forward)
        3    0.145    0.048    0.146    0.049 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 9/16	Loss 5.750869

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.146 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.146    1.146 simple.py:52(score)
        3    0.000    0.000    1.143    0.381 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.143    0.381 profilehooks.py:348(__call__)
        3    0.001    0.000    1.116    0.372 kb.py:122(neighbors)
        9    0.937    0.104    0.937    0.104 nms.py:31(build)
        2    0.000    0.000    0.823    0.411 kb.py:75(score)
        1    0.000    0.000    0.320    0.320 simple.py:29(hop)
        1    0.000    0.000    0.320    0.320 kb.py:156(forward)
        3    0.169    0.056    0.170    0.057 nms.py:51(query)
       18    0.022    0.001    0.022    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 10/16	Loss 6.306620

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.242 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.242    1.242 simple.py:52(score)
        3    0.000    0.000    1.239    0.413 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.239    0.413 profilehooks.py:348(__call__)
        3    0.001    0.000    1.225    0.408 kb.py:122(neighbors)
        9    1.017    0.113    1.018    0.113 nms.py:31(build)
        2    0.001    0.000    0.857    0.429 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.201    0.067    0.202    0.067 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 11/16	Loss 5.970364

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.195 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.195    1.195 simple.py:52(score)
        3    0.000    0.000    1.193    0.398 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.193    0.398 profilehooks.py:348(__call__)
        3    0.001    0.000    1.178    0.393 kb.py:122(neighbors)
        9    0.984    0.109    0.985    0.109 nms.py:31(build)
        2    0.001    0.000    0.806    0.403 kb.py:75(score)
        1    0.000    0.000    0.387    0.387 simple.py:29(hop)
        1    0.000    0.000    0.387    0.387 kb.py:156(forward)
        3    0.187    0.062    0.188    0.063 nms.py:51(query)
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 12/16	Loss 5.652532

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.153 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.153    1.153 simple.py:52(score)
        3    0.000    0.000    1.151    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.151    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.122    0.374 kb.py:122(neighbors)
        9    0.986    0.110    0.986    0.110 nms.py:31(build)
        2    0.001    0.000    0.809    0.405 kb.py:75(score)
        1    0.000    0.000    0.342    0.342 simple.py:29(hop)
        1    0.000    0.000    0.341    0.341 kb.py:156(forward)
        3    0.129    0.043    0.130    0.043 nms.py:51(query)
        3    0.002    0.001    0.016    0.005 gaussian.py:28(__call__)
        3    0.013    0.004    0.013    0.004 {built-in method sum}
       18    0.008    0.000    0.008    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 nms.py:55(<listcomp>)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 13/16	Loss 5.638063

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.174 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.174    1.174 simple.py:52(score)
        3    0.000    0.000    1.172    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.172    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.159    0.386 kb.py:122(neighbors)
        9    0.986    0.110    0.986    0.110 nms.py:31(build)
        2    0.000    0.000    0.818    0.409 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.166    0.055    0.167    0.056 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 14/16	Loss 5.421782

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.300 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.300    1.300 simple.py:52(score)
        3    0.000    0.000    1.297    0.432 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.297    0.432 profilehooks.py:348(__call__)
        3    0.001    0.000    1.279    0.426 kb.py:122(neighbors)
        9    1.031    0.115    1.032    0.115 nms.py:31(build)
        2    0.000    0.000    0.920    0.460 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.241    0.080    0.242    0.081 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 15/16	Loss 5.714364

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.110 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.110    1.110 simple.py:52(score)
        3    0.000    0.000    1.107    0.369 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.107    0.369 profilehooks.py:348(__call__)
        3    0.001    0.000    1.089    0.363 kb.py:122(neighbors)
        9    0.951    0.106    0.951    0.106 nms.py:31(build)
        2    0.000    0.000    0.770    0.385 kb.py:75(score)
        1    0.000    0.000    0.337    0.337 simple.py:29(hop)
        1    0.000    0.000    0.337    0.337 kb.py:156(forward)
        3    0.128    0.043    0.130    0.043 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 5/20	Batch 16/16	Loss 6.043028

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.200 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.200    1.200 simple.py:52(score)
        3    0.000    0.000    1.197    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.197    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.178    0.393 kb.py:122(neighbors)
        9    0.964    0.107    0.964    0.107 nms.py:31(build)
        2    0.000    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.383    0.383 simple.py:29(hop)
        1    0.000    0.000    0.383    0.383 kb.py:156(forward)
        3    0.207    0.069    0.208    0.069 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 1/16	Loss 5.778885

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.224 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.224    1.224 simple.py:52(score)
        3    0.000    0.000    1.221    0.407 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.221    0.407 profilehooks.py:348(__call__)
        3    0.001    0.000    1.207    0.402 kb.py:122(neighbors)
        9    0.948    0.105    0.949    0.105 nms.py:31(build)
        2    0.001    0.000    0.844    0.422 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.253    0.084    0.254    0.085 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
       75    0.001    0.000    0.002    0.000 module.py:781(__setattr__)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.001    0.000    0.001    0.000 module.py:294(register_parameter)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 2/16	Loss 5.714845

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.346 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.346    1.346 simple.py:52(score)
        3    0.000    0.000    1.343    0.448 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.343    0.448 profilehooks.py:348(__call__)
        3    0.001    0.000    1.331    0.444 kb.py:122(neighbors)
        9    1.066    0.118    1.066    0.118 nms.py:31(build)
        2    0.000    0.000    0.927    0.464 kb.py:75(score)
        1    0.000    0.000    0.416    0.416 simple.py:29(hop)
        1    0.000    0.000    0.416    0.416 kb.py:156(forward)
        3    0.259    0.086    0.260    0.087 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 3/16	Loss 5.550284

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.092 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.092    1.092 simple.py:52(score)
        3    0.000    0.000    1.089    0.363 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.089    0.363 profilehooks.py:348(__call__)
        3    0.001    0.000    1.062    0.354 kb.py:122(neighbors)
        9    0.928    0.103    0.929    0.103 nms.py:31(build)
        2    0.000    0.000    0.731    0.366 kb.py:75(score)
        1    0.000    0.000    0.358    0.358 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.127    0.042    0.128    0.043 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 4/16	Loss 5.989197

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.178 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.178    1.178 simple.py:52(score)
        3    0.000    0.000    1.176    0.392 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.175    0.392 profilehooks.py:348(__call__)
        3    0.001    0.000    1.162    0.387 kb.py:122(neighbors)
        9    0.989    0.110    0.990    0.110 nms.py:31(build)
        2    0.000    0.000    0.772    0.386 kb.py:75(score)
        1    0.000    0.000    0.403    0.403 simple.py:29(hop)
        1    0.000    0.000    0.403    0.403 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.009    0.001    0.009    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 5/16	Loss 5.678940

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.170 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.170    1.170 simple.py:52(score)
        3    0.000    0.000    1.168    0.389 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.168    0.389 profilehooks.py:348(__call__)
        3    0.001    0.000    1.156    0.385 kb.py:122(neighbors)
        9    0.994    0.110    0.995    0.111 nms.py:31(build)
        2    0.000    0.000    0.774    0.387 kb.py:75(score)
        1    0.000    0.000    0.393    0.393 simple.py:29(hop)
        1    0.000    0.000    0.393    0.393 kb.py:156(forward)
        3    0.156    0.052    0.157    0.052 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 6/16	Loss 5.622598

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.211 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.211    1.211 simple.py:52(score)
        3    0.000    0.000    1.208    0.403 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.208    0.403 profilehooks.py:348(__call__)
        3    0.001    0.000    1.189    0.396 kb.py:122(neighbors)
        9    1.000    0.111    1.001    0.111 nms.py:31(build)
        2    0.001    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.366    0.366 kb.py:156(forward)
        3    0.182    0.061    0.183    0.061 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 7/16	Loss 5.341744

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.106 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.106    1.106 simple.py:52(score)
        3    0.000    0.000    1.103    0.368 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.103    0.368 profilehooks.py:348(__call__)
        3    0.001    0.000    1.083    0.361 kb.py:122(neighbors)
        9    0.921    0.102    0.922    0.102 nms.py:31(build)
        2    0.000    0.000    0.779    0.390 kb.py:75(score)
        1    0.000    0.000    0.324    0.324 simple.py:29(hop)
        1    0.000    0.000    0.324    0.324 kb.py:156(forward)
        3    0.155    0.052    0.156    0.052 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 8/16	Loss 5.665405

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.247 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.247    1.247 simple.py:52(score)
        3    0.000    0.000    1.245    0.415 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.245    0.415 profilehooks.py:348(__call__)
        3    0.001    0.000    1.225    0.408 kb.py:122(neighbors)
        9    0.979    0.109    0.980    0.109 nms.py:31(build)
        2    0.000    0.000    0.868    0.434 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.239    0.080    0.241    0.080 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 9/16	Loss 5.456026

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.225 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.225    1.225 simple.py:52(score)
        3    0.000    0.000    1.222    0.407 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.222    0.407 profilehooks.py:348(__call__)
        3    0.001    0.000    1.204    0.401 kb.py:122(neighbors)
        9    1.046    0.116    1.047    0.116 nms.py:31(build)
        2    0.000    0.000    0.802    0.401 kb.py:75(score)
        1    0.000    0.000    0.420    0.420 simple.py:29(hop)
        1    0.000    0.000    0.420    0.420 kb.py:156(forward)
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 10/16	Loss 5.453064

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.223 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.223    1.223 simple.py:52(score)
        3    0.000    0.000    1.221    0.407 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.221    0.407 profilehooks.py:348(__call__)
        3    0.001    0.000    1.196    0.399 kb.py:122(neighbors)
        9    0.996    0.111    0.997    0.111 nms.py:31(build)
        2    0.000    0.000    0.822    0.411 kb.py:75(score)
        1    0.000    0.000    0.399    0.399 simple.py:29(hop)
        1    0.000    0.000    0.399    0.399 kb.py:156(forward)
        3    0.193    0.064    0.195    0.065 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 11/16	Loss 5.575536

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.267 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.267    1.267 simple.py:52(score)
        3    0.000    0.000    1.265    0.422 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.265    0.422 profilehooks.py:348(__call__)
        3    0.001    0.000    1.247    0.416 kb.py:122(neighbors)
        9    1.056    0.117    1.057    0.117 nms.py:31(build)
        2    0.000    0.000    0.847    0.423 kb.py:75(score)
        1    0.000    0.000    0.418    0.418 simple.py:29(hop)
        1    0.000    0.000    0.418    0.418 kb.py:156(forward)
        3    0.172    0.057    0.173    0.058 nms.py:51(query)
       18    0.022    0.001    0.022    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 12/16	Loss 5.255969

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.243 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.243    1.243 simple.py:52(score)
        3    0.000    0.000    1.241    0.414 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.241    0.414 profilehooks.py:348(__call__)
        3    0.001    0.000    1.213    0.404 kb.py:122(neighbors)
        9    1.037    0.115    1.038    0.115 nms.py:31(build)
        2    0.000    0.000    0.844    0.422 kb.py:75(score)
        1    0.000    0.000    0.397    0.397 simple.py:29(hop)
        1    0.000    0.000    0.396    0.396 kb.py:156(forward)
        3    0.169    0.056    0.170    0.057 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 13/16	Loss 5.553994

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.262 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.262    1.262 simple.py:52(score)
        3    0.000    0.000    1.260    0.420 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.260    0.420 profilehooks.py:348(__call__)
        3    0.001    0.000    1.248    0.416 kb.py:122(neighbors)
        9    0.991    0.110    0.991    0.110 nms.py:31(build)
        2    0.000    0.000    0.879    0.440 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.251    0.084    0.252    0.084 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 14/16	Loss 5.750589

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.297 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.297    1.297 simple.py:52(score)
        3    0.000    0.000    1.295    0.432 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.295    0.432 profilehooks.py:348(__call__)
        3    0.001    0.000    1.283    0.428 kb.py:122(neighbors)
        9    1.031    0.115    1.031    0.115 nms.py:31(build)
        2    0.000    0.000    0.911    0.456 kb.py:75(score)
        1    0.000    0.000    0.384    0.384 simple.py:29(hop)
        1    0.000    0.000    0.384    0.384 kb.py:156(forward)
        3    0.246    0.082    0.247    0.082 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 15/16	Loss 5.064852

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.143    0.381 kb.py:122(neighbors)
        9    0.931    0.103    0.932    0.104 nms.py:31(build)
        2    0.000    0.000    0.815    0.407 kb.py:75(score)
        1    0.000    0.000    0.347    0.347 simple.py:29(hop)
        1    0.000    0.000    0.347    0.347 kb.py:156(forward)
        3    0.206    0.069    0.207    0.069 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 6/20	Batch 16/16	Loss 5.250210

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.273 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.273    1.273 simple.py:52(score)
        3    0.000    0.000    1.271    0.424 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.271    0.424 profilehooks.py:348(__call__)
        3    0.001    0.000    1.259    0.420 kb.py:122(neighbors)
        9    1.058    0.118    1.059    0.118 nms.py:31(build)
        2    0.000    0.000    0.899    0.449 kb.py:75(score)
        1    0.000    0.000    0.372    0.372 simple.py:29(hop)
        1    0.000    0.000    0.372    0.372 kb.py:156(forward)
        3    0.193    0.064    0.194    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 1/16	Loss 5.213802

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.366 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.366    1.366 simple.py:52(score)
        3    0.000    0.000    1.364    0.455 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.364    0.455 profilehooks.py:348(__call__)
        3    0.001    0.000    1.352    0.451 kb.py:122(neighbors)
        9    1.064    0.118    1.065    0.118 nms.py:31(build)
        2    0.001    0.000    0.940    0.470 kb.py:75(score)
        1    0.000    0.000    0.423    0.423 simple.py:29(hop)
        1    0.000    0.000    0.423    0.423 kb.py:156(forward)
        3    0.281    0.094    0.282    0.094 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 2/16	Loss 5.076361

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.150 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.150    1.150 simple.py:52(score)
        3    0.000    0.000    1.148    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.147    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.124    0.375 kb.py:122(neighbors)
        9    0.963    0.107    0.964    0.107 nms.py:31(build)
        2    0.000    0.000    0.772    0.386 kb.py:75(score)
        1    0.000    0.000    0.375    0.375 simple.py:29(hop)
        1    0.000    0.000    0.375    0.375 kb.py:156(forward)
        3    0.155    0.052    0.156    0.052 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 3/16	Loss 5.502735

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.232 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.232    1.232 simple.py:52(score)
        3    0.000    0.000    1.230    0.410 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.230    0.410 profilehooks.py:348(__call__)
        3    0.001    0.000    1.218    0.406 kb.py:122(neighbors)
        9    0.942    0.105    0.942    0.105 nms.py:31(build)
        2    0.000    0.000    0.871    0.435 kb.py:75(score)
        1    0.000    0.000    0.359    0.359 simple.py:29(hop)
        1    0.000    0.000    0.359    0.359 kb.py:156(forward)
        3    0.270    0.090    0.271    0.090 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 4/16	Loss 5.382921

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.160 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.160    1.160 simple.py:52(score)
        3    0.000    0.000    1.158    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.158    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.133    0.378 kb.py:122(neighbors)
        9    0.982    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.810    0.405 kb.py:75(score)
        1    0.000    0.000    0.348    0.348 simple.py:29(hop)
        1    0.000    0.000    0.348    0.348 kb.py:156(forward)
        3    0.144    0.048    0.145    0.048 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 5/16	Loss 5.224428

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.229 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.229    1.229 simple.py:52(score)
        3    0.000    0.000    1.226    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.226    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.208    0.403 kb.py:122(neighbors)
        9    0.972    0.108    0.973    0.108 nms.py:31(build)
        2    0.001    0.000    0.890    0.445 kb.py:75(score)
        1    0.000    0.000    0.336    0.336 simple.py:29(hop)
        1    0.000    0.000    0.336    0.336 kb.py:156(forward)
        3    0.226    0.075    0.227    0.076 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 6/16	Loss 5.460703

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.205 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.205    1.205 simple.py:52(score)
        3    0.000    0.000    1.202    0.401 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.202    0.401 profilehooks.py:348(__call__)
        3    0.001    0.000    1.171    0.390 kb.py:122(neighbors)
        9    1.016    0.113    1.017    0.113 nms.py:31(build)
        2    0.001    0.000    0.844    0.422 kb.py:75(score)
        1    0.000    0.000    0.358    0.358 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.148    0.049    0.149    0.050 nms.py:51(query)
       18    0.023    0.001    0.023    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 7/16	Loss 5.225057

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.289 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.289    1.289 simple.py:52(score)
        3    0.000    0.000    1.287    0.429 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.287    0.429 profilehooks.py:348(__call__)
        3    0.001    0.000    1.275    0.425 kb.py:122(neighbors)
        9    1.047    0.116    1.047    0.116 nms.py:31(build)
        2    0.000    0.000    0.861    0.430 kb.py:75(score)
        1    0.000    0.000    0.426    0.426 simple.py:29(hop)
        1    0.000    0.000    0.426    0.426 kb.py:156(forward)
        3    0.222    0.074    0.223    0.074 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 8/16	Loss 5.523195

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.187    1.187 simple.py:52(score)
        3    0.000    0.000    1.185    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.185    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.167    0.389 kb.py:122(neighbors)
        9    0.966    0.107    0.967    0.107 nms.py:31(build)
        2    0.001    0.000    0.816    0.408 kb.py:75(score)
        1    0.000    0.000    0.369    0.369 simple.py:29(hop)
        1    0.000    0.000    0.369    0.369 kb.py:156(forward)
        3    0.194    0.065    0.195    0.065 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 9/16	Loss 5.178257

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.077 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.077    1.077 simple.py:52(score)
        3    0.000    0.000    1.074    0.358 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.074    0.358 profilehooks.py:348(__call__)
        3    0.001    0.000    1.055    0.352 kb.py:122(neighbors)
        9    0.885    0.098    0.885    0.098 nms.py:31(build)
        2    0.000    0.000    0.748    0.374 kb.py:75(score)
        1    0.000    0.000    0.327    0.327 simple.py:29(hop)
        1    0.000    0.000    0.327    0.327 kb.py:156(forward)
        3    0.163    0.054    0.164    0.055 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 10/16	Loss 5.138101

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.286 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.286    1.286 simple.py:52(score)
        3    0.000    0.000    1.283    0.428 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.283    0.428 profilehooks.py:348(__call__)
        3    0.001    0.000    1.262    0.421 kb.py:122(neighbors)
        9    1.004    0.112    1.004    0.112 nms.py:31(build)
        2    0.001    0.000    0.948    0.474 kb.py:75(score)
        1    0.000    0.000    0.336    0.336 simple.py:29(hop)
        1    0.000    0.000    0.335    0.335 kb.py:156(forward)
        3    0.251    0.084    0.253    0.084 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 11/16	Loss 4.870557

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.271 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.271    1.271 simple.py:52(score)
        3    0.000    0.000    1.268    0.423 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.268    0.423 profilehooks.py:348(__call__)
        3    0.001    0.000    1.257    0.419 kb.py:122(neighbors)
        9    1.049    0.117    1.050    0.117 nms.py:31(build)
        2    0.000    0.000    0.861    0.430 kb.py:75(score)
        1    0.000    0.000    0.408    0.408 simple.py:29(hop)
        1    0.000    0.000    0.407    0.407 kb.py:156(forward)
        3    0.201    0.067    0.202    0.067 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
      198    0.000    0.000    0.000    0.000 __init__.py:1530(getEffectiveLevel)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 12/16	Loss 4.863798

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.186 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.186    1.186 simple.py:52(score)
        3    0.000    0.000    1.183    0.394 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.183    0.394 profilehooks.py:348(__call__)
        3    0.001    0.000    1.165    0.388 kb.py:122(neighbors)
        9    0.983    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.818    0.409 kb.py:75(score)
        1    0.000    0.000    0.365    0.365 simple.py:29(hop)
        1    0.000    0.000    0.365    0.365 kb.py:156(forward)
        3    0.176    0.059    0.177    0.059 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 13/16	Loss 4.890917

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.173 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.173    1.173 simple.py:52(score)
        3    0.000    0.000    1.171    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.171    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.154    0.385 kb.py:122(neighbors)
        9    0.966    0.107    0.966    0.107 nms.py:31(build)
        2    0.000    0.000    0.784    0.392 kb.py:75(score)
        1    0.000    0.000    0.387    0.387 simple.py:29(hop)
        1    0.000    0.000    0.387    0.387 kb.py:156(forward)
        3    0.181    0.060    0.182    0.061 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 14/16	Loss 4.955493

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.058 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.058    1.058 simple.py:52(score)
        3    0.000    0.000    1.056    0.352 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.056    0.352 profilehooks.py:348(__call__)
        3    0.001    0.000    1.036    0.345 kb.py:122(neighbors)
        9    0.898    0.100    0.899    0.100 nms.py:31(build)
        2    0.001    0.000    0.738    0.369 kb.py:75(score)
        1    0.000    0.000    0.318    0.318 simple.py:29(hop)
        1    0.000    0.000    0.318    0.318 kb.py:156(forward)
        3    0.132    0.044    0.133    0.044 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 15/16	Loss 4.815032

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.137 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.137    1.137 simple.py:52(score)
        3    0.000    0.000    1.135    0.378 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.135    0.378 profilehooks.py:348(__call__)
        3    0.001    0.000    1.123    0.374 kb.py:122(neighbors)
        9    0.974    0.108    0.974    0.108 nms.py:31(build)
        2    0.000    0.000    0.803    0.402 kb.py:75(score)
        1    0.000    0.000    0.331    0.331 simple.py:29(hop)
        1    0.000    0.000    0.331    0.331 kb.py:156(forward)
        3    0.143    0.048    0.144    0.048 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 7/20	Batch 16/16	Loss 4.974731

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.375 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.375    1.375 simple.py:52(score)
        3    0.000    0.000    1.373    0.458 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.373    0.458 profilehooks.py:348(__call__)
        3    0.001    0.000    1.358    0.453 kb.py:122(neighbors)
        9    1.063    0.118    1.064    0.118 nms.py:31(build)
        2    0.001    0.000    0.963    0.482 kb.py:75(score)
        1    0.000    0.000    0.410    0.410 simple.py:29(hop)
        1    0.000    0.000    0.410    0.410 kb.py:156(forward)
        3    0.288    0.096    0.290    0.097 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 1/16	Loss 4.875196

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.118 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.118    1.118 simple.py:52(score)
        3    0.000    0.000    1.115    0.372 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.115    0.372 profilehooks.py:348(__call__)
        3    0.001    0.000    1.089    0.363 kb.py:122(neighbors)
        9    0.947    0.105    0.948    0.105 nms.py:31(build)
        2    0.000    0.000    0.786    0.393 kb.py:75(score)
        1    0.000    0.000    0.330    0.330 simple.py:29(hop)
        1    0.000    0.000    0.330    0.330 kb.py:156(forward)
        3    0.135    0.045    0.136    0.045 nms.py:51(query)
       18    0.016    0.001    0.016    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 2/16	Loss 4.953609

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.292 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.292    1.292 simple.py:52(score)
        3    0.000    0.000    1.289    0.430 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.289    0.430 profilehooks.py:348(__call__)
        3    0.001    0.000    1.276    0.425 kb.py:122(neighbors)
        9    1.099    0.122    1.099    0.122 nms.py:31(build)
        2    0.000    0.000    0.838    0.419 kb.py:75(score)
        1    0.000    0.000    0.451    0.451 simple.py:29(hop)
        1    0.000    0.000    0.451    0.451 kb.py:156(forward)
        3    0.170    0.057    0.172    0.057 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 3/16	Loss 4.601676

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.320 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.320    1.320 simple.py:52(score)
        3    0.000    0.000    1.318    0.439 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.318    0.439 profilehooks.py:348(__call__)
        3    0.001    0.000    1.305    0.435 kb.py:122(neighbors)
        9    1.067    0.119    1.068    0.119 nms.py:31(build)
        2    0.001    0.000    0.897    0.449 kb.py:75(score)
        1    0.000    0.000    0.420    0.420 simple.py:29(hop)
        1    0.000    0.000    0.420    0.420 kb.py:156(forward)
        3    0.230    0.077    0.232    0.077 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.002    0.001    0.002    0.001 {built-in method numpy.array}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 4/16	Loss 4.602660

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.468 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.468    1.468 simple.py:52(score)
        3    0.000    0.000    1.466    0.489 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.466    0.489 profilehooks.py:348(__call__)
        3    0.001    0.000    1.453    0.484 kb.py:122(neighbors)
        9    1.167    0.130    1.168    0.130 nms.py:31(build)
        2    0.000    0.000    1.036    0.518 kb.py:75(score)
        1    0.000    0.000    0.429    0.429 simple.py:29(hop)
        1    0.000    0.000    0.429    0.429 kb.py:156(forward)
        3    0.279    0.093    0.280    0.093 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 5/16	Loss 4.629806

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.142 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.142    1.142 simple.py:52(score)
        3    0.000    0.000    1.140    0.380 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.140    0.380 profilehooks.py:348(__call__)
        3    0.001    0.000    1.113    0.371 kb.py:122(neighbors)
        9    0.945    0.105    0.945    0.105 nms.py:31(build)
        2    0.000    0.000    0.773    0.386 kb.py:75(score)
        1    0.000    0.000    0.367    0.367 simple.py:29(hop)
        1    0.000    0.000    0.367    0.367 kb.py:156(forward)
        3    0.161    0.054    0.162    0.054 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 6/16	Loss 4.942839

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.126 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.126    1.126 simple.py:52(score)
        3    0.000    0.000    1.124    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.124    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.104    0.368 kb.py:122(neighbors)
        9    0.960    0.107    0.960    0.107 nms.py:31(build)
        2    0.000    0.000    0.733    0.367 kb.py:75(score)
        1    0.000    0.000    0.391    0.391 simple.py:29(hop)
        1    0.000    0.000    0.391    0.391 kb.py:156(forward)
        3    0.138    0.046    0.139    0.046 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 7/16	Loss 5.033076

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.160 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.160    1.160 simple.py:52(score)
        3    0.000    0.000    1.157    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.157    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.137    0.379 kb.py:122(neighbors)
        9    1.000    0.111    1.001    0.111 nms.py:31(build)
        2    0.001    0.000    0.751    0.375 kb.py:75(score)
        1    0.000    0.000    0.406    0.406 simple.py:29(hop)
        1    0.000    0.000    0.406    0.406 kb.py:156(forward)
        3    0.130    0.043    0.131    0.044 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 8/16	Loss 4.917005

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.167 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.167    1.167 simple.py:52(score)
        3    0.000    0.000    1.165    0.388 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.165    0.388 profilehooks.py:348(__call__)
        3    0.001    0.000    1.147    0.382 kb.py:122(neighbors)
        9    0.947    0.105    0.948    0.105 nms.py:31(build)
        2    0.000    0.000    0.827    0.413 kb.py:75(score)
        1    0.000    0.000    0.338    0.338 simple.py:29(hop)
        1    0.000    0.000    0.338    0.338 kb.py:156(forward)
        3    0.194    0.065    0.195    0.065 nms.py:51(query)
       18    0.009    0.001    0.009    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 9/16	Loss 4.736923

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.283 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.283    1.283 simple.py:52(score)
        3    0.000    0.000    1.281    0.427 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.281    0.427 profilehooks.py:348(__call__)
        3    0.001    0.000    1.262    0.421 kb.py:122(neighbors)
        9    0.954    0.106    0.954    0.106 nms.py:31(build)
        2    0.000    0.000    0.901    0.450 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.302    0.101    0.303    0.101 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 10/16	Loss 4.933374

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.306 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.306    1.306 simple.py:52(score)
        3    0.000    0.000    1.304    0.435 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.304    0.435 profilehooks.py:348(__call__)
        3    0.001    0.000    1.293    0.431 kb.py:122(neighbors)
        9    1.057    0.117    1.058    0.118 nms.py:31(build)
        2    0.000    0.000    0.862    0.431 kb.py:75(score)
        1    0.000    0.000    0.442    0.442 simple.py:29(hop)
        1    0.000    0.000    0.442    0.442 kb.py:156(forward)
        3    0.230    0.077    0.231    0.077 nms.py:51(query)
       18    0.004    0.000    0.004    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 11/16	Loss 4.591974

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.132 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.132    1.132 simple.py:52(score)
        3    0.000    0.000    1.130    0.377 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.130    0.377 profilehooks.py:348(__call__)
        3    0.001    0.000    1.109    0.370 kb.py:122(neighbors)
        9    0.944    0.105    0.945    0.105 nms.py:31(build)
        2    0.000    0.000    0.772    0.386 kb.py:75(score)
        1    0.000    0.000    0.358    0.358 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.158    0.053    0.159    0.053 nms.py:51(query)
       18    0.014    0.001    0.014    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 12/16	Loss 4.328124

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.243 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.243    1.243 simple.py:52(score)
        3    0.000    0.000    1.241    0.414 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.241    0.414 profilehooks.py:348(__call__)
        3    0.001    0.000    1.229    0.410 kb.py:122(neighbors)
        9    1.033    0.115    1.033    0.115 nms.py:31(build)
        2    0.000    0.000    0.872    0.436 kb.py:75(score)
        1    0.000    0.000    0.368    0.368 simple.py:29(hop)
        1    0.000    0.000    0.368    0.368 kb.py:156(forward)
        3    0.189    0.063    0.190    0.063 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 13/16	Loss 4.865817

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.172 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.171    1.171 simple.py:52(score)
        3    0.000    0.000    1.169    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.169    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.158    0.386 kb.py:122(neighbors)
        9    0.959    0.107    0.959    0.107 nms.py:31(build)
        2    0.000    0.000    0.807    0.403 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.193    0.064    0.194    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 14/16	Loss 4.489228

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.202 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.202    1.202 simple.py:52(score)
        3    0.000    0.000    1.200    0.400 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.200    0.400 profilehooks.py:348(__call__)
        3    0.001    0.000    1.186    0.395 kb.py:122(neighbors)
        9    1.032    0.115    1.033    0.115 nms.py:31(build)
        2    0.001    0.000    0.839    0.419 kb.py:75(score)
        1    0.000    0.000    0.361    0.361 simple.py:29(hop)
        1    0.000    0.000    0.361    0.361 kb.py:156(forward)
        3    0.147    0.049    0.148    0.049 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 15/16	Loss 4.579182

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.211 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.211    1.211 simple.py:52(score)
        3    0.000    0.000    1.209    0.403 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.209    0.403 profilehooks.py:348(__call__)
        3    0.001    0.000    1.196    0.399 kb.py:122(neighbors)
        9    0.985    0.109    0.986    0.110 nms.py:31(build)
        2    0.001    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.367    0.367 simple.py:29(hop)
        1    0.000    0.000    0.367    0.367 kb.py:156(forward)
        3    0.204    0.068    0.205    0.068 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 8/20	Batch 16/16	Loss 4.514321

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.136 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.136    1.136 simple.py:52(score)
        3    0.000    0.000    1.133    0.378 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.133    0.378 profilehooks.py:348(__call__)
        3    0.001    0.000    1.108    0.369 kb.py:122(neighbors)
        9    0.943    0.105    0.944    0.105 nms.py:31(build)
        2    0.000    0.000    0.775    0.387 kb.py:75(score)
        1    0.000    0.000    0.359    0.359 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.156    0.052    0.157    0.052 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 1/16	Loss 4.070047

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.176 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.176    1.176 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.152    0.384 kb.py:122(neighbors)
        9    0.950    0.106    0.951    0.106 nms.py:31(build)
        2    0.001    0.000    0.784    0.392 kb.py:75(score)
        1    0.000    0.000    0.389    0.389 simple.py:29(hop)
        1    0.000    0.000    0.389    0.389 kb.py:156(forward)
        3    0.195    0.065    0.196    0.065 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 2/16	Loss 4.453847

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.191 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.191    1.191 simple.py:52(score)
        3    0.000    0.000    1.189    0.396 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.189    0.396 profilehooks.py:348(__call__)
        3    0.001    0.000    1.167    0.389 kb.py:122(neighbors)
        9    0.980    0.109    0.981    0.109 nms.py:31(build)
        2    0.001    0.000    0.807    0.403 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.180    0.060    0.181    0.060 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 3/16	Loss 4.187644

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.242 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.242    1.242 simple.py:52(score)
        3    0.000    0.000    1.240    0.413 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.240    0.413 profilehooks.py:348(__call__)
        3    0.001    0.000    1.228    0.409 kb.py:122(neighbors)
        9    1.069    0.119    1.070    0.119 nms.py:31(build)
        2    0.000    0.000    0.798    0.399 kb.py:75(score)
        1    0.000    0.000    0.441    0.441 simple.py:29(hop)
        1    0.000    0.000    0.441    0.441 kb.py:156(forward)
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 4/16	Loss 4.349418

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.215 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.215    1.215 simple.py:52(score)
        3    0.000    0.000    1.212    0.404 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.212    0.404 profilehooks.py:348(__call__)
        3    0.001    0.000    1.193    0.398 kb.py:122(neighbors)
        9    1.026    0.114    1.027    0.114 nms.py:31(build)
        2    0.000    0.000    0.822    0.411 kb.py:75(score)
        1    0.000    0.000    0.390    0.390 simple.py:29(hop)
        1    0.000    0.000    0.390    0.390 kb.py:156(forward)
        3    0.160    0.053    0.161    0.054 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 5/16	Loss 4.744750

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.167 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.167    1.167 simple.py:52(score)
        3    0.000    0.000    1.164    0.388 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.164    0.388 profilehooks.py:348(__call__)
        3    0.001    0.000    1.147    0.382 kb.py:122(neighbors)
        9    0.986    0.110    0.987    0.110 nms.py:31(build)
        2    0.000    0.000    0.794    0.397 kb.py:75(score)
        1    0.000    0.000    0.370    0.370 simple.py:29(hop)
        1    0.000    0.000    0.370    0.370 kb.py:156(forward)
        3    0.154    0.051    0.155    0.052 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 6/16	Loss 4.651353

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.187    1.187 simple.py:52(score)
        3    0.000    0.000    1.185    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.185    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.162    0.387 kb.py:122(neighbors)
        9    0.996    0.111    0.997    0.111 nms.py:31(build)
        2    0.000    0.000    0.818    0.409 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.366    0.366 kb.py:156(forward)
        3    0.159    0.053    0.160    0.053 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 7/16	Loss 4.215077

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.152 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.152    1.152 simple.py:52(score)
        3    0.000    0.000    1.149    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.149    0.383 profilehooks.py:348(__call__)
        3    0.001    0.000    1.138    0.379 kb.py:122(neighbors)
        9    0.982    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.738    0.369 kb.py:75(score)
        1    0.000    0.000    0.412    0.412 simple.py:29(hop)
        1    0.000    0.000    0.412    0.412 kb.py:156(forward)
        3    0.149    0.050    0.150    0.050 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 8/16	Loss 4.193398

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.127 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.127    1.127 simple.py:52(score)
        3    0.000    0.000    1.124    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.124    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.112    0.371 kb.py:122(neighbors)
        9    0.946    0.105    0.947    0.105 nms.py:31(build)
        2    0.000    0.000    0.754    0.377 kb.py:75(score)
        1    0.000    0.000    0.370    0.370 simple.py:29(hop)
        1    0.000    0.000    0.370    0.370 kb.py:156(forward)
        3    0.160    0.053    0.161    0.054 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 9/16	Loss 4.257629

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.169 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.169    1.169 simple.py:52(score)
        3    0.000    0.000    1.167    0.389 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.167    0.389 profilehooks.py:348(__call__)
        3    0.001    0.000    1.145    0.382 kb.py:122(neighbors)
        9    0.965    0.107    0.965    0.107 nms.py:31(build)
        2    0.000    0.000    0.813    0.407 kb.py:75(score)
        1    0.000    0.000    0.354    0.354 simple.py:29(hop)
        1    0.000    0.000    0.354    0.354 kb.py:156(forward)
        3    0.173    0.058    0.174    0.058 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 10/16	Loss 4.267047

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.148 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.148    1.148 simple.py:52(score)
        3    0.000    0.000    1.146    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.146    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.134    0.378 kb.py:122(neighbors)
        9    0.947    0.105    0.947    0.105 nms.py:31(build)
        2    0.001    0.000    0.785    0.392 kb.py:75(score)
        1    0.000    0.000    0.361    0.361 simple.py:29(hop)
        1    0.000    0.000    0.361    0.361 kb.py:156(forward)
        3    0.180    0.060    0.181    0.060 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 11/16	Loss 4.467341

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.231 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.231    1.231 simple.py:52(score)
        3    0.000    0.000    1.228    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.228    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.200    0.400 kb.py:122(neighbors)
        9    1.009    0.112    1.009    0.112 nms.py:31(build)
        2    0.000    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.387    0.387 simple.py:29(hop)
        1    0.000    0.000    0.387    0.387 kb.py:156(forward)
        3    0.181    0.060    0.183    0.061 nms.py:51(query)
       18    0.021    0.001    0.021    0.001 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 12/16	Loss 4.325097

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.208 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.208    1.208 simple.py:52(score)
        3    0.000    0.000    1.206    0.402 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.206    0.402 profilehooks.py:348(__call__)
        3    0.001    0.000    1.186    0.395 kb.py:122(neighbors)
        9    0.983    0.109    0.984    0.109 nms.py:31(build)
        2    0.001    0.000    0.835    0.418 kb.py:75(score)
        1    0.000    0.000    0.370    0.370 simple.py:29(hop)
        1    0.000    0.000    0.370    0.370 kb.py:156(forward)
        3    0.195    0.065    0.196    0.065 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 13/16	Loss 4.363890

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.039 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.039    1.039 simple.py:52(score)
        3    0.000    0.000    1.036    0.345 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.036    0.345 profilehooks.py:348(__call__)
        3    0.001    0.000    1.024    0.341 kb.py:122(neighbors)
        9    0.884    0.098    0.885    0.098 nms.py:31(build)
        2    0.000    0.000    0.712    0.356 kb.py:75(score)
        1    0.000    0.000    0.324    0.324 simple.py:29(hop)
        1    0.000    0.000    0.324    0.324 kb.py:156(forward)
        3    0.133    0.044    0.134    0.045 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 14/16	Loss 4.200818

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.150 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.150    1.150 simple.py:52(score)
        3    0.000    0.000    1.148    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.148    0.383 profilehooks.py:348(__call__)
        3    0.001    0.000    1.136    0.379 kb.py:122(neighbors)
        9    0.940    0.104    0.941    0.105 nms.py:31(build)
        2    0.000    0.000    0.760    0.380 kb.py:75(score)
        1    0.000    0.000    0.388    0.388 simple.py:29(hop)
        1    0.000    0.000    0.388    0.388 kb.py:156(forward)
        3    0.189    0.063    0.191    0.064 nms.py:51(query)
       18    0.004    0.000    0.004    0.000 {built-in method cat}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 15/16	Loss 4.056475

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.103 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.103    1.103 simple.py:52(score)
        3    0.000    0.000    1.100    0.367 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.100    0.367 profilehooks.py:348(__call__)
        3    0.001    0.000    1.081    0.360 kb.py:122(neighbors)
        9    0.949    0.105    0.950    0.106 nms.py:31(build)
        2    0.000    0.000    0.764    0.382 kb.py:75(score)
        1    0.000    0.000    0.336    0.336 simple.py:29(hop)
        1    0.000    0.000    0.336    0.336 kb.py:156(forward)
        3    0.126    0.042    0.127    0.042 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 9/20	Batch 16/16	Loss 3.922578

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.153 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.153    1.153 simple.py:52(score)
        3    0.000    0.000    1.151    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.151    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.136    0.379 kb.py:122(neighbors)
        9    0.951    0.106    0.952    0.106 nms.py:31(build)
        2    0.001    0.000    0.807    0.404 kb.py:75(score)
        1    0.000    0.000    0.343    0.343 simple.py:29(hop)
        1    0.000    0.000    0.343    0.343 kb.py:156(forward)
        3    0.178    0.059    0.179    0.060 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 1/16	Loss 3.845459

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.325 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.325    1.325 simple.py:52(score)
        3    0.000    0.000    1.323    0.441 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.323    0.441 profilehooks.py:348(__call__)
        3    0.001    0.000    1.310    0.437 kb.py:122(neighbors)
        9    1.052    0.117    1.053    0.117 nms.py:31(build)
        2    0.000    0.000    0.970    0.485 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.252    0.084    0.253    0.084 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 2/16	Loss 4.128034

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.119 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.119    1.119 simple.py:52(score)
        3    0.000    0.000    1.116    0.372 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.116    0.372 profilehooks.py:348(__call__)
        3    0.001    0.000    1.097    0.366 kb.py:122(neighbors)
        9    0.958    0.106    0.958    0.106 nms.py:31(build)
        2    0.000    0.000    0.754    0.377 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.132    0.044    0.133    0.044 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 3/16	Loss 3.921651

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.131 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.131    1.131 simple.py:52(score)
        3    0.000    0.000    1.129    0.376 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.129    0.376 profilehooks.py:348(__call__)
        3    0.001    0.000    1.103    0.368 kb.py:122(neighbors)
        9    0.957    0.106    0.957    0.106 nms.py:31(build)
        2    0.000    0.000    0.739    0.370 kb.py:75(score)
        1    0.000    0.000    0.389    0.389 simple.py:29(hop)
        1    0.000    0.000    0.389    0.389 kb.py:156(forward)
        3    0.140    0.047    0.141    0.047 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 4/16	Loss 4.143840

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.166 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.166    1.166 simple.py:52(score)
        3    0.000    0.000    1.163    0.388 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.163    0.388 profilehooks.py:348(__call__)
        3    0.001    0.000    1.137    0.379 kb.py:122(neighbors)
        9    0.982    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.830    0.415 kb.py:75(score)
        1    0.000    0.000    0.334    0.334 simple.py:29(hop)
        1    0.000    0.000    0.334    0.334 kb.py:156(forward)
        3    0.148    0.049    0.149    0.050 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 5/16	Loss 3.777662

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.291 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.291    1.291 simple.py:52(score)
        3    0.000    0.000    1.289    0.430 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.289    0.430 profilehooks.py:348(__call__)
        3    0.001    0.000    1.269    0.423 kb.py:122(neighbors)
        9    1.106    0.123    1.107    0.123 nms.py:31(build)
        2    0.001    0.000    0.864    0.432 kb.py:75(score)
        1    0.000    0.000    0.425    0.425 simple.py:29(hop)
        1    0.000    0.000    0.425    0.425 kb.py:156(forward)
        3    0.155    0.052    0.157    0.052 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 6/16	Loss 3.686308

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.125 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.125    1.125 simple.py:52(score)
        3    0.000    0.000    1.122    0.374 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.122    0.374 profilehooks.py:348(__call__)
        3    0.001    0.000    1.108    0.369 kb.py:122(neighbors)
        9    0.987    0.110    0.988    0.110 nms.py:31(build)
        2    0.000    0.000    0.782    0.391 kb.py:75(score)
        1    0.000    0.000    0.339    0.339 simple.py:29(hop)
        1    0.000    0.000    0.339    0.339 kb.py:156(forward)
        3    0.113    0.038    0.114    0.038 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 7/16	Loss 4.058674

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.148 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.148    1.148 simple.py:52(score)
        3    0.000    0.000    1.146    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.146    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.133    0.378 kb.py:122(neighbors)
        9    1.006    0.112    1.007    0.112 nms.py:31(build)
        2    0.000    0.000    0.763    0.382 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.120    0.040    0.121    0.040 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 8/16	Loss 3.893395

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.211 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.211    1.211 simple.py:52(score)
        3    0.000    0.000    1.208    0.403 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.208    0.403 profilehooks.py:348(__call__)
        3    0.001    0.000    1.195    0.398 kb.py:122(neighbors)
        9    1.029    0.114    1.030    0.114 nms.py:31(build)
        2    0.001    0.000    0.807    0.404 kb.py:75(score)
        1    0.000    0.000    0.401    0.401 simple.py:29(hop)
        1    0.000    0.000    0.401    0.401 kb.py:156(forward)
        3    0.159    0.053    0.160    0.053 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 9/16	Loss 3.875883

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.323 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.323    1.323 simple.py:52(score)
        3    0.000    0.000    1.321    0.440 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.321    0.440 profilehooks.py:348(__call__)
        3    0.001    0.000    1.305    0.435 kb.py:122(neighbors)
        9    1.087    0.121    1.088    0.121 nms.py:31(build)
        2    0.001    0.000    0.925    0.463 kb.py:75(score)
        1    0.000    0.000    0.395    0.395 simple.py:29(hop)
        1    0.000    0.000    0.395    0.395 kb.py:156(forward)
        3    0.211    0.070    0.213    0.071 nms.py:51(query)
       18    0.008    0.000    0.008    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 10/16	Loss 4.086867

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.148 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.148    1.148 simple.py:52(score)
        3    0.000    0.000    1.146    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.146    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.119    0.373 kb.py:122(neighbors)
        9    0.975    0.108    0.976    0.108 nms.py:31(build)
        2    0.001    0.000    0.745    0.373 kb.py:75(score)
        1    0.000    0.000    0.400    0.400 simple.py:29(hop)
        1    0.000    0.000    0.400    0.400 kb.py:156(forward)
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 11/16	Loss 4.134840

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.202 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.202    1.202 simple.py:52(score)
        3    0.000    0.000    1.200    0.400 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.200    0.400 profilehooks.py:348(__call__)
        3    0.001    0.000    1.188    0.396 kb.py:122(neighbors)
        9    1.001    0.111    1.002    0.111 nms.py:31(build)
        2    0.000    0.000    0.847    0.423 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.180    0.060    0.181    0.060 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 12/16	Loss 3.884734

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.217 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.217    1.217 simple.py:52(score)
        3    0.000    0.000    1.215    0.405 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.215    0.405 profilehooks.py:348(__call__)
        3    0.001    0.000    1.200    0.400 kb.py:122(neighbors)
        9    0.961    0.107    0.962    0.107 nms.py:31(build)
        2    0.000    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.400    0.400 simple.py:29(hop)
        1    0.000    0.000    0.400    0.400 kb.py:156(forward)
        3    0.232    0.077    0.233    0.078 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 13/16	Loss 3.904532

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.190 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.190    1.190 simple.py:52(score)
        3    0.000    0.000    1.188    0.396 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.188    0.396 profilehooks.py:348(__call__)
        3    0.001    0.000    1.176    0.392 kb.py:122(neighbors)
        9    0.955    0.106    0.956    0.106 nms.py:31(build)
        2    0.000    0.000    0.824    0.412 kb.py:75(score)
        1    0.000    0.000    0.364    0.364 simple.py:29(hop)
        1    0.000    0.000    0.363    0.363 kb.py:156(forward)
        3    0.214    0.071    0.215    0.072 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 14/16	Loss 3.671036

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.175 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.175    1.175 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.161    0.387 kb.py:122(neighbors)
        9    0.975    0.108    0.976    0.108 nms.py:31(build)
        2    0.000    0.000    0.757    0.379 kb.py:75(score)
        1    0.000    0.000    0.416    0.416 simple.py:29(hop)
        1    0.000    0.000    0.415    0.415 kb.py:156(forward)
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 15/16	Loss 3.925090

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.199 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.199    1.199 simple.py:52(score)
        3    0.000    0.000    1.197    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.197    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.184    0.395 kb.py:122(neighbors)
        9    0.956    0.106    0.957    0.106 nms.py:31(build)
        2    0.001    0.000    0.849    0.425 kb.py:75(score)
        1    0.000    0.000    0.348    0.348 simple.py:29(hop)
        1    0.000    0.000    0.348    0.348 kb.py:156(forward)
        3    0.222    0.074    0.223    0.074 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 10/20	Batch 16/16	Loss 3.498293

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.147 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.147    1.147 simple.py:52(score)
        3    0.000    0.000    1.144    0.381 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.144    0.381 profilehooks.py:348(__call__)
        3    0.001    0.000    1.118    0.373 kb.py:122(neighbors)
        9    0.988    0.110    0.989    0.110 nms.py:31(build)
        2    0.000    0.000    0.789    0.395 kb.py:75(score)
        1    0.000    0.000    0.355    0.355 simple.py:29(hop)
        1    0.000    0.000    0.355    0.355 kb.py:156(forward)
        3    0.121    0.040    0.122    0.041 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 1/16	Loss 3.739456

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.193 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.193    1.193 simple.py:52(score)
        3    0.000    0.000    1.191    0.397 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.191    0.397 profilehooks.py:348(__call__)
        3    0.001    0.000    1.171    0.390 kb.py:122(neighbors)
        9    0.997    0.111    0.998    0.111 nms.py:31(build)
        2    0.000    0.000    0.812    0.406 kb.py:75(score)
        1    0.000    0.000    0.378    0.378 simple.py:29(hop)
        1    0.000    0.000    0.378    0.378 kb.py:156(forward)
        3    0.167    0.056    0.168    0.056 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 2/16	Loss 4.105267

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.321 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.321    1.321 simple.py:52(score)
        3    0.000    0.000    1.318    0.439 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.318    0.439 profilehooks.py:348(__call__)
        3    0.001    0.000    1.293    0.431 kb.py:122(neighbors)
        9    1.085    0.121    1.085    0.121 nms.py:31(build)
        2    0.000    0.000    0.930    0.465 kb.py:75(score)
        1    0.000    0.000    0.388    0.388 simple.py:29(hop)
        1    0.000    0.000    0.388    0.388 kb.py:156(forward)
        3    0.201    0.067    0.202    0.067 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 3/16	Loss 3.320149

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.185 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.185    1.185 simple.py:52(score)
        3    0.000    0.000    1.183    0.394 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.183    0.394 profilehooks.py:348(__call__)
        3    0.001    0.000    1.167    0.389 kb.py:122(neighbors)
        9    0.957    0.106    0.957    0.106 nms.py:31(build)
        2    0.001    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.368    0.368 simple.py:29(hop)
        1    0.000    0.000    0.368    0.368 kb.py:156(forward)
        3    0.204    0.068    0.205    0.068 nms.py:51(query)
       18    0.009    0.001    0.009    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 4/16	Loss 3.452727

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.216 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.216    1.216 simple.py:52(score)
        3    0.000    0.000    1.213    0.404 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.213    0.404 profilehooks.py:348(__call__)
        3    0.001    0.000    1.201    0.400 kb.py:122(neighbors)
        9    0.974    0.108    0.974    0.108 nms.py:31(build)
        2    0.000    0.000    0.834    0.417 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.379    0.379 kb.py:156(forward)
        3    0.221    0.074    0.222    0.074 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 5/16	Loss 3.184750

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.149    0.383 kb.py:122(neighbors)
        9    0.946    0.105    0.946    0.105 nms.py:31(build)
        2    0.001    0.000    0.803    0.401 kb.py:75(score)
        1    0.000    0.000    0.359    0.359 simple.py:29(hop)
        1    0.000    0.000    0.359    0.359 kb.py:156(forward)
        3    0.197    0.066    0.198    0.066 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 6/16	Loss 3.658507

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.212 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.212    1.212 simple.py:52(score)
        3    0.000    0.000    1.203    0.401 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.203    0.401 profilehooks.py:348(__call__)
        3    0.001    0.000    1.184    0.395 kb.py:122(neighbors)
        9    1.009    0.112    1.010    0.112 nms.py:31(build)
        2    0.000    0.000    0.819    0.410 kb.py:75(score)
        1    0.000    0.000    0.383    0.383 simple.py:29(hop)
        1    0.000    0.000    0.383    0.383 kb.py:156(forward)
        3    0.167    0.056    0.168    0.056 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.011    0.001 module.py:715(_call_impl)
        2    0.000    0.000    0.008    0.004 base.py:142(forward)
        2    0.000    0.000    0.008    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.008    0.003 linear.py:92(forward)
        3    0.000    0.000    0.008    0.003 functional.py:1669(linear)
        3    0.008    0.003    0.008    0.003 {built-in method addmm}
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 7/16	Loss 3.534015

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.158 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.158    1.158 simple.py:52(score)
        3    0.000    0.000    1.155    0.385 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.155    0.385 profilehooks.py:348(__call__)
        3    0.001    0.000    1.131    0.377 kb.py:122(neighbors)
        9    0.971    0.108    0.972    0.108 nms.py:31(build)
        2    0.000    0.000    0.778    0.389 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.154    0.051    0.155    0.052 nms.py:51(query)
       18    0.016    0.001    0.016    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 8/16	Loss 3.946803

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.219 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.219    1.219 simple.py:52(score)
        3    0.000    0.000    1.217    0.406 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.217    0.406 profilehooks.py:348(__call__)
        3    0.001    0.000    1.192    0.397 kb.py:122(neighbors)
        9    0.995    0.111    0.996    0.111 nms.py:31(build)
        2    0.000    0.000    0.811    0.406 kb.py:75(score)
        1    0.000    0.000    0.405    0.405 simple.py:29(hop)
        1    0.000    0.000    0.405    0.405 kb.py:156(forward)
        3    0.190    0.063    0.192    0.064 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 9/16	Loss 3.487742

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.091 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.091    1.091 simple.py:52(score)
        3    0.000    0.000    1.088    0.363 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.088    0.363 profilehooks.py:348(__call__)
        3    0.001    0.000    1.071    0.357 kb.py:122(neighbors)
        9    0.894    0.099    0.895    0.099 nms.py:31(build)
        2    0.001    0.000    0.716    0.358 kb.py:75(score)
        1    0.000    0.000    0.372    0.372 simple.py:29(hop)
        1    0.000    0.000    0.372    0.372 kb.py:156(forward)
        3    0.170    0.057    0.172    0.057 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 10/16	Loss 3.436718

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.198 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.198    1.198 simple.py:52(score)
        3    0.000    0.000    1.196    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.196    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.178    0.393 kb.py:122(neighbors)
        9    1.003    0.111    1.004    0.112 nms.py:31(build)
        2    0.000    0.000    0.812    0.406 kb.py:75(score)
        1    0.000    0.000    0.383    0.383 simple.py:29(hop)
        1    0.000    0.000    0.383    0.383 kb.py:156(forward)
        3    0.168    0.056    0.169    0.056 nms.py:51(query)
       15    0.008    0.001    0.008    0.001 {method 'repeat' of 'torch._C._TensorBase' objects}
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 11/16	Loss 3.585296

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.188 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.188    1.188 simple.py:52(score)
        3    0.000    0.000    1.186    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.186    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.167    0.389 kb.py:122(neighbors)
        9    0.977    0.109    0.977    0.109 nms.py:31(build)
        2    0.000    0.000    0.824    0.412 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.183    0.061    0.185    0.062 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 12/16	Loss 3.754207

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.115 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.115    1.115 simple.py:52(score)
        3    0.000    0.000    1.112    0.371 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.112    0.371 profilehooks.py:348(__call__)
        3    0.001    0.000    1.093    0.364 kb.py:122(neighbors)
        9    0.941    0.105    0.941    0.105 nms.py:31(build)
        2    0.000    0.000    0.777    0.389 kb.py:75(score)
        1    0.000    0.000    0.335    0.335 simple.py:29(hop)
        1    0.000    0.000    0.335    0.335 kb.py:156(forward)
        3    0.146    0.049    0.147    0.049 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 13/16	Loss 3.449594

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.117 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.117    1.117 simple.py:52(score)
        3    0.000    0.000    1.114    0.371 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.114    0.371 profilehooks.py:348(__call__)
        3    0.001    0.000    1.102    0.367 kb.py:122(neighbors)
        9    0.938    0.104    0.938    0.104 nms.py:31(build)
        2    0.001    0.000    0.755    0.378 kb.py:75(score)
        1    0.000    0.000    0.359    0.359 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.158    0.053    0.160    0.053 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 14/16	Loss 3.477481

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.215 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.215    1.215 simple.py:52(score)
        3    0.000    0.000    1.212    0.404 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.212    0.404 profilehooks.py:348(__call__)
        3    0.001    0.000    1.200    0.400 kb.py:122(neighbors)
        9    0.975    0.108    0.976    0.108 nms.py:31(build)
        2    0.000    0.000    0.867    0.433 kb.py:75(score)
        1    0.000    0.000    0.345    0.345 simple.py:29(hop)
        1    0.000    0.000    0.345    0.345 kb.py:156(forward)
        3    0.218    0.073    0.220    0.073 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 15/16	Loss 3.484005

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.191 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.191    1.191 simple.py:52(score)
        3    0.000    0.000    1.188    0.396 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.188    0.396 profilehooks.py:348(__call__)
        3    0.001    0.000    1.175    0.392 kb.py:122(neighbors)
        9    1.021    0.113    1.022    0.114 nms.py:31(build)
        2    0.001    0.001    0.790    0.395 kb.py:75(score)
        1    0.000    0.000    0.399    0.399 simple.py:29(hop)
        1    0.000    0.000    0.398    0.398 kb.py:156(forward)
        3    0.147    0.049    0.148    0.049 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.002    0.001    0.002    0.001 {built-in method numpy.array}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 11/20	Batch 16/16	Loss 3.442383

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.127 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.127    1.127 simple.py:52(score)
        3    0.000    0.000    1.125    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.125    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.110    0.370 kb.py:122(neighbors)
        9    0.978    0.109    0.979    0.109 nms.py:31(build)
        2    0.000    0.000    0.783    0.391 kb.py:75(score)
        1    0.000    0.000    0.342    0.342 simple.py:29(hop)
        1    0.000    0.000    0.342    0.342 kb.py:156(forward)
        3    0.124    0.041    0.126    0.042 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 1/16	Loss 3.575493

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.190 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.190    1.190 simple.py:52(score)
        3    0.000    0.000    1.187    0.396 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.187    0.396 profilehooks.py:348(__call__)
        3    0.001    0.000    1.176    0.392 kb.py:122(neighbors)
        9    0.996    0.111    0.996    0.111 nms.py:31(build)
        2    0.000    0.000    0.810    0.405 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.173    0.058    0.175    0.058 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 2/16	Loss 3.287682

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.112 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.112    1.112 simple.py:52(score)
        3    0.000    0.000    1.109    0.370 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.109    0.370 profilehooks.py:348(__call__)
        3    0.001    0.000    1.097    0.366 kb.py:122(neighbors)
        9    0.928    0.103    0.929    0.103 nms.py:31(build)
        2    0.000    0.000    0.779    0.390 kb.py:75(score)
        1    0.000    0.000    0.330    0.330 simple.py:29(hop)
        1    0.000    0.000    0.330    0.330 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 3/16	Loss 3.323334

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.219 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.219    1.219 simple.py:52(score)
        3    0.000    0.000    1.217    0.406 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.217    0.406 profilehooks.py:348(__call__)
        3    0.001    0.000    1.204    0.401 kb.py:122(neighbors)
        9    1.027    0.114    1.028    0.114 nms.py:31(build)
        2    0.000    0.000    0.858    0.429 kb.py:75(score)
        1    0.000    0.000    0.359    0.359 simple.py:29(hop)
        1    0.000    0.000    0.359    0.359 kb.py:156(forward)
        3    0.170    0.057    0.171    0.057 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 4/16	Loss 3.310088

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.145 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.145    1.145 simple.py:52(score)
        3    0.000    0.000    1.142    0.381 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.142    0.381 profilehooks.py:348(__call__)
        3    0.001    0.000    1.130    0.377 kb.py:122(neighbors)
        9    0.997    0.111    0.998    0.111 nms.py:31(build)
        2    0.000    0.000    0.798    0.399 kb.py:75(score)
        1    0.000    0.000    0.344    0.344 simple.py:29(hop)
        1    0.000    0.000    0.344    0.344 kb.py:156(forward)
        3    0.124    0.041    0.125    0.042 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 5/16	Loss 3.575906

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.177 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.177    1.177 simple.py:52(score)
        3    0.000    0.000    1.174    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.174    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.158    0.386 kb.py:122(neighbors)
        9    0.995    0.111    0.995    0.111 nms.py:31(build)
        2    0.000    0.000    0.798    0.399 kb.py:75(score)
        1    0.000    0.000    0.376    0.376 simple.py:29(hop)
        1    0.000    0.000    0.376    0.376 kb.py:156(forward)
        3    0.156    0.052    0.157    0.052 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 6/16	Loss 3.239762

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.211 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.211    1.211 simple.py:52(score)
        3    0.000    0.000    1.209    0.403 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.209    0.403 profilehooks.py:348(__call__)
        3    0.001    0.000    1.196    0.399 kb.py:122(neighbors)
        9    1.039    0.115    1.040    0.116 nms.py:31(build)
        2    0.000    0.000    0.832    0.416 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 7/16	Loss 3.494124

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.256 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.256    1.256 simple.py:52(score)
        3    0.000    0.000    1.254    0.418 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.254    0.418 profilehooks.py:348(__call__)
        3    0.001    0.000    1.231    0.410 kb.py:122(neighbors)
        9    0.998    0.111    0.999    0.111 nms.py:31(build)
        2    0.000    0.000    0.866    0.433 kb.py:75(score)
        1    0.000    0.000    0.388    0.388 simple.py:29(hop)
        1    0.000    0.000    0.388    0.388 kb.py:156(forward)
        3    0.226    0.075    0.227    0.076 nms.py:51(query)
       18    0.016    0.001    0.016    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 8/16	Loss 3.350698

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.143    0.381 kb.py:122(neighbors)
        9    0.966    0.107    0.966    0.107 nms.py:31(build)
        2    0.001    0.000    0.802    0.401 kb.py:75(score)
        1    0.000    0.000    0.360    0.360 simple.py:29(hop)
        1    0.000    0.000    0.360    0.360 kb.py:156(forward)
        3    0.170    0.057    0.171    0.057 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 9/16	Loss 3.133018

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.230 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.230    1.230 simple.py:52(score)
        3    0.000    0.000    1.228    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.228    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.206    0.402 kb.py:122(neighbors)
        9    0.996    0.111    0.997    0.111 nms.py:31(build)
        2    0.000    0.000    0.828    0.414 kb.py:75(score)
        1    0.000    0.000    0.400    0.400 simple.py:29(hop)
        1    0.000    0.000    0.400    0.400 kb.py:156(forward)
        3    0.203    0.068    0.205    0.068 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 10/16	Loss 3.127869

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.193 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.193    1.193 simple.py:52(score)
        3    0.000    0.000    1.190    0.397 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.190    0.397 profilehooks.py:348(__call__)
        3    0.001    0.000    1.168    0.389 kb.py:122(neighbors)
        9    0.964    0.107    0.964    0.107 nms.py:31(build)
        2    0.000    0.000    0.859    0.430 kb.py:75(score)
        1    0.000    0.000    0.331    0.331 simple.py:29(hop)
        1    0.000    0.000    0.331    0.331 kb.py:156(forward)
        3    0.198    0.066    0.199    0.066 nms.py:51(query)
       18    0.014    0.001    0.014    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 11/16	Loss 3.182525

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.172 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.172    1.172 simple.py:52(score)
        3    0.000    0.000    1.170    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.170    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.158    0.386 kb.py:122(neighbors)
        9    0.990    0.110    0.991    0.110 nms.py:31(build)
        2    0.000    0.000    0.804    0.402 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.365    0.365 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 12/16	Loss 3.820982

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.267 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.267    1.267 simple.py:52(score)
        3    0.000    0.000    1.264    0.421 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.264    0.421 profilehooks.py:348(__call__)
        3    0.001    0.000    1.252    0.417 kb.py:122(neighbors)
        9    1.042    0.116    1.043    0.116 nms.py:31(build)
        2    0.000    0.000    0.876    0.438 kb.py:75(score)
        1    0.000    0.000    0.389    0.389 simple.py:29(hop)
        1    0.000    0.000    0.389    0.389 kb.py:156(forward)
        3    0.203    0.068    0.204    0.068 nms.py:51(query)
       18    0.004    0.000    0.004    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 13/16	Loss 3.084188

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.187    1.187 simple.py:52(score)
        3    0.000    0.000    1.184    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.184    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.157    0.386 kb.py:122(neighbors)
        9    1.004    0.112    1.005    0.112 nms.py:31(build)
        2    0.001    0.000    0.790    0.395 kb.py:75(score)
        1    0.000    0.000    0.395    0.395 simple.py:29(hop)
        1    0.000    0.000    0.394    0.394 kb.py:156(forward)
        3    0.146    0.049    0.147    0.049 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 14/16	Loss 3.233310

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.245 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.245    1.245 simple.py:52(score)
        3    0.000    0.000    1.242    0.414 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.242    0.414 profilehooks.py:348(__call__)
        3    0.001    0.000    1.222    0.407 kb.py:122(neighbors)
        9    1.013    0.113    1.014    0.113 nms.py:31(build)
        2    0.000    0.000    0.879    0.440 kb.py:75(score)
        1    0.000    0.000    0.363    0.363 simple.py:29(hop)
        1    0.000    0.000    0.363    0.363 kb.py:156(forward)
        3    0.200    0.067    0.201    0.067 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 15/16	Loss 2.741627

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.198 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.198    1.198 simple.py:52(score)
        3    0.000    0.000    1.196    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.196    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.185    0.395 kb.py:122(neighbors)
        9    1.021    0.113    1.022    0.114 nms.py:31(build)
        2    0.000    0.000    0.796    0.398 kb.py:75(score)
        1    0.000    0.000    0.400    0.400 simple.py:29(hop)
        1    0.000    0.000    0.400    0.400 kb.py:156(forward)
        3    0.158    0.053    0.159    0.053 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 12/20	Batch 16/16	Loss 2.984774

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.172 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.172    1.172 simple.py:52(score)
        3    0.000    0.000    1.169    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.169    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.157    0.386 kb.py:122(neighbors)
        9    0.946    0.105    0.947    0.105 nms.py:31(build)
        2    0.000    0.000    0.812    0.406 kb.py:75(score)
        1    0.000    0.000    0.358    0.358 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.205    0.068    0.206    0.069 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 1/16	Loss 3.380090

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.115 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.115    1.115 simple.py:52(score)
        3    0.000    0.000    1.113    0.371 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.113    0.371 profilehooks.py:348(__call__)
        3    0.001    0.000    1.101    0.367 kb.py:122(neighbors)
        9    0.982    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.732    0.366 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.112    0.037    0.113    0.038 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 2/16	Loss 3.223407

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.175 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.175    1.175 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.157    0.386 kb.py:122(neighbors)
        9    0.981    0.109    0.981    0.109 nms.py:31(build)
        2    0.000    0.000    0.777    0.389 kb.py:75(score)
        1    0.000    0.000    0.395    0.395 simple.py:29(hop)
        1    0.000    0.000    0.395    0.395 kb.py:156(forward)
        3    0.170    0.057    0.171    0.057 nms.py:51(query)
       18    0.009    0.001    0.009    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 3/16	Loss 3.338025

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.120 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.120    1.120 simple.py:52(score)
        3    0.000    0.000    1.118    0.373 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.118    0.373 profilehooks.py:348(__call__)
        3    0.001    0.000    1.105    0.368 kb.py:122(neighbors)
        9    0.937    0.104    0.938    0.104 nms.py:31(build)
        2    0.000    0.000    0.778    0.389 kb.py:75(score)
        1    0.000    0.000    0.339    0.339 simple.py:29(hop)
        1    0.000    0.000    0.339    0.339 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 4/16	Loss 2.733962

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.117 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.117    1.117 simple.py:52(score)
        3    0.000    0.000    1.115    0.372 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.115    0.372 profilehooks.py:348(__call__)
        3    0.001    0.000    1.102    0.367 kb.py:122(neighbors)
        9    0.943    0.105    0.944    0.105 nms.py:31(build)
        2    0.000    0.000    0.763    0.381 kb.py:75(score)
        1    0.000    0.000    0.352    0.352 simple.py:29(hop)
        1    0.000    0.000    0.352    0.352 kb.py:156(forward)
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 5/16	Loss 3.114478

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.178 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.178    1.178 simple.py:52(score)
        3    0.000    0.000    1.175    0.392 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.175    0.392 profilehooks.py:348(__call__)
        3    0.001    0.000    1.154    0.385 kb.py:122(neighbors)
        9    0.992    0.110    0.993    0.110 nms.py:31(build)
        2    0.001    0.000    0.794    0.397 kb.py:75(score)
        1    0.000    0.000    0.381    0.381 simple.py:29(hop)
        1    0.000    0.000    0.381    0.381 kb.py:156(forward)
        3    0.155    0.052    0.156    0.052 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 6/16	Loss 3.276635

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.114 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.114    1.114 simple.py:52(score)
        3    0.000    0.000    1.111    0.370 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.111    0.370 profilehooks.py:348(__call__)
        3    0.001    0.000    1.090    0.363 kb.py:122(neighbors)
        9    0.946    0.105    0.947    0.105 nms.py:31(build)
        2    0.001    0.000    0.762    0.381 kb.py:75(score)
        1    0.000    0.000    0.349    0.349 simple.py:29(hop)
        1    0.000    0.000    0.349    0.349 kb.py:156(forward)
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 7/16	Loss 3.332449

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.256 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.256    1.256 simple.py:52(score)
        3    0.000    0.000    1.254    0.418 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.254    0.418 profilehooks.py:348(__call__)
        3    0.001    0.000    1.241    0.414 kb.py:122(neighbors)
        9    1.053    0.117    1.054    0.117 nms.py:31(build)
        2    0.001    0.000    0.845    0.423 kb.py:75(score)
        1    0.000    0.000    0.408    0.408 simple.py:29(hop)
        1    0.000    0.000    0.408    0.408 kb.py:156(forward)
        3    0.180    0.060    0.181    0.060 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 8/16	Loss 3.362612

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.277 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.277    1.277 simple.py:52(score)
        3    0.000    0.000    1.274    0.425 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.274    0.425 profilehooks.py:348(__call__)
        3    0.001    0.000    1.262    0.421 kb.py:122(neighbors)
        9    0.997    0.111    0.998    0.111 nms.py:31(build)
        2    0.001    0.000    0.910    0.455 kb.py:75(score)
        1    0.000    0.000    0.364    0.364 simple.py:29(hop)
        1    0.000    0.000    0.364    0.364 kb.py:156(forward)
        3    0.257    0.086    0.258    0.086 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 9/16	Loss 2.825583

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.199 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.199    1.199 simple.py:52(score)
        3    0.000    0.000    1.197    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.197    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.172    0.391 kb.py:122(neighbors)
        9    1.018    0.113    1.019    0.113 nms.py:31(build)
        2    0.000    0.000    0.793    0.396 kb.py:75(score)
        1    0.000    0.000    0.404    0.404 simple.py:29(hop)
        1    0.000    0.000    0.404    0.404 kb.py:156(forward)
        3    0.148    0.049    0.149    0.050 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 10/16	Loss 3.280848

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.272 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.272    1.272 simple.py:52(score)
        3    0.000    0.000    1.269    0.423 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.269    0.423 profilehooks.py:348(__call__)
        3    0.001    0.000    1.256    0.419 kb.py:122(neighbors)
        9    1.056    0.117    1.056    0.117 nms.py:31(build)
        2    0.000    0.000    0.851    0.426 kb.py:75(score)
        1    0.000    0.000    0.418    0.418 simple.py:29(hop)
        1    0.000    0.000    0.417    0.417 kb.py:156(forward)
        3    0.193    0.064    0.194    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 11/16	Loss 2.818458

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.272 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.272    1.272 simple.py:52(score)
        3    0.000    0.000    1.270    0.423 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.270    0.423 profilehooks.py:348(__call__)
        3    0.001    0.000    1.245    0.415 kb.py:122(neighbors)
        9    1.016    0.113    1.016    0.113 nms.py:31(build)
        2    0.000    0.000    0.933    0.466 kb.py:75(score)
        1    0.000    0.000    0.337    0.337 simple.py:29(hop)
        1    0.000    0.000    0.337    0.337 kb.py:156(forward)
        3    0.222    0.074    0.223    0.074 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 12/16	Loss 3.170727

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.128 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.128    1.128 simple.py:52(score)
        3    0.000    0.000    1.125    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.125    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.101    0.367 kb.py:122(neighbors)
        9    0.964    0.107    0.964    0.107 nms.py:31(build)
        2    0.000    0.000    0.773    0.386 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.352    0.352 kb.py:156(forward)
        3    0.128    0.043    0.130    0.043 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 13/16	Loss 2.843395

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.175 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.175    1.175 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.151    0.384 kb.py:122(neighbors)
        9    0.969    0.108    0.969    0.108 nms.py:31(build)
        2    0.000    0.000    0.791    0.396 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.174    0.058    0.176    0.059 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 14/16	Loss 3.059528

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.153 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.152    1.152 simple.py:52(score)
        3    0.000    0.000    1.150    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.150    0.383 profilehooks.py:348(__call__)
        3    0.001    0.000    1.138    0.379 kb.py:122(neighbors)
        9    0.956    0.106    0.957    0.106 nms.py:31(build)
        2    0.000    0.000    0.806    0.403 kb.py:75(score)
        1    0.000    0.000    0.344    0.344 simple.py:29(hop)
        1    0.000    0.000    0.344    0.344 kb.py:156(forward)
        3    0.176    0.059    0.177    0.059 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 15/16	Loss 2.484510

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.173 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.173    1.173 simple.py:52(score)
        3    0.000    0.000    1.171    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.171    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.152    0.384 kb.py:122(neighbors)
        9    1.007    0.112    1.008    0.112 nms.py:31(build)
        2    0.000    0.000    0.830    0.415 kb.py:75(score)
        1    0.000    0.000    0.340    0.340 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 13/20	Batch 16/16	Loss 2.460125

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.139 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.139    1.139 simple.py:52(score)
        3    0.000    0.000    1.137    0.379 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.137    0.379 profilehooks.py:348(__call__)
        3    0.001    0.000    1.119    0.373 kb.py:122(neighbors)
        9    0.988    0.110    0.989    0.110 nms.py:31(build)
        2    0.001    0.000    0.773    0.386 kb.py:75(score)
        1    0.000    0.000    0.364    0.364 simple.py:29(hop)
        1    0.000    0.000    0.364    0.364 kb.py:156(forward)
        3    0.124    0.041    0.125    0.042 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 1/16	Loss 2.994948

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.253 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.253    1.253 simple.py:52(score)
        3    0.000    0.000    1.250    0.417 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.250    0.417 profilehooks.py:348(__call__)
        3    0.001    0.000    1.237    0.412 kb.py:122(neighbors)
        9    1.034    0.115    1.035    0.115 nms.py:31(build)
        2    0.001    0.000    0.779    0.390 kb.py:75(score)
        1    0.000    0.000    0.471    0.471 simple.py:29(hop)
        1    0.000    0.000    0.470    0.470 kb.py:156(forward)
        3    0.196    0.065    0.197    0.066 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 2/16	Loss 2.832659

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.223 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.223    1.223 simple.py:52(score)
        3    0.000    0.000    1.221    0.407 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.221    0.407 profilehooks.py:348(__call__)
        3    0.001    0.000    1.199    0.400 kb.py:122(neighbors)
        9    0.991    0.110    0.992    0.110 nms.py:31(build)
        2    0.001    0.000    0.832    0.416 kb.py:75(score)
        1    0.000    0.000    0.389    0.389 simple.py:29(hop)
        1    0.000    0.000    0.389    0.389 kb.py:156(forward)
        3    0.200    0.067    0.201    0.067 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 3/16	Loss 2.559226

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.124 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.124    1.124 simple.py:52(score)
        3    0.000    0.000    1.121    0.374 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.121    0.374 profilehooks.py:348(__call__)
        3    0.001    0.000    1.099    0.366 kb.py:122(neighbors)
        9    0.976    0.108    0.977    0.109 nms.py:31(build)
        2    0.001    0.000    0.729    0.364 kb.py:75(score)
        1    0.000    0.000    0.392    0.392 simple.py:29(hop)
        1    0.000    0.000    0.392    0.392 kb.py:156(forward)
        3    0.116    0.039    0.117    0.039 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 4/16	Loss 2.686240

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.114 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.114    1.114 simple.py:52(score)
        3    0.000    0.000    1.112    0.371 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.112    0.371 profilehooks.py:348(__call__)
        3    0.001    0.000    1.099    0.366 kb.py:122(neighbors)
        9    0.961    0.107    0.962    0.107 nms.py:31(build)
        2    0.000    0.000    0.766    0.383 kb.py:75(score)
        1    0.000    0.000    0.346    0.346 simple.py:29(hop)
        1    0.000    0.000    0.345    0.345 kb.py:156(forward)
        3    0.132    0.044    0.134    0.045 nms.py:51(query)
       18    0.004    0.000    0.004    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 5/16	Loss 2.611626

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.202 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.202    1.202 simple.py:52(score)
        3    0.000    0.000    1.199    0.400 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.199    0.400 profilehooks.py:348(__call__)
        3    0.001    0.000    1.179    0.393 kb.py:122(neighbors)
        9    1.000    0.111    1.001    0.111 nms.py:31(build)
        2    0.000    0.000    0.787    0.393 kb.py:75(score)
        1    0.000    0.000    0.412    0.412 simple.py:29(hop)
        1    0.000    0.000    0.412    0.412 kb.py:156(forward)
        3    0.172    0.057    0.173    0.058 nms.py:51(query)
       18    0.014    0.001    0.014    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 6/16	Loss 2.780305

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.266 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.266    1.266 simple.py:52(score)
        3    0.000    0.000    1.263    0.421 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.263    0.421 profilehooks.py:348(__call__)
        3    0.001    0.000    1.238    0.413 kb.py:122(neighbors)
        9    0.982    0.109    0.983    0.109 nms.py:31(build)
        2    0.001    0.000    0.924    0.462 kb.py:75(score)
        1    0.000    0.000    0.339    0.339 simple.py:29(hop)
        1    0.000    0.000    0.339    0.339 kb.py:156(forward)
        3    0.245    0.082    0.246    0.082 nms.py:51(query)
       18    0.022    0.001    0.022    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 7/16	Loss 3.125290

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.152 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.152    1.152 simple.py:52(score)
        3    0.000    0.000    1.150    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.150    0.383 profilehooks.py:348(__call__)
        3    0.001    0.000    1.137    0.379 kb.py:122(neighbors)
        9    0.952    0.106    0.952    0.106 nms.py:31(build)
        2    0.001    0.000    0.799    0.399 kb.py:75(score)
        1    0.000    0.000    0.351    0.351 simple.py:29(hop)
        1    0.000    0.000    0.351    0.351 kb.py:156(forward)
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 8/16	Loss 3.146742

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.215 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.215    1.215 simple.py:52(score)
        3    0.000    0.000    1.213    0.404 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.213    0.404 profilehooks.py:348(__call__)
        3    0.001    0.000    1.201    0.400 kb.py:122(neighbors)
        9    1.001    0.111    1.001    0.111 nms.py:31(build)
        2    0.001    0.000    0.846    0.423 kb.py:75(score)
        1    0.000    0.000    0.367    0.367 simple.py:29(hop)
        1    0.000    0.000    0.367    0.367 kb.py:156(forward)
        3    0.193    0.064    0.194    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 9/16	Loss 2.744095

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.154 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.154    1.154 simple.py:52(score)
        3    0.000    0.000    1.152    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.152    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.135    0.378 kb.py:122(neighbors)
        9    0.944    0.105    0.945    0.105 nms.py:31(build)
        2    0.000    0.000    0.781    0.391 kb.py:75(score)
        1    0.000    0.000    0.370    0.370 simple.py:29(hop)
        1    0.000    0.000    0.370    0.370 kb.py:156(forward)
        3    0.184    0.061    0.185    0.062 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 10/16	Loss 3.304042

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.203 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.203    1.203 simple.py:52(score)
        3    0.000    0.000    1.200    0.400 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.200    0.400 profilehooks.py:348(__call__)
        3    0.001    0.000    1.177    0.392 kb.py:122(neighbors)
        9    1.015    0.113    1.016    0.113 nms.py:31(build)
        2    0.000    0.000    0.801    0.401 kb.py:75(score)
        1    0.000    0.000    0.399    0.399 simple.py:29(hop)
        1    0.000    0.000    0.399    0.399 kb.py:156(forward)
        3    0.154    0.051    0.155    0.052 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 11/16	Loss 2.790643

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.154 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.154    1.154 simple.py:52(score)
        3    0.000    0.000    1.152    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.152    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.137    0.379 kb.py:122(neighbors)
        9    1.003    0.111    1.004    0.112 nms.py:31(build)
        2    0.000    0.000    0.821    0.410 kb.py:75(score)
        1    0.000    0.000    0.331    0.331 simple.py:29(hop)
        1    0.000    0.000    0.331    0.331 kb.py:156(forward)
        3    0.127    0.042    0.129    0.043 nms.py:51(query)
       18    0.006    0.000    0.006    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 12/16	Loss 2.656126

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.158 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.158    1.158 simple.py:52(score)
        3    0.000    0.000    1.156    0.385 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.156    0.385 profilehooks.py:348(__call__)
        3    0.001    0.000    1.144    0.381 kb.py:122(neighbors)
        9    0.962    0.107    0.963    0.107 nms.py:31(build)
        2    0.000    0.000    0.816    0.408 kb.py:75(score)
        1    0.000    0.000    0.340    0.340 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.175    0.058    0.176    0.059 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 13/16	Loss 2.995367

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.226 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.226    1.226 simple.py:52(score)
        3    0.000    0.000    1.223    0.408 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.223    0.408 profilehooks.py:348(__call__)
        3    0.001    0.000    1.207    0.402 kb.py:122(neighbors)
        9    1.008    0.112    1.008    0.112 nms.py:31(build)
        2    0.000    0.000    0.801    0.400 kb.py:75(score)
        1    0.000    0.000    0.423    0.423 simple.py:29(hop)
        1    0.000    0.000    0.422    0.422 kb.py:156(forward)
        3    0.192    0.064    0.193    0.064 nms.py:51(query)
       18    0.009    0.000    0.009    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 14/16	Loss 2.950384

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.227 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.227    1.227 simple.py:52(score)
        3    0.000    0.000    1.225    0.408 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.224    0.408 profilehooks.py:348(__call__)
        3    0.001    0.000    1.212    0.404 kb.py:122(neighbors)
        9    0.993    0.110    0.994    0.110 nms.py:31(build)
        2    0.000    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.212    0.071    0.213    0.071 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 15/16	Loss 2.778967

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.134 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.134    1.134 simple.py:52(score)
        3    0.000    0.000    1.132    0.377 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.132    0.377 profilehooks.py:348(__call__)
        3    0.001    0.000    1.113    0.371 kb.py:122(neighbors)
        9    0.954    0.106    0.955    0.106 nms.py:31(build)
        2    0.000    0.000    0.756    0.378 kb.py:75(score)
        1    0.000    0.000    0.376    0.376 simple.py:29(hop)
        1    0.000    0.000    0.376    0.376 kb.py:156(forward)
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 14/20	Batch 16/16	Loss 2.799969
/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729128610/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() > 0
/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/torch/nn/modules/container.py:434: UserWarning: Setting attributes on ParameterList is not supported.
  warnings.warn("Setting attributes on ParameterList is not supported.")
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 1/20\tLoss 7.4563 \xb1 0.1118'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 2/20\tLoss 7.1315 \xb1 0.0985'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 3/20\tLoss 6.7524 \xb1 0.1852'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 4/20\tLoss 6.3486 \xb1 0.1914'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 5/20\tLoss 5.9387 \xb1 0.2860'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 6/20\tLoss 5.5439 \xb1 0.2266'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 7/20\tLoss 5.1435 \xb1 0.2296'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 8/20\tLoss 4.7247 \xb1 0.2020'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 48: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 9/20\tLoss 4.2954 \xb1 0.2059'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 10/20\tLoss 3.9023 \xb1 0.1778'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 11/20\tLoss 3.5662 \xb1 0.2231'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 12/20\tLoss 3.2791 \xb1 0.2493'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 13/20\tLoss 3.0441 \xb1 0.2997'
Arguments: ()
--- Logging error ---

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.318 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.318    1.318 simple.py:52(score)
        3    0.000    0.000    1.315    0.438 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.315    0.438 profilehooks.py:348(__call__)
        3    0.001    0.000    1.293    0.431 kb.py:122(neighbors)
        9    1.039    0.115    1.040    0.116 nms.py:31(build)
        2    0.001    0.000    0.959    0.480 kb.py:75(score)
        1    0.000    0.000    0.355    0.355 simple.py:29(hop)
        1    0.000    0.000    0.355    0.355 kb.py:156(forward)
        3    0.243    0.081    0.244    0.081 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 1/16	Loss 2.605733

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.147 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.147    1.147 simple.py:52(score)
        3    0.000    0.000    1.145    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.145    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.131    0.377 kb.py:122(neighbors)
        9    0.961    0.107    0.962    0.107 nms.py:31(build)
        2    0.001    0.000    0.790    0.395 kb.py:75(score)
        1    0.000    0.000    0.355    0.355 simple.py:29(hop)
        1    0.000    0.000    0.355    0.355 kb.py:156(forward)
        3    0.163    0.054    0.164    0.055 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 2/16	Loss 2.634060

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.336 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.336    1.336 simple.py:52(score)
        3    0.000    0.000    1.334    0.445 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.334    0.445 profilehooks.py:348(__call__)
        3    0.001    0.000    1.321    0.440 kb.py:122(neighbors)
        9    1.087    0.121    1.088    0.121 nms.py:31(build)
        2    0.000    0.000    0.886    0.443 kb.py:75(score)
        1    0.000    0.000    0.448    0.448 simple.py:29(hop)
        1    0.000    0.000    0.447    0.447 kb.py:156(forward)
        3    0.227    0.076    0.229    0.076 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 3/16	Loss 2.789863

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.145 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.145    1.145 simple.py:52(score)
        3    0.000    0.000    1.143    0.381 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.143    0.381 profilehooks.py:348(__call__)
        3    0.001    0.000    1.125    0.375 kb.py:122(neighbors)
        9    0.973    0.108    0.974    0.108 nms.py:31(build)
        2    0.000    0.000    0.764    0.382 kb.py:75(score)
        1    0.000    0.000    0.378    0.378 simple.py:29(hop)
        1    0.000    0.000    0.378    0.378 kb.py:156(forward)
        3    0.145    0.048    0.146    0.049 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 4/16	Loss 3.022400

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.203 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.203    1.203 simple.py:52(score)
        3    0.000    0.000    1.200    0.400 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.200    0.400 profilehooks.py:348(__call__)
        3    0.001    0.000    1.184    0.395 kb.py:122(neighbors)
        9    1.004    0.112    1.005    0.112 nms.py:31(build)
        2    0.001    0.000    0.807    0.403 kb.py:75(score)
        1    0.000    0.000    0.393    0.393 simple.py:29(hop)
        1    0.000    0.000    0.393    0.393 kb.py:156(forward)
        3    0.173    0.058    0.174    0.058 nms.py:51(query)
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 5/16	Loss 2.623138

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.189 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.189    1.189 simple.py:52(score)
        3    0.000    0.000    1.186    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.186    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.175    0.392 kb.py:122(neighbors)
        9    0.963    0.107    0.964    0.107 nms.py:31(build)
        2    0.000    0.000    0.819    0.409 kb.py:75(score)
        1    0.000    0.000    0.368    0.368 simple.py:29(hop)
        1    0.000    0.000    0.368    0.368 kb.py:156(forward)
        3    0.205    0.068    0.206    0.069 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 6/16	Loss 2.540799

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.159 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.159    1.159 simple.py:52(score)
        3    0.000    0.000    1.157    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.157    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.144    0.381 kb.py:122(neighbors)
        9    0.984    0.109    0.985    0.109 nms.py:31(build)
        2    0.000    0.000    0.771    0.385 kb.py:75(score)
        1    0.000    0.000    0.386    0.386 simple.py:29(hop)
        1    0.000    0.000    0.386    0.386 kb.py:156(forward)
        3    0.153    0.051    0.154    0.051 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 7/16	Loss 3.001858

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.182 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.182    1.182 simple.py:52(score)
        3    0.000    0.000    1.180    0.393 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.180    0.393 profilehooks.py:348(__call__)
        3    0.001    0.000    1.153    0.384 kb.py:122(neighbors)
        9    0.995    0.111    0.996    0.111 nms.py:31(build)
        2    0.000    0.000    0.805    0.402 kb.py:75(score)
        1    0.000    0.000    0.375    0.375 simple.py:29(hop)
        1    0.000    0.000    0.375    0.375 kb.py:156(forward)
        3    0.147    0.049    0.149    0.050 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 8/16	Loss 2.503875

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.158 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.158    1.158 simple.py:52(score)
        3    0.000    0.000    1.156    0.385 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.156    0.385 profilehooks.py:348(__call__)
        3    0.001    0.000    1.129    0.376 kb.py:122(neighbors)
        9    0.983    0.109    0.983    0.109 nms.py:31(build)
        2    0.000    0.000    0.797    0.399 kb.py:75(score)
        1    0.000    0.000    0.358    0.358 simple.py:29(hop)
        1    0.000    0.000    0.358    0.358 kb.py:156(forward)
        3    0.140    0.047    0.141    0.047 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 9/16	Loss 2.765826

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.289 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.289    1.289 simple.py:52(score)
        3    0.000    0.000    1.286    0.429 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.286    0.429 profilehooks.py:348(__call__)
        3    0.001    0.000    1.272    0.424 kb.py:122(neighbors)
        9    1.036    0.115    1.037    0.115 nms.py:31(build)
        2    0.000    0.000    0.834    0.417 kb.py:75(score)
        1    0.000    0.000    0.452    0.452 simple.py:29(hop)
        1    0.000    0.000    0.452    0.452 kb.py:156(forward)
        3    0.230    0.077    0.231    0.077 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 10/16	Loss 2.918098

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.150    0.383 kb.py:122(neighbors)
        9    0.976    0.108    0.977    0.109 nms.py:31(build)
        2    0.001    0.000    0.780    0.390 kb.py:75(score)
        1    0.000    0.000    0.382    0.382 simple.py:29(hop)
        1    0.000    0.000    0.382    0.382 kb.py:156(forward)
        3    0.168    0.056    0.169    0.056 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 11/16	Loss 2.733469

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.207 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.207    1.207 simple.py:52(score)
        3    0.000    0.000    1.205    0.402 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.205    0.402 profilehooks.py:348(__call__)
        3    0.001    0.000    1.189    0.396 kb.py:122(neighbors)
        9    0.934    0.104    0.934    0.104 nms.py:31(build)
        2    0.000    0.000    0.851    0.425 kb.py:75(score)
        1    0.000    0.000    0.354    0.354 simple.py:29(hop)
        1    0.000    0.000    0.354    0.354 kb.py:156(forward)
        3    0.249    0.083    0.250    0.083 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 12/16	Loss 2.739397

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.193 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.193    1.193 simple.py:52(score)
        3    0.000    0.000    1.190    0.397 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.190    0.397 profilehooks.py:348(__call__)
        3    0.001    0.000    1.178    0.393 kb.py:122(neighbors)
        9    1.041    0.116    1.042    0.116 nms.py:31(build)
        2    0.000    0.000    0.790    0.395 kb.py:75(score)
        1    0.000    0.000    0.400    0.400 simple.py:29(hop)
        1    0.000    0.000    0.400    0.400 kb.py:156(forward)
        3    0.130    0.043    0.131    0.044 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 13/16	Loss 2.454195

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.175 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.175    1.175 simple.py:52(score)
        3    0.000    0.000    1.172    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.172    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.161    0.387 kb.py:122(neighbors)
        9    0.978    0.109    0.979    0.109 nms.py:31(build)
        2    0.001    0.000    0.795    0.398 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.170    0.057    0.177    0.059 nms.py:51(query)
        3    0.006    0.002    0.006    0.002 {built-in method numpy.array}
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 14/16	Loss 2.574587

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.157 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.157    1.157 simple.py:52(score)
        3    0.000    0.000    1.155    0.385 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.155    0.385 profilehooks.py:348(__call__)
        3    0.001    0.000    1.136    0.379 kb.py:122(neighbors)
        9    0.994    0.110    0.994    0.110 nms.py:31(build)
        2    0.000    0.000    0.792    0.396 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.136    0.045    0.137    0.046 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 15/16	Loss 2.658057

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.176 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.176    1.176 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.155    0.385 kb.py:122(neighbors)
        9    0.992    0.110    0.993    0.110 nms.py:31(build)
        2    0.000    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.359    0.359 simple.py:29(hop)
        1    0.000    0.000    0.359    0.359 kb.py:156(forward)
        3    0.157    0.052    0.158    0.053 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 15/20	Batch 16/16	Loss 2.263563

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.189 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.189    1.189 simple.py:52(score)
        3    0.000    0.000    1.186    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.186    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.167    0.389 kb.py:122(neighbors)
        9    1.005    0.112    1.006    0.112 nms.py:31(build)
        2    0.000    0.000    0.821    0.411 kb.py:75(score)
        1    0.000    0.000    0.365    0.365 simple.py:29(hop)
        1    0.000    0.000    0.365    0.365 kb.py:156(forward)
        3    0.155    0.052    0.156    0.052 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 1/16	Loss 2.502922

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.223 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.223    1.223 simple.py:52(score)
        3    0.000    0.000    1.220    0.407 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.220    0.407 profilehooks.py:348(__call__)
        3    0.001    0.000    1.208    0.403 kb.py:122(neighbors)
        9    1.006    0.112    1.007    0.112 nms.py:31(build)
        2    0.001    0.000    0.815    0.408 kb.py:75(score)
        1    0.000    0.000    0.405    0.405 simple.py:29(hop)
        1    0.000    0.000    0.405    0.405 kb.py:156(forward)
        3    0.195    0.065    0.196    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 2/16	Loss 2.660165

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.216 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.216    1.216 simple.py:52(score)
        3    0.000    0.000    1.214    0.405 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.214    0.405 profilehooks.py:348(__call__)
        3    0.001    0.000    1.195    0.398 kb.py:122(neighbors)
        9    1.031    0.115    1.032    0.115 nms.py:31(build)
        2    0.000    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.371    0.371 simple.py:29(hop)
        1    0.000    0.000    0.371    0.371 kb.py:156(forward)
        3    0.157    0.052    0.158    0.053 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 3/16	Loss 2.531567

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.174 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.174    1.174 simple.py:52(score)
        3    0.000    0.000    1.171    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.171    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.159    0.386 kb.py:122(neighbors)
        9    0.925    0.103    0.925    0.103 nms.py:31(build)
        2    0.000    0.000    0.809    0.404 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.228    0.076    0.229    0.076 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 4/16	Loss 2.131246

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.210 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.210    1.210 simple.py:52(score)
        3    0.000    0.000    1.208    0.403 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.208    0.403 profilehooks.py:348(__call__)
        3    0.001    0.000    1.196    0.399 kb.py:122(neighbors)
        9    1.015    0.113    1.016    0.113 nms.py:31(build)
        2    0.000    0.000    0.789    0.395 kb.py:75(score)
        1    0.000    0.000    0.419    0.419 simple.py:29(hop)
        1    0.000    0.000    0.419    0.419 kb.py:156(forward)
        3    0.174    0.058    0.175    0.058 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 5/16	Loss 2.533364

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.161 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.161    1.161 simple.py:52(score)
        3    0.000    0.000    1.159    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.159    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.146    0.382 kb.py:122(neighbors)
        9    0.981    0.109    0.981    0.109 nms.py:31(build)
        2    0.000    0.000    0.729    0.365 kb.py:75(score)
        1    0.000    0.000    0.429    0.429 simple.py:29(hop)
        1    0.000    0.000    0.429    0.429 kb.py:156(forward)
        3    0.159    0.053    0.160    0.053 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 6/16	Loss 2.043437

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.323 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.323    1.323 simple.py:52(score)
        3    0.000    0.000    1.321    0.440 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.321    0.440 profilehooks.py:348(__call__)
        3    0.001    0.000    1.300    0.433 kb.py:122(neighbors)
        9    1.058    0.118    1.059    0.118 nms.py:31(build)
        2    0.001    0.000    0.905    0.453 kb.py:75(score)
        1    0.000    0.000    0.416    0.416 simple.py:29(hop)
        1    0.000    0.000    0.415    0.415 kb.py:156(forward)
        3    0.235    0.078    0.236    0.079 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 7/16	Loss 3.109410

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.286 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.286    1.286 simple.py:52(score)
        3    0.000    0.000    1.284    0.428 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.283    0.428 profilehooks.py:348(__call__)
        3    0.001    0.000    1.272    0.424 kb.py:122(neighbors)
        9    1.051    0.117    1.052    0.117 nms.py:31(build)
        2    0.000    0.000    0.943    0.471 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.214    0.071    0.215    0.072 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 8/16	Loss 2.434685

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.148 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.148    1.148 simple.py:52(score)
        3    0.000    0.000    1.145    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.145    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.133    0.378 kb.py:122(neighbors)
        9    0.946    0.105    0.947    0.105 nms.py:31(build)
        2    0.000    0.000    0.783    0.392 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.181    0.060    0.182    0.061 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 9/16	Loss 2.910258

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.169 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.169    1.169 simple.py:52(score)
        3    0.000    0.000    1.167    0.389 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.167    0.389 profilehooks.py:348(__call__)
        3    0.001    0.000    1.141    0.380 kb.py:122(neighbors)
        9    0.992    0.110    0.992    0.110 nms.py:31(build)
        2    0.000    0.000    0.832    0.416 kb.py:75(score)
        1    0.000    0.000    0.335    0.335 simple.py:29(hop)
        1    0.000    0.000    0.335    0.335 kb.py:156(forward)
        3    0.143    0.048    0.144    0.048 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 10/16	Loss 2.471484

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.256 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.256    1.256 simple.py:52(score)
        3    0.000    0.000    1.254    0.418 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.254    0.418 profilehooks.py:348(__call__)
        3    0.001    0.000    1.228    0.409 kb.py:122(neighbors)
        9    1.051    0.117    1.051    0.117 nms.py:31(build)
        2    0.000    0.000    0.912    0.456 kb.py:75(score)
        1    0.000    0.000    0.342    0.342 simple.py:29(hop)
        1    0.000    0.000    0.342    0.342 kb.py:156(forward)
        3    0.170    0.057    0.171    0.057 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 11/16	Loss 2.493512

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.176 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.176    1.176 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.148    0.383 kb.py:122(neighbors)
        9    1.011    0.112    1.012    0.112 nms.py:31(build)
        2    0.000    0.000    0.798    0.399 kb.py:75(score)
        1    0.000    0.000    0.375    0.375 simple.py:29(hop)
        1    0.000    0.000    0.375    0.375 kb.py:156(forward)
        3    0.130    0.043    0.131    0.044 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 12/16	Loss 2.365748

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.119 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.119    1.119 simple.py:52(score)
        3    0.000    0.000    1.117    0.372 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.117    0.372 profilehooks.py:348(__call__)
        3    0.001    0.000    1.104    0.368 kb.py:122(neighbors)
        9    0.973    0.108    0.974    0.108 nms.py:31(build)
        2    0.000    0.000    0.776    0.388 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.341    0.341 kb.py:156(forward)
        3    0.125    0.042    0.126    0.042 nms.py:51(query)
       18    0.004    0.000    0.004    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 13/16	Loss 2.523257

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.229 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.229    1.229 simple.py:52(score)
        3    0.000    0.000    1.226    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.226    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.215    0.405 kb.py:122(neighbors)
        9    0.977    0.109    0.977    0.109 nms.py:31(build)
        2    0.001    0.000    0.840    0.420 kb.py:75(score)
        1    0.000    0.000    0.386    0.386 simple.py:29(hop)
        1    0.000    0.000    0.386    0.386 kb.py:156(forward)
        3    0.232    0.077    0.233    0.078 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.003    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 14/16	Loss 2.353627

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.173 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.173    1.173 simple.py:52(score)
        3    0.000    0.000    1.170    0.390 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.170    0.390 profilehooks.py:348(__call__)
        3    0.001    0.000    1.151    0.384 kb.py:122(neighbors)
        9    0.992    0.110    0.993    0.110 nms.py:31(build)
        2    0.000    0.000    0.793    0.397 kb.py:75(score)
        1    0.000    0.000    0.377    0.377 simple.py:29(hop)
        1    0.000    0.000    0.377    0.377 kb.py:156(forward)
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 15/16	Loss 2.457774

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.245 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.245    1.245 simple.py:52(score)
        3    0.000    0.000    1.243    0.414 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.243    0.414 profilehooks.py:348(__call__)
        3    0.001    0.000    1.230    0.410 kb.py:122(neighbors)
        9    1.051    0.117    1.051    0.117 nms.py:31(build)
        2    0.000    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.401    0.401 simple.py:29(hop)
        1    0.000    0.000    0.400    0.400 kb.py:156(forward)
        3    0.173    0.058    0.174    0.058 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 16/20	Batch 16/16	Loss 2.403157

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.229 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.229    1.229 simple.py:52(score)
        3    0.000    0.000    1.227    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.227    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.203    0.401 kb.py:122(neighbors)
        9    1.035    0.115    1.036    0.115 nms.py:31(build)
        2    0.000    0.000    0.810    0.405 kb.py:75(score)
        1    0.000    0.000    0.417    0.417 simple.py:29(hop)
        1    0.000    0.000    0.417    0.417 kb.py:156(forward)
        3    0.160    0.053    0.162    0.054 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 1/16	Loss 2.304378

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.180 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.180    1.180 simple.py:52(score)
        3    0.000    0.000    1.178    0.393 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.178    0.393 profilehooks.py:348(__call__)
        3    0.002    0.001    1.165    0.388 kb.py:122(neighbors)
        9    1.004    0.112    1.005    0.112 nms.py:31(build)
        2    0.001    0.000    0.828    0.414 kb.py:75(score)
        1    0.000    0.000    0.350    0.350 simple.py:29(hop)
        1    0.000    0.000    0.350    0.350 kb.py:156(forward)
        3    0.153    0.051    0.154    0.051 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 2/16	Loss 2.454730

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.074 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.074    1.074 simple.py:52(score)
        3    0.000    0.000    1.071    0.357 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.071    0.357 profilehooks.py:348(__call__)
        3    0.001    0.000    1.057    0.352 kb.py:122(neighbors)
        9    0.893    0.099    0.894    0.099 nms.py:31(build)
        2    0.000    0.000    0.733    0.366 kb.py:75(score)
        1    0.000    0.000    0.338    0.338 simple.py:29(hop)
        1    0.000    0.000    0.338    0.338 kb.py:156(forward)
        3    0.157    0.052    0.158    0.053 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 3/16	Loss 2.743967

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.320 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.320    1.320 simple.py:52(score)
        3    0.000    0.000    1.317    0.439 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.317    0.439 profilehooks.py:348(__call__)
        3    0.001    0.000    1.297    0.432 kb.py:122(neighbors)
        9    1.046    0.116    1.046    0.116 nms.py:31(build)
        2    0.000    0.000    0.955    0.477 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.244    0.081    0.245    0.082 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 4/16	Loss 2.004080

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.160 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.160    1.160 simple.py:52(score)
        3    0.000    0.000    1.157    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.157    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.119    0.373 kb.py:122(neighbors)
        9    0.983    0.109    0.984    0.109 nms.py:31(build)
        2    0.000    0.000    0.821    0.410 kb.py:75(score)
        1    0.000    0.000    0.336    0.336 simple.py:29(hop)
        1    0.000    0.000    0.336    0.336 kb.py:156(forward)
        3    0.129    0.043    0.130    0.043 nms.py:51(query)
       18    0.028    0.002    0.028    0.002 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 5/16	Loss 2.332240

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.190 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.190    1.190 simple.py:52(score)
        3    0.000    0.000    1.187    0.396 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.187    0.396 profilehooks.py:348(__call__)
        3    0.001    0.000    1.162    0.387 kb.py:122(neighbors)
        9    1.017    0.113    1.018    0.113 nms.py:31(build)
        2    0.000    0.000    0.834    0.417 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.138    0.046    0.139    0.046 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 6/16	Loss 2.355587

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.261 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.261    1.261 simple.py:52(score)
        3    0.000    0.000    1.259    0.420 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.259    0.420 profilehooks.py:348(__call__)
        3    0.001    0.000    1.238    0.413 kb.py:122(neighbors)
        9    1.023    0.114    1.024    0.114 nms.py:31(build)
        2    0.000    0.000    0.916    0.458 kb.py:75(score)
        1    0.000    0.000    0.342    0.342 simple.py:29(hop)
        1    0.000    0.000    0.342    0.342 kb.py:156(forward)
        3    0.207    0.069    0.208    0.069 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 7/16	Loss 2.404180

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.147    0.382 kb.py:122(neighbors)
        9    1.025    0.114    1.026    0.114 nms.py:31(build)
        2    0.001    0.000    0.815    0.408 kb.py:75(score)
        1    0.000    0.000    0.346    0.346 simple.py:29(hop)
        1    0.000    0.000    0.346    0.346 kb.py:156(forward)
        3    0.109    0.036    0.110    0.037 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 8/16	Loss 2.449792

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.141 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.141    1.141 simple.py:52(score)
        3    0.000    0.000    1.138    0.379 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.138    0.379 profilehooks.py:348(__call__)
        3    0.001    0.000    1.110    0.370 kb.py:122(neighbors)
        9    0.991    0.110    0.991    0.110 nms.py:31(build)
        2    0.000    0.000    0.724    0.362 kb.py:75(score)
        1    0.000    0.000    0.414    0.414 simple.py:29(hop)
        1    0.000    0.000    0.414    0.414 kb.py:156(forward)
        3    0.109    0.036    0.110    0.037 nms.py:51(query)
       18    0.021    0.001    0.021    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 9/16	Loss 2.402764

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.258 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.258    1.258 simple.py:52(score)
        3    0.000    0.000    1.256    0.419 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.256    0.419 profilehooks.py:348(__call__)
        3    0.001    0.000    1.243    0.414 kb.py:122(neighbors)
        9    1.032    0.115    1.033    0.115 nms.py:31(build)
        2    0.000    0.000    0.853    0.427 kb.py:75(score)
        1    0.000    0.000    0.403    0.403 simple.py:29(hop)
        1    0.000    0.000    0.403    0.403 kb.py:156(forward)
        3    0.205    0.068    0.206    0.069 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 10/16	Loss 2.282346

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.210 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.210    1.210 simple.py:52(score)
        3    0.000    0.000    1.208    0.403 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.208    0.403 profilehooks.py:348(__call__)
        3    0.001    0.000    1.196    0.399 kb.py:122(neighbors)
        9    0.987    0.110    0.988    0.110 nms.py:31(build)
        2    0.000    0.000    0.850    0.425 kb.py:75(score)
        1    0.000    0.000    0.357    0.357 simple.py:29(hop)
        1    0.000    0.000    0.357    0.357 kb.py:156(forward)
        3    0.202    0.067    0.203    0.068 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 11/16	Loss 1.961136

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.252 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.252    1.252 simple.py:52(score)
        3    0.000    0.000    1.250    0.417 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.250    0.417 profilehooks.py:348(__call__)
        3    0.001    0.000    1.238    0.413 kb.py:122(neighbors)
        9    1.050    0.117    1.051    0.117 nms.py:31(build)
        2    0.001    0.000    0.874    0.437 kb.py:75(score)
        1    0.000    0.000    0.376    0.376 simple.py:29(hop)
        1    0.000    0.000    0.376    0.376 kb.py:156(forward)
        3    0.181    0.060    0.182    0.061 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 12/16	Loss 2.579484

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.248 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.248    1.248 simple.py:52(score)
        3    0.000    0.000    1.246    0.415 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.246    0.415 profilehooks.py:348(__call__)
        3    0.001    0.000    1.234    0.411 kb.py:122(neighbors)
        9    1.024    0.114    1.025    0.114 nms.py:31(build)
        2    0.000    0.000    0.835    0.417 kb.py:75(score)
        1    0.000    0.000    0.411    0.411 simple.py:29(hop)
        1    0.000    0.000    0.411    0.411 kb.py:156(forward)
        3    0.204    0.068    0.205    0.068 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 13/16	Loss 2.129336

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.163 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.163    1.163 simple.py:52(score)
        3    0.000    0.000    1.160    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.160    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.135    0.378 kb.py:122(neighbors)
        9    0.980    0.109    0.981    0.109 nms.py:31(build)
        2    0.000    0.000    0.780    0.390 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.148    0.049    0.149    0.050 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 14/16	Loss 2.224550

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.226 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.226    1.226 simple.py:52(score)
        3    0.000    0.000    1.224    0.408 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.224    0.408 profilehooks.py:348(__call__)
        3    0.001    0.000    1.204    0.401 kb.py:122(neighbors)
        9    0.961    0.107    0.961    0.107 nms.py:31(build)
        2    0.001    0.000    0.884    0.442 kb.py:75(score)
        1    0.000    0.000    0.340    0.340 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.231    0.077    0.232    0.077 nms.py:51(query)
       18    0.018    0.001    0.018    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 15/16	Loss 2.526130

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.222 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.222    1.222 simple.py:52(score)
        3    0.000    0.000    1.219    0.406 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.219    0.406 profilehooks.py:348(__call__)
        3    0.001    0.000    1.201    0.400 kb.py:122(neighbors)
        9    1.029    0.114    1.030    0.114 nms.py:31(build)
        2    0.000    0.000    0.839    0.419 kb.py:75(score)
        1    0.000    0.000    0.380    0.380 simple.py:29(hop)
        1    0.000    0.000    0.380    0.380 kb.py:156(forward)
        3    0.165    0.055    0.166    0.055 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 17/20	Batch 16/16	Loss 2.084833

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.154 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.154    1.154 simple.py:52(score)
        3    0.000    0.000    1.151    0.384 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.151    0.384 profilehooks.py:348(__call__)
        3    0.001    0.000    1.133    0.378 kb.py:122(neighbors)
        9    0.977    0.109    0.978    0.109 nms.py:31(build)
        2    0.000    0.000    0.772    0.386 kb.py:75(score)
        1    0.000    0.000    0.379    0.379 simple.py:29(hop)
        1    0.000    0.000    0.379    0.379 kb.py:156(forward)
        3    0.145    0.048    0.147    0.049 nms.py:51(query)
       18    0.013    0.001    0.013    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        5    0.000    0.000    0.000    0.000 {built-in method max}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 1/16	Loss 2.400205

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.121 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.121    1.121 simple.py:52(score)
        3    0.000    0.000    1.119    0.373 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.119    0.373 profilehooks.py:348(__call__)
        3    0.001    0.000    1.090    0.363 kb.py:122(neighbors)
        9    0.956    0.106    0.957    0.106 nms.py:31(build)
        2    0.000    0.000    0.756    0.378 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.126    0.042    0.127    0.042 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
        3    0.005    0.002    0.006    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.003    0.000    0.003    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 2/16	Loss 2.200517

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.217 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.217    1.217 simple.py:52(score)
        3    0.000    0.000    1.215    0.405 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.215    0.405 profilehooks.py:348(__call__)
        3    0.001    0.000    1.189    0.396 kb.py:122(neighbors)
        9    1.039    0.115    1.040    0.116 nms.py:31(build)
        2    0.000    0.000    0.842    0.421 kb.py:75(score)
        1    0.000    0.000    0.373    0.373 simple.py:29(hop)
        1    0.000    0.000    0.373    0.373 kb.py:156(forward)
        3    0.144    0.048    0.145    0.048 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 3/16	Loss 2.472491

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.098 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.098    1.098 simple.py:52(score)
        3    0.000    0.000    1.096    0.365 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.096    0.365 profilehooks.py:348(__call__)
        3    0.001    0.000    1.084    0.361 kb.py:122(neighbors)
        9    0.934    0.104    0.935    0.104 nms.py:31(build)
        2    0.000    0.000    0.775    0.388 kb.py:75(score)
        1    0.000    0.000    0.320    0.320 simple.py:29(hop)
        1    0.000    0.000    0.320    0.320 kb.py:156(forward)
        3    0.144    0.048    0.145    0.048 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 4/16	Loss 2.216525

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.148 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.148    1.148 simple.py:52(score)
        3    0.000    0.000    1.145    0.382 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.145    0.382 profilehooks.py:348(__call__)
        3    0.001    0.000    1.127    0.376 kb.py:122(neighbors)
        9    0.970    0.108    0.971    0.108 nms.py:31(build)
        2    0.001    0.000    0.793    0.396 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.150    0.050    0.151    0.050 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.001    0.000 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 5/16	Loss 2.191132

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.276 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.276    1.276 simple.py:52(score)
        3    0.000    0.000    1.274    0.425 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.274    0.425 profilehooks.py:348(__call__)
        3    0.001    0.000    1.262    0.421 kb.py:122(neighbors)
        9    1.053    0.117    1.054    0.117 nms.py:31(build)
        2    0.000    0.000    0.871    0.436 kb.py:75(score)
        1    0.000    0.000    0.402    0.402 simple.py:29(hop)
        1    0.000    0.000    0.402    0.402 kb.py:156(forward)
        3    0.202    0.067    0.203    0.068 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 6/16	Loss 2.747255

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.170 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.170    1.170 simple.py:52(score)
        3    0.000    0.000    1.167    0.389 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.167    0.389 profilehooks.py:348(__call__)
        3    0.001    0.000    1.143    0.381 kb.py:122(neighbors)
        9    0.984    0.109    0.985    0.109 nms.py:31(build)
        2    0.000    0.000    0.782    0.391 kb.py:75(score)
        1    0.000    0.000    0.385    0.385 simple.py:29(hop)
        1    0.000    0.000    0.385    0.385 kb.py:156(forward)
        3    0.150    0.050    0.151    0.050 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 7/16	Loss 2.068906

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.127 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.127    1.127 simple.py:52(score)
        3    0.000    0.000    1.125    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.125    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.111    0.370 kb.py:122(neighbors)
        9    0.958    0.106    0.959    0.107 nms.py:31(build)
        2    0.001    0.000    0.782    0.391 kb.py:75(score)
        1    0.000    0.000    0.343    0.343 simple.py:29(hop)
        1    0.000    0.000    0.343    0.343 kb.py:156(forward)
        3    0.145    0.048    0.146    0.049 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 8/16	Loss 2.011029

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.324 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.324    1.324 simple.py:52(score)
        3    0.000    0.000    1.321    0.440 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.321    0.440 profilehooks.py:348(__call__)
        3    0.001    0.000    1.296    0.432 kb.py:122(neighbors)
        9    1.054    0.117    1.054    0.117 nms.py:31(build)
        2    0.000    0.000    0.904    0.452 kb.py:75(score)
        1    0.000    0.000    0.417    0.417 simple.py:29(hop)
        1    0.000    0.000    0.417    0.417 kb.py:156(forward)
        3    0.235    0.078    0.236    0.079 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 9/16	Loss 2.075537

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.133 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.133    1.133 simple.py:52(score)
        3    0.000    0.000    1.130    0.377 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.130    0.377 profilehooks.py:348(__call__)
        3    0.001    0.000    1.118    0.373 kb.py:122(neighbors)
        9    0.970    0.108    0.970    0.108 nms.py:31(build)
        2    0.000    0.000    0.770    0.385 kb.py:75(score)
        1    0.000    0.000    0.360    0.360 simple.py:29(hop)
        1    0.000    0.000    0.360    0.360 kb.py:156(forward)
        3    0.142    0.047    0.143    0.048 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 10/16	Loss 2.025604

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.194 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.194    1.194 simple.py:52(score)
        3    0.000    0.000    1.191    0.397 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.191    0.397 profilehooks.py:348(__call__)
        3    0.001    0.000    1.177    0.392 kb.py:122(neighbors)
        9    0.967    0.107    0.968    0.108 nms.py:31(build)
        2    0.001    0.000    0.849    0.425 kb.py:75(score)
        1    0.000    0.000    0.342    0.342 simple.py:29(hop)
        1    0.000    0.000    0.342    0.342 kb.py:156(forward)
        3    0.204    0.068    0.205    0.068 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 11/16	Loss 2.106178

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.262 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.262    1.262 simple.py:52(score)
        3    0.000    0.000    1.259    0.420 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.259    0.420 profilehooks.py:348(__call__)
        3    0.001    0.000    1.247    0.416 kb.py:122(neighbors)
        9    1.098    0.122    1.099    0.122 nms.py:31(build)
        2    0.000    0.000    0.824    0.412 kb.py:75(score)
        1    0.000    0.000    0.435    0.435 simple.py:29(hop)
        1    0.000    0.000    0.435    0.435 kb.py:156(forward)
        3    0.142    0.047    0.143    0.048 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 12/16	Loss 2.197014

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.129 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.129    1.129 simple.py:52(score)
        3    0.000    0.000    1.126    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.126    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.113    0.371 kb.py:122(neighbors)
        9    0.949    0.105    0.949    0.105 nms.py:31(build)
        2    0.001    0.000    0.785    0.392 kb.py:75(score)
        1    0.000    0.000    0.341    0.341 simple.py:29(hop)
        1    0.000    0.000    0.341    0.341 kb.py:156(forward)
        3    0.158    0.053    0.159    0.053 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 13/16	Loss 1.836040

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.199 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.199    1.199 simple.py:52(score)
        3    0.000    0.000    1.196    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.196    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.172    0.391 kb.py:122(neighbors)
        9    0.997    0.111    0.998    0.111 nms.py:31(build)
        2    0.001    0.000    0.811    0.405 kb.py:75(score)
        1    0.000    0.000    0.385    0.385 simple.py:29(hop)
        1    0.000    0.000    0.385    0.385 kb.py:156(forward)
        3    0.164    0.055    0.166    0.055 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
      198    0.000    0.000    0.000    0.000 __init__.py:1530(getEffectiveLevel)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 14/16	Loss 2.123818

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.164    1.164 simple.py:52(score)
        3    0.000    0.000    1.162    0.387 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.162    0.387 profilehooks.py:348(__call__)
        3    0.001    0.000    1.136    0.379 kb.py:122(neighbors)
        9    0.977    0.109    0.978    0.109 nms.py:31(build)
        2    0.000    0.000    0.802    0.401 kb.py:75(score)
        1    0.000    0.000    0.360    0.360 simple.py:29(hop)
        1    0.000    0.000    0.360    0.360 kb.py:156(forward)
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 15/16	Loss 1.935298

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.063 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.063    1.063 simple.py:52(score)
        3    0.000    0.000    1.061    0.354 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.061    0.354 profilehooks.py:348(__call__)
        3    0.001    0.000    1.042    0.347 kb.py:122(neighbors)
        9    0.907    0.101    0.907    0.101 nms.py:31(build)
        2    0.000    0.000    0.730    0.365 kb.py:75(score)
        1    0.000    0.000    0.331    0.331 simple.py:29(hop)
        1    0.000    0.000    0.331    0.331 kb.py:156(forward)
        3    0.129    0.043    0.130    0.043 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 18/20	Batch 16/16	Loss 2.375849

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.133 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.133    1.133 simple.py:52(score)
        3    0.000    0.000    1.130    0.377 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.130    0.377 profilehooks.py:348(__call__)
        3    0.001    0.000    1.113    0.371 kb.py:122(neighbors)
        9    0.970    0.108    0.971    0.108 nms.py:31(build)
        2    0.000    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.316    0.316 simple.py:29(hop)
        1    0.000    0.000    0.316    0.316 kb.py:156(forward)
        3    0.136    0.045    0.137    0.046 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 1/16	Loss 2.245812

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.135 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.135    1.135 simple.py:52(score)
        3    0.000    0.000    1.133    0.378 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.133    0.378 profilehooks.py:348(__call__)
        3    0.001    0.000    1.120    0.373 kb.py:122(neighbors)
        9    0.978    0.109    0.979    0.109 nms.py:31(build)
        2    0.000    0.000    0.752    0.376 kb.py:75(score)
        1    0.000    0.000    0.381    0.381 simple.py:29(hop)
        1    0.000    0.000    0.381    0.381 kb.py:156(forward)
        3    0.134    0.045    0.135    0.045 nms.py:51(query)
       18    0.007    0.000    0.007    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 2/16	Loss 2.078726

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.062 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.062    1.062 simple.py:52(score)
        3    0.000    0.000    1.059    0.353 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.059    0.353 profilehooks.py:348(__call__)
        3    0.001    0.000    1.041    0.347 kb.py:122(neighbors)
        9    0.904    0.100    0.905    0.101 nms.py:31(build)
        2    0.000    0.000    0.710    0.355 kb.py:75(score)
        1    0.000    0.000    0.350    0.350 simple.py:29(hop)
        1    0.000    0.000    0.350    0.350 kb.py:156(forward)
        3    0.130    0.043    0.131    0.044 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 3/16	Loss 2.179169

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.218 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.218    1.218 simple.py:52(score)
        3    0.000    0.000    1.216    0.405 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.216    0.405 profilehooks.py:348(__call__)
        3    0.001    0.000    1.204    0.401 kb.py:122(neighbors)
        9    1.005    0.112    1.005    0.112 nms.py:31(build)
        2    0.001    0.000    0.844    0.422 kb.py:75(score)
        1    0.000    0.000    0.372    0.372 simple.py:29(hop)
        1    0.000    0.000    0.372    0.372 kb.py:156(forward)
        3    0.193    0.064    0.194    0.065 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 4/16	Loss 2.217118

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.127 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.127    1.127 simple.py:52(score)
        3    0.000    0.000    1.125    0.375 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.125    0.375 profilehooks.py:348(__call__)
        3    0.001    0.000    1.105    0.368 kb.py:122(neighbors)
        9    0.942    0.105    0.943    0.105 nms.py:31(build)
        2    0.000    0.000    0.727    0.363 kb.py:75(score)
        1    0.000    0.000    0.398    0.398 simple.py:29(hop)
        1    0.000    0.000    0.398    0.398 kb.py:156(forward)
        3    0.156    0.052    0.157    0.052 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 5/16	Loss 2.325516

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.187    1.187 simple.py:52(score)
        3    0.000    0.000    1.185    0.395 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.185    0.395 profilehooks.py:348(__call__)
        3    0.001    0.000    1.170    0.390 kb.py:122(neighbors)
        9    1.001    0.111    1.002    0.111 nms.py:31(build)
        2    0.000    0.000    0.791    0.395 kb.py:75(score)
        1    0.000    0.000    0.394    0.394 simple.py:29(hop)
        1    0.000    0.000    0.393    0.393 kb.py:156(forward)
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
       18    0.008    0.000    0.008    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 6/16	Loss 2.162639

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.141 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.141    1.141 simple.py:52(score)
        3    0.000    0.000    1.139    0.380 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.139    0.380 profilehooks.py:348(__call__)
        3    0.001    0.000    1.127    0.376 kb.py:122(neighbors)
        9    0.937    0.104    0.938    0.104 nms.py:31(build)
        2    0.000    0.000    0.785    0.393 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.183    0.061    0.184    0.061 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 7/16	Loss 1.926410

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.152 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.152    1.152 simple.py:52(score)
        3    0.000    0.000    1.149    0.383 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.149    0.383 profilehooks.py:348(__call__)
        3    0.001    0.000    1.129    0.376 kb.py:122(neighbors)
        9    0.981    0.109    0.981    0.109 nms.py:31(build)
        2    0.000    0.000    0.787    0.394 kb.py:75(score)
        1    0.000    0.000    0.362    0.362 simple.py:29(hop)
        1    0.000    0.000    0.362    0.362 kb.py:156(forward)
        3    0.142    0.047    0.143    0.048 nms.py:51(query)
       18    0.011    0.001    0.011    0.001 {built-in method cat}
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 8/16	Loss 2.136165

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.130 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.130    1.130 simple.py:52(score)
        3    0.000    0.000    1.128    0.376 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.128    0.376 profilehooks.py:348(__call__)
        3    0.001    0.000    1.108    0.369 kb.py:122(neighbors)
        9    0.986    0.110    0.987    0.110 nms.py:31(build)
        2    0.000    0.000    0.741    0.371 kb.py:75(score)
        1    0.000    0.000    0.386    0.386 simple.py:29(hop)
        1    0.000    0.000    0.386    0.386 kb.py:156(forward)
        3    0.112    0.037    0.113    0.038 nms.py:51(query)
       18    0.015    0.001    0.015    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 9/16	Loss 2.351904

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.126 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.126    1.126 simple.py:52(score)
        3    0.000    0.000    1.123    0.374 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.123    0.374 profilehooks.py:348(__call__)
        3    0.001    0.000    1.105    0.368 kb.py:122(neighbors)
        9    0.947    0.105    0.948    0.105 nms.py:31(build)
        2    0.001    0.000    0.784    0.392 kb.py:75(score)
        1    0.000    0.000    0.339    0.339 simple.py:29(hop)
        1    0.000    0.000    0.339    0.339 kb.py:156(forward)
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 10/16	Loss 2.063524

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.129 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.129    1.129 simple.py:52(score)
        3    0.000    0.000    1.127    0.376 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.127    0.376 profilehooks.py:348(__call__)
        3    0.001    0.000    1.115    0.372 kb.py:122(neighbors)
        9    0.955    0.106    0.955    0.106 nms.py:31(build)
        2    0.001    0.000    0.740    0.370 kb.py:75(score)
        1    0.000    0.000    0.388    0.388 simple.py:29(hop)
        1    0.000    0.000    0.387    0.387 kb.py:156(forward)
        3    0.154    0.051    0.155    0.052 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 11/16	Loss 1.574662

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.318 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.318    1.318 simple.py:52(score)
        3    0.000    0.000    1.315    0.438 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.315    0.438 profilehooks.py:348(__call__)
        3    0.001    0.000    1.301    0.434 kb.py:122(neighbors)
        9    1.035    0.115    1.036    0.115 nms.py:31(build)
        2    0.001    0.000    0.914    0.457 kb.py:75(score)
        1    0.000    0.000    0.401    0.401 simple.py:29(hop)
        1    0.000    0.000    0.401    0.401 kb.py:156(forward)
        3    0.259    0.086    0.260    0.087 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 12/16	Loss 1.890965

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.247 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.247    1.247 simple.py:52(score)
        3    0.000    0.000    1.244    0.415 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.244    0.415 profilehooks.py:348(__call__)
        3    0.001    0.000    1.232    0.411 kb.py:122(neighbors)
        9    1.034    0.115    1.035    0.115 nms.py:31(build)
        2    0.001    0.000    0.853    0.426 kb.py:75(score)
        1    0.000    0.000    0.391    0.391 simple.py:29(hop)
        1    0.000    0.000    0.391    0.391 kb.py:156(forward)
        3    0.186    0.062    0.188    0.063 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 13/16	Loss 2.274812

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.160 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.160    1.160 simple.py:52(score)
        3    0.000    0.000    1.157    0.386 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.157    0.386 profilehooks.py:348(__call__)
        3    0.001    0.000    1.131    0.377 kb.py:122(neighbors)
        9    1.002    0.111    1.003    0.111 nms.py:31(build)
        2    0.000    0.000    0.809    0.404 kb.py:75(score)
        1    0.000    0.000    0.349    0.349 simple.py:29(hop)
        1    0.000    0.000    0.349    0.349 kb.py:156(forward)
        3    0.121    0.040    0.123    0.041 nms.py:51(query)
       18    0.017    0.001    0.017    0.001 {built-in method cat}
        3    0.004    0.001    0.006    0.002 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 14/16	Loss 1.574238

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.201 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.201    1.201 simple.py:52(score)
        3    0.000    0.000    1.198    0.399 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.198    0.399 profilehooks.py:348(__call__)
        3    0.001    0.000    1.179    0.393 kb.py:122(neighbors)
        9    1.020    0.113    1.021    0.113 nms.py:31(build)
        2    0.000    0.000    0.823    0.412 kb.py:75(score)
        1    0.000    0.000    0.375    0.375 simple.py:29(hop)
        1    0.000    0.000    0.375    0.375 kb.py:156(forward)
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 15/16	Loss 2.104506

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.108 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.108    1.108 simple.py:52(score)
        3    0.000    0.000    1.106    0.369 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.106    0.369 profilehooks.py:348(__call__)
        3    0.001    0.000    1.080    0.360 kb.py:122(neighbors)
        9    0.938    0.104    0.938    0.104 nms.py:31(build)
        2    0.001    0.000    0.770    0.385 kb.py:75(score)
        1    0.000    0.000    0.336    0.336 simple.py:29(hop)
        1    0.000    0.000    0.336    0.336 kb.py:156(forward)
        3    0.135    0.045    0.136    0.045 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 19/20	Batch 16/16	Loss 1.940796

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.246 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.246    1.246 simple.py:52(score)
        3    0.000    0.000    1.244    0.415 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.244    0.415 profilehooks.py:348(__call__)
        3    0.001    0.000    1.230    0.410 kb.py:122(neighbors)
        9    1.008    0.112    1.009    0.112 nms.py:31(build)
        2    0.000    0.000    0.835    0.417 kb.py:75(score)
        1    0.000    0.000    0.409    0.409 simple.py:29(hop)
        1    0.000    0.000    0.409    0.409 kb.py:156(forward)
        3    0.215    0.072    0.216    0.072 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 1/16	Loss 1.879370

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.175 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.175    1.175 simple.py:52(score)
        3    0.000    0.000    1.173    0.391 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.173    0.391 profilehooks.py:348(__call__)
        3    0.001    0.000    1.146    0.382 kb.py:122(neighbors)
        9    1.005    0.112    1.006    0.112 nms.py:31(build)
        2    0.000    0.000    0.764    0.382 kb.py:75(score)
        1    0.000    0.000    0.409    0.409 simple.py:29(hop)
        1    0.000    0.000    0.409    0.409 kb.py:156(forward)
        3    0.134    0.045    0.135    0.045 nms.py:51(query)
       18    0.019    0.001    0.019    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 2/16	Loss 1.952331

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.316 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.316    1.316 simple.py:52(score)
        3    0.000    0.000    1.314    0.438 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.314    0.438 profilehooks.py:348(__call__)
        3    0.001    0.000    1.301    0.434 kb.py:122(neighbors)
        9    1.055    0.117    1.056    0.117 nms.py:31(build)
        2    0.001    0.000    0.904    0.452 kb.py:75(score)
        1    0.000    0.000    0.410    0.410 simple.py:29(hop)
        1    0.000    0.000    0.410    0.410 kb.py:156(forward)
        3    0.238    0.079    0.240    0.080 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.002    0.001    0.002    0.001 {built-in method numpy.array}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 3/16	Loss 1.975674

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.186 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.186    1.186 simple.py:52(score)
        3    0.000    0.000    1.183    0.394 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.183    0.394 profilehooks.py:348(__call__)
        3    0.001    0.000    1.170    0.390 kb.py:122(neighbors)
        9    0.999    0.111    1.000    0.111 nms.py:31(build)
        2    0.000    0.000    0.802    0.401 kb.py:75(score)
        1    0.000    0.000    0.381    0.381 simple.py:29(hop)
        1    0.000    0.000    0.381    0.381 kb.py:156(forward)
        3    0.164    0.055    0.165    0.055 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 4/16	Loss 1.867783

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.307 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.307    1.307 simple.py:52(score)
        3    0.000    0.000    1.304    0.435 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.304    0.435 profilehooks.py:348(__call__)
        3    0.001    0.000    1.275    0.425 kb.py:122(neighbors)
        9    1.129    0.125    1.130    0.126 nms.py:31(build)
        2    0.000    0.000    0.891    0.445 kb.py:75(score)
        1    0.000    0.000    0.413    0.413 simple.py:29(hop)
        1    0.000    0.000    0.413    0.413 kb.py:156(forward)
        3    0.139    0.046    0.140    0.047 nms.py:51(query)
       18    0.020    0.001    0.020    0.001 {built-in method cat}
    18/15    0.000    0.000    0.005    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.003    0.000 functional.py:1774(embedding)
       13    0.003    0.000    0.003    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 5/16	Loss 1.740865

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.087 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.087    1.087 simple.py:52(score)
        3    0.000    0.000    1.085    0.362 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.085    0.362 profilehooks.py:348(__call__)
        3    0.001    0.000    1.065    0.355 kb.py:122(neighbors)
        9    0.943    0.105    0.944    0.105 nms.py:31(build)
        2    0.001    0.000    0.744    0.372 kb.py:75(score)
        1    0.000    0.000    0.340    0.340 simple.py:29(hop)
        1    0.000    0.000    0.340    0.340 kb.py:156(forward)
        3    0.114    0.038    0.116    0.039 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 6/16	Loss 2.044793

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.105 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.105    1.105 simple.py:52(score)
        3    0.000    0.000    1.102    0.367 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.102    0.367 profilehooks.py:348(__call__)
        3    0.001    0.000    1.091    0.364 kb.py:122(neighbors)
        9    0.929    0.103    0.930    0.103 nms.py:31(build)
        2    0.000    0.000    0.752    0.376 kb.py:75(score)
        1    0.000    0.000    0.350    0.350 simple.py:29(hop)
        1    0.000    0.000    0.350    0.350 kb.py:156(forward)
        3    0.155    0.052    0.156    0.052 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 7/16	Loss 2.368739

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.183 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.183    1.183 simple.py:52(score)
        3    0.000    0.000    1.181    0.394 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.181    0.394 profilehooks.py:348(__call__)
        3    0.001    0.000    1.157    0.386 kb.py:122(neighbors)
        9    0.942    0.105    0.943    0.105 nms.py:31(build)
        2    0.000    0.000    0.814    0.407 kb.py:75(score)
        1    0.000    0.000    0.366    0.366 simple.py:29(hop)
        1    0.000    0.000    0.366    0.366 kb.py:156(forward)
        3    0.207    0.069    0.209    0.070 nms.py:51(query)
       18    0.016    0.001    0.016    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 8/16	Loss 2.134673

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.241 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.241    1.241 simple.py:52(score)
        3    0.000    0.000    1.239    0.413 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.239    0.413 profilehooks.py:348(__call__)
        3    0.001    0.000    1.219    0.406 kb.py:122(neighbors)
        9    1.045    0.116    1.046    0.116 nms.py:31(build)
        2    0.000    0.000    0.836    0.418 kb.py:75(score)
        1    0.000    0.000    0.403    0.403 simple.py:29(hop)
        1    0.000    0.000    0.403    0.403 kb.py:156(forward)
        3    0.167    0.056    0.168    0.056 nms.py:51(query)
       18    0.012    0.001    0.012    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 9/16	Loss 1.605845

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.190 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.190    1.190 simple.py:52(score)
        3    0.000    0.000    1.188    0.396 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.188    0.396 profilehooks.py:348(__call__)
        3    0.001    0.000    1.172    0.391 kb.py:122(neighbors)
        9    1.004    0.112    1.005    0.112 nms.py:31(build)
        2    0.000    0.000    0.851    0.426 kb.py:75(score)
        1    0.000    0.000    0.337    0.337 simple.py:29(hop)
        1    0.000    0.000    0.336    0.336 kb.py:156(forward)
        3    0.161    0.054    0.162    0.054 nms.py:51(query)
       18    0.010    0.001    0.010    0.001 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 10/16	Loss 2.106884

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.098 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.098    1.098 simple.py:52(score)
        3    0.000    0.000    1.095    0.365 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.095    0.365 profilehooks.py:348(__call__)
        3    0.001    0.000    1.083    0.361 kb.py:122(neighbors)
        9    0.936    0.104    0.937    0.104 nms.py:31(build)
        2    0.000    0.000    0.750    0.375 kb.py:75(score)
        1    0.000    0.000    0.345    0.345 simple.py:29(hop)
        1    0.000    0.000    0.345    0.345 kb.py:156(forward)
        3    0.136    0.045    0.137    0.046 nms.py:51(query)
       18    0.009    0.000    0.009    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 11/16	Loss 1.895509

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.229 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.229    1.229 simple.py:52(score)
        3    0.000    0.000    1.226    0.409 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.226    0.409 profilehooks.py:348(__call__)
        3    0.001    0.000    1.213    0.404 kb.py:122(neighbors)
        9    1.031    0.115    1.032    0.115 nms.py:31(build)
        2    0.000    0.000    0.837    0.418 kb.py:75(score)
        1    0.000    0.000    0.389    0.389 simple.py:29(hop)
        1    0.000    0.000    0.389    0.389 kb.py:156(forward)
        3    0.175    0.058    0.176    0.059 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method rsub}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 12/16	Loss 2.223598

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.303 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.303    1.303 simple.py:52(score)
        3    0.000    0.000    1.300    0.433 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.300    0.433 profilehooks.py:348(__call__)
        3    0.001    0.000    1.288    0.429 kb.py:122(neighbors)
        9    1.052    0.117    1.053    0.117 nms.py:31(build)
        2    0.001    0.000    0.873    0.436 kb.py:75(score)
        1    0.000    0.000    0.427    0.427 simple.py:29(hop)
        1    0.000    0.000    0.427    0.427 kb.py:156(forward)
        3    0.229    0.076    0.230    0.077 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method rsub}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 13/16	Loss 1.777185

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.145 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.145    1.145 simple.py:52(score)
        3    0.000    0.000    1.143    0.381 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.143    0.381 profilehooks.py:348(__call__)
        3    0.001    0.000    1.130    0.377 kb.py:122(neighbors)
        9    0.990    0.110    0.991    0.110 nms.py:31(build)
        2    0.001    0.000    0.777    0.389 kb.py:75(score)
        1    0.000    0.000    0.365    0.365 simple.py:29(hop)
        1    0.000    0.000    0.365    0.365 kb.py:156(forward)
        3    0.133    0.044    0.134    0.045 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 14/16	Loss 1.761159

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.292 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.292    1.292 simple.py:52(score)
        3    0.000    0.000    1.289    0.430 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.289    0.430 profilehooks.py:348(__call__)
        3    0.001    0.000    1.278    0.426 kb.py:122(neighbors)
        9    1.042    0.116    1.043    0.116 nms.py:31(build)
        2    0.000    0.000    0.942    0.471 kb.py:75(score)
        1    0.000    0.000    0.347    0.347 simple.py:29(hop)
        1    0.000    0.000    0.347    0.347 kb.py:156(forward)
        3    0.228    0.076    0.230    0.077 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 15/16	Loss 2.225022

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1604 function calls (1601 primitive calls) in 1.134 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 82 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.134    1.134 simple.py:52(score)
        3    0.000    0.000    1.132    0.377 profilehooks.py:257(new_fn)
        3    0.000    0.000    1.132    0.377 profilehooks.py:348(__call__)
        3    0.001    0.000    1.120    0.373 kb.py:122(neighbors)
        9    0.967    0.107    0.967    0.107 nms.py:31(build)
        2    0.000    0.000    0.779    0.390 kb.py:75(score)
        1    0.000    0.000    0.353    0.353 simple.py:29(hop)
        1    0.000    0.000    0.353    0.353 kb.py:156(forward)
        3    0.147    0.049    0.148    0.049 nms.py:51(query)
       18    0.005    0.000    0.005    0.000 {built-in method cat}
    18/15    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
       13    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       13    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       13    0.002    0.000    0.002    0.000 {built-in method embedding}
        3    0.000    0.000    0.002    0.001 kb.py:68(generate_facts)
       15    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
       42    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        5    0.000    0.000    0.000    0.000 {built-in method max}
      198    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 tensor.py:21(wrapped)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 tensor.py:506(__rsub__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}


INFO:hoppy-sample-cli.py:Epoch 20/20	Batch 16/16	Loss 1.928923
New evaluation is on!

*** PROFILER RESULTS ***
forward_ (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:275)
function called 1 times

         17465 function calls (17462 primitive calls) in 1.887 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 76 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.887    1.887 simple.py:275(forward_)
        6    0.000    0.000    1.884    0.314 profilehooks.py:257(new_fn)
        6    0.001    0.000    1.884    0.314 profilehooks.py:348(__call__)
        4    0.069    0.017    1.231    0.308 kb.py:247(forward_)
      800    0.540    0.001    0.822    0.001 gaussian.py:55(pairwise)
        2    0.000    0.000    0.653    0.327 simple.py:29(hop)
        2    0.000    0.000    0.653    0.326 kb.py:156(forward)
        2    0.000    0.000    0.647    0.323 kb.py:122(neighbors)
        6    0.640    0.107    0.641    0.107 nms.py:31(build)
     1616    0.198    0.000    0.198    0.000 {built-in method cat}
     1602    0.101    0.000    0.101    0.000 {built-in method sum}
     1612    0.060    0.000    0.060    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      804    0.058    0.000    0.058    0.000 {built-in method max}
      802    0.048    0.000    0.048    0.000 {built-in method sqrt}
      802    0.047    0.000    0.047    0.000 {built-in method exp}
     2404    0.033    0.000    0.033    0.000 {built-in method reshape}
      802    0.030    0.000    0.030    0.000 {built-in method clamp}
     2442    0.023    0.000    0.023    0.000 {method 'view' of 'torch._C._TensorBase' objects}
     1603    0.023    0.000    0.023    0.000 {method 't' of 'torch._C._TensorBase' objects}
        2    0.004    0.002    0.004    0.002 nms.py:51(query)
    27/24    0.001    0.000    0.004    0.000 module.py:715(_call_impl)
      872    0.003    0.000    0.003    0.000 module.py:765(__getattr__)
       22    0.000    0.000    0.003    0.000 sparse.py:123(forward)
        6    0.000    0.000    0.003    0.000 kb.py:68(generate_facts)
       22    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       22    0.002    0.000    0.002    0.000 {built-in method embedding}
        2    0.001    0.000    0.001    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       74    0.000    0.000    0.000    0.000 module.py:781(__setattr__)
      132    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.000    0.000 {built-in method addmm}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      132    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        2    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}


time taken for hit update of this batch is: 0.0005381107330322266
time taken for batch 0 while evaluating: 1.8929030895233154

*** PROFILER RESULTS ***
forward_ (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:275)
function called 1 times

         17305 function calls (17302 primitive calls) in 1.882 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 76 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.882    1.882 simple.py:275(forward_)
        6    0.000    0.000    1.879    0.313 profilehooks.py:257(new_fn)
        6    0.001    0.000    1.879    0.313 profilehooks.py:348(__call__)
        4    0.068    0.017    1.191    0.298 kb.py:247(forward_)
      792    0.520    0.001    0.795    0.001 gaussian.py:55(pairwise)
        2    0.000    0.000    0.688    0.344 simple.py:29(hop)
        2    0.000    0.000    0.687    0.344 kb.py:156(forward)
        2    0.000    0.000    0.681    0.341 kb.py:122(neighbors)
        6    0.675    0.113    0.676    0.113 nms.py:31(build)
     1600    0.187    0.000    0.187    0.000 {built-in method cat}
     1586    0.099    0.000    0.099    0.000 {built-in method sum}
     1596    0.060    0.000    0.060    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      796    0.058    0.000    0.058    0.000 {built-in method max}
      794    0.049    0.000    0.049    0.000 {built-in method sqrt}
      794    0.042    0.000    0.042    0.000 {built-in method exp}
     2380    0.033    0.000    0.033    0.000 {built-in method reshape}
      794    0.030    0.000    0.030    0.000 {built-in method clamp}
     2418    0.023    0.000    0.023    0.000 {method 'view' of 'torch._C._TensorBase' objects}
     1587    0.023    0.000    0.023    0.000 {method 't' of 'torch._C._TensorBase' objects}
        2    0.004    0.002    0.004    0.002 nms.py:51(query)
    27/24    0.001    0.000    0.004    0.000 module.py:715(_call_impl)
      864    0.003    0.000    0.003    0.000 module.py:765(__getattr__)
        6    0.000    0.000    0.002    0.000 kb.py:68(generate_facts)
       22    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       22    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       22    0.002    0.000    0.002    0.000 {built-in method embedding}
        2    0.001    0.000    0.001    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       74    0.000    0.000    0.000    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method addmm}
      132    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      132    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        2    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        6    0.000    0.000    0.000    0.000 {built-in method nmslib.init}


time taken for hit update of this batch is: 0.0006318092346191406
time taken for batch 1 while evaluating: 1.8874545097351074
Time taken for evaluating all batches (count: 2): 3.780393362045288
INFO:hoppy-sample-cli.py:Final 	dev results	MRR 0.483747	H@1 0.298995	H@3 0.560302	H@5 0.743719	H@10 0.957286
New evaluation is on!

*** PROFILER RESULTS ***
forward_ (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:275)
function called 1 times

         17465 function calls (17462 primitive calls) in 1.945 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 76 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.945    1.945 simple.py:275(forward_)
        6    0.000    0.000    1.943    0.324 profilehooks.py:257(new_fn)
        6    0.001    0.000    1.942    0.324 profilehooks.py:348(__call__)
        4    0.070    0.018    1.233    0.308 kb.py:247(forward_)
      800    0.529    0.001    0.823    0.001 gaussian.py:55(pairwise)
        2    0.000    0.000    0.709    0.354 simple.py:29(hop)
        2    0.000    0.000    0.708    0.354 kb.py:156(forward)
        2    0.000    0.000    0.702    0.351 kb.py:122(neighbors)
        6    0.695    0.116    0.696    0.116 nms.py:31(build)
     1616    0.195    0.000    0.195    0.000 {built-in method cat}
     1602    0.101    0.000    0.101    0.000 {built-in method sum}
      802    0.062    0.000    0.062    0.000 {built-in method exp}
     1612    0.062    0.000    0.062    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      804    0.059    0.000    0.059    0.000 {built-in method max}
      802    0.044    0.000    0.044    0.000 {built-in method sqrt}
     2404    0.034    0.000    0.034    0.000 {built-in method reshape}
      802    0.031    0.000    0.031    0.000 {built-in method clamp}
     2442    0.024    0.000    0.024    0.000 {method 'view' of 'torch._C._TensorBase' objects}
     1603    0.024    0.000    0.024    0.000 {method 't' of 'torch._C._TensorBase' objects}
        2    0.004    0.002    0.004    0.002 nms.py:51(query)
    27/24    0.001    0.000    0.004    0.000 module.py:715(_call_impl)
      872    0.003    0.000    0.003    0.000 module.py:765(__getattr__)
        6    0.000    0.000    0.003    0.000 kb.py:68(generate_facts)
       22    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       22    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       22    0.002    0.000    0.002    0.000 {built-in method embedding}
        2    0.001    0.000    0.001    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       74    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method addmm}
      132    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
      132    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        2    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}


time taken for hit update of this batch is: 0.000675201416015625
time taken for batch 0 while evaluating: 1.951812505722046

*** PROFILER RESULTS ***
forward_ (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:275)
function called 1 times

         17465 function calls (17462 primitive calls) in 1.950 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 76 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.950    1.950 simple.py:275(forward_)
        6    0.000    0.000    1.947    0.324 profilehooks.py:257(new_fn)
        6    0.001    0.000    1.947    0.324 profilehooks.py:348(__call__)
        4    0.070    0.018    1.229    0.307 kb.py:247(forward_)
      800    0.543    0.001    0.819    0.001 gaussian.py:55(pairwise)
        2    0.000    0.000    0.718    0.359 simple.py:29(hop)
        2    0.000    0.000    0.717    0.359 kb.py:156(forward)
        2    0.000    0.000    0.711    0.356 kb.py:122(neighbors)
        6    0.704    0.117    0.705    0.117 nms.py:31(build)
     1616    0.195    0.000    0.195    0.000 {built-in method cat}
     1602    0.101    0.000    0.101    0.000 {built-in method sum}
     1612    0.062    0.000    0.062    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      804    0.059    0.000    0.059    0.000 {built-in method max}
      802    0.045    0.000    0.045    0.000 {built-in method sqrt}
      802    0.043    0.000    0.043    0.000 {built-in method exp}
     2404    0.034    0.000    0.034    0.000 {built-in method reshape}
      802    0.030    0.000    0.030    0.000 {built-in method clamp}
     2442    0.024    0.000    0.024    0.000 {method 'view' of 'torch._C._TensorBase' objects}
     1603    0.024    0.000    0.024    0.000 {method 't' of 'torch._C._TensorBase' objects}
        2    0.004    0.002    0.004    0.002 nms.py:51(query)
    27/24    0.001    0.000    0.004    0.000 module.py:715(_call_impl)
      872    0.003    0.000    0.003    0.000 module.py:765(__getattr__)
        6    0.000    0.000    0.003    0.000 kb.py:68(generate_facts)
       22    0.000    0.000    0.003    0.000 sparse.py:123(forward)
       22    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       22    0.002    0.000    0.002    0.000 {built-in method embedding}
        2    0.001    0.000    0.001    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.001    0.000 base.py:142(forward)
        2    0.000    0.000    0.001    0.000 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       74    0.000    0.000    0.000    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.000    0.000 {built-in method addmm}
      132    0.000    0.000    0.000    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        2    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
      132    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}


time taken for hit update of this batch is: 0.0005753040313720703
time taken for batch 1 while evaluating: 1.9551103115081787

*** PROFILER RESULTS ***
forward_ (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:275)
function called 1 times

         1625 function calls (1622 primitive calls) in 0.761 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 76 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.761    0.761 simple.py:275(forward_)
        6    0.000    0.000    0.758    0.126 profilehooks.py:257(new_fn)
        6    0.000    0.000    0.758    0.126 profilehooks.py:348(__call__)
        2    0.000    0.000    0.742    0.371 simple.py:29(hop)
        2    0.000    0.000    0.742    0.371 kb.py:156(forward)
        2    0.000    0.000    0.736    0.368 kb.py:122(neighbors)
        6    0.732    0.122    0.733    0.122 nms.py:31(build)
        4    0.001    0.000    0.016    0.004 kb.py:247(forward_)
        8    0.007    0.001    0.010    0.001 gaussian.py:55(pairwise)
       32    0.005    0.000    0.005    0.000 {built-in method cat}
    27/24    0.000    0.000    0.004    0.000 module.py:715(_call_impl)
        6    0.000    0.000    0.003    0.000 kb.py:68(generate_facts)
       22    0.000    0.000    0.002    0.000 sparse.py:123(forward)
       22    0.000    0.000    0.002    0.000 functional.py:1774(embedding)
       22    0.002    0.000    0.002    0.000 {built-in method embedding}
        2    0.001    0.001    0.001    0.001 nms.py:51(query)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
       18    0.001    0.000    0.001    0.000 {built-in method sum}
       28    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        2    0.001    0.000    0.001    0.000 gaussian.py:28(__call__)
       12    0.001    0.000    0.001    0.000 {built-in method max}
       66    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       74    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       10    0.001    0.000    0.001    0.000 {built-in method sqrt}
       10    0.001    0.000    0.001    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
       28    0.000    0.000    0.000    0.000 {built-in method reshape}
       10    0.000    0.000    0.000    0.000 {built-in method clamp}
      132    0.000    0.000    0.000    0.000 __init__.py:1298(info)
       19    0.000    0.000    0.000    0.000 {method 't' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 kb.py:62(to_tnsr)
       80    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
      132    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


time taken for hit update of this batch is: 2.1457672119140625e-05
time taken for batch 2 while evaluating: 0.7645366191864014
Time taken for evaluating all batches (count: 3): 4.671491384506226
INFO:hoppy-sample-cli.py:Final 	test results	MRR 0.488685	H@1 0.286070	H@3 0.589552	H@5 0.778607	H@10 0.947761
INFO:hoppy-sample-cli.py:Training finished
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 14/20\tLoss 2.8598 \xb1 0.2022'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 15/20\tLoss 2.6768 \xb1 0.1937'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 16/20\tLoss 2.4954 \xb1 0.2459'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 17/20\tLoss 2.3275 \xb1 0.2046'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 18/20\tLoss 2.1865 \xb1 0.2177'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 19/20\tLoss 2.0654 \xb1 0.2272'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/home/baadalvm/anaconda3/envs/tf/lib/python3.6/logging/__init__.py", line 996, in emit
    stream.write(msg)
UnicodeEncodeError: 'ascii' codec can't encode character '\xb1' in position 49: ordinal not in range(128)
Call stack:
  File "./bin/hoppy-sample-cli.py", line 422, in <module>
    main(sys.argv[1:])
  File "./bin/hoppy-sample-cli.py", line 381, in main
    logger.info(f'Epoch {epoch_no}/{nb_epochs}\tLoss {loss_mean:.4f} \xb1 {loss_std:.4f}')
Message: 'Epoch 20/20\tLoss 1.9680 \xb1 0.1987'
Arguments: ()
