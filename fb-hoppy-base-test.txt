nohup: ignoring input
Your CPU supports instructions that this binary was not compiled to use: SSE4.1 SSE4.2 AVX
For maximum performance, you can install NMSLIB from sources 
pip install --no-binary :all: nmslib
./bin/hoppy-transe-cli.py --train /home/baadalvm/data/fb15k-237/train.csv --test /home/baadalvm/data/fb15k-237/test.csv --dev /home/baadalvm/data/fb15k-237/valid.csv -e 0 -b 1000 --seed 1 --index nms --eval-batch-size 1000 --save fb-hoppy-base-params-2.txt -k 100 --transe-eval --load-transe fb-transe-params-2.txt
{'GNTP_R': None,
 'N2': None,
 'N3': None,
 'batch_size': 1000,
 'dev': '/home/baadalvm/data/fb15k-237/valid.csv',
 'embedding_size': 100,
 'epochs': 0,
 'eval_batch_size': 1000,
 'freeze_entities': None,
 'hops': ['1', '2'],
 'index_type': 'nms',
 'init': 'uniform',
 'init_size': 1.0,
 'input_type': 'standard',
 'k_max': 3,
 'learning_rate': 0.001,
 'load': None,
 'load_transe': 'fb-transe-params-2.txt',
 'lower_bound': -1.0,
 'nb_negatives': 1,
 'nb_rules': 4,
 'optimizer': 'adam',
 'quiet': False,
 'ref_init': 'uniform',
 'reformulator': 'linear',
 'refresh_interval': None,
 'save': 'fb-hoppy-base-params-2.txt',
 'seed': 1,
 'test': '/home/baadalvm/data/fb15k-237/test.csv',
 'test_i': None,
 'test_ii': None,
 'train': '/home/baadalvm/data/fb15k-237/train.csv',
 'transe_eval': True,
 'upper_bound': 1.0,
 'validate_every': None}
INFO:hoppy-transe-cli.py:Device: cpu
triples reading and predicates.. Done!
size of training triples is  272115
reciprocals.. Done!
Read all test, train, dev triples..!
size of all triples is  310116
entity indexes are set!
for loop is done..!
INFO:hoppy-transe-cli.py:	torch.Size([237, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([14541, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100, 100])	cpu
[[ 9738  2515 11292 12148 12660   830 10949
  10270 12728  7350  6473 12355  3850  8748
  12806 12628 12154 12460  1853  3651 12671
  11398 12741 12614 12633 12642 12512 12644
  12490  9332  9653  1804 12627   385  1459
   1242 12488 11705  5926  9662 12511 12691
  10992  6819  7849 13133  6539 12464 12478
  12369 12617 13555 12641  3422 12755  9887
  11459  5358  8167 11713 10874  7333 12448
  12354  5279   839 10872 12158  7959 12877
   3337 10985 12943    56  7466  3848 11810
  12775  7624 11828 12669 12447 11414  3378
  11079 12491 11446 12667  8448  3806  3602
  11595   829 11296 13232 12486 10074 12605
  13849 11824]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 255.299 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  255.299  255.299 simple.py:52(score)
        3    0.000    0.000  255.294   85.098 profilehooks.py:257(new_fn)
        3    0.131    0.044  255.294   85.098 profilehooks.py:348(__call__)
        3    0.002    0.001  254.467   84.822 kb.py:122(neighbors)
        9  253.780   28.198  253.781   28.198 nms.py:31(build)
        2    0.112    0.056  169.816   84.908 kb.py:75(score)
        1    0.000    0.000   85.387   85.387 simple.py:29(hop)
        1    0.051    0.051   85.346   85.346 kb.py:156(forward)
       18    0.888    0.049    0.888    0.049 {built-in method cat}
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.120    0.040    0.120    0.040 nms.py:51(query)
        3    0.003    0.001    0.006    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.002    0.001    0.002    0.001 {built-in method sqrt}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        1    0.001    0.001    0.001    0.001 {built-in method min}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 256.274 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  256.274  256.274 simple.py:52(score)
        3    0.000    0.000  256.271   85.424 profilehooks.py:257(new_fn)
        3    0.136    0.045  256.270   85.423 profilehooks.py:348(__call__)
        3    0.002    0.001  255.456   85.152 kb.py:122(neighbors)
        9  254.799   28.311  254.801   28.311 nms.py:31(build)
        2    0.124    0.062  171.205   85.602 kb.py:75(score)
        1    0.000    0.000   84.967   84.967 simple.py:29(hop)
        1    0.043    0.043   84.930   84.930 kb.py:156(forward)
       18    0.868    0.048    0.868    0.048 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.099    0.033    0.100    0.033 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[12188 10317  9271 10303  6472 11665  1803
  12503 11572 13840 12016 11889  2528 14185
   3068  2803  8857 11732 12255 11945 12084
   2334  8993   606 14136 11947 11345  1051
  14091 13230 14242  7704 13470 10746     1
   2391 13754 10413  5344 12217 10765   266
   5746 14226 12325 11261 12678  7545 14109
   7340  9534 13894 14163   216 14132   277
   2302 11598 14454 13745   254 11942 12163
  14417 12242  4408 13892   103 14350 14135
  12814 14164 13090 13827  2529  9360  5527
  11603  3380  3845 14233 10399  1915 12269
  13839 10313 12901  1189  7614   304 14255
   6300  4432  2697  3228 14186  1245    12
  11163 11638]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 259.758 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  259.758  259.758 simple.py:52(score)
        3    0.000    0.000  259.755   86.585 profilehooks.py:257(new_fn)
        3    0.111    0.037  259.755   86.585 profilehooks.py:348(__call__)
        3    0.002    0.001  258.895   86.298 kb.py:122(neighbors)
        9  258.212   28.690  258.214   28.690 nms.py:31(build)
        2    0.085    0.043  173.684   86.842 kb.py:75(score)
        1    0.000    0.000   85.997   85.997 simple.py:29(hop)
        1    0.042    0.042   85.960   85.960 kb.py:156(forward)
       18    0.962    0.053    0.962    0.053 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.132    0.044    0.133    0.044 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 258.797 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  258.797  258.797 simple.py:52(score)
        3    0.000    0.000  258.794   86.265 profilehooks.py:257(new_fn)
        3    0.131    0.044  258.794   86.265 profilehooks.py:348(__call__)
        3    0.002    0.001  257.956   85.985 kb.py:122(neighbors)
        9  257.297   28.589  257.299   28.589 nms.py:31(build)
        2    0.116    0.058  172.632   86.316 kb.py:75(score)
        1    0.000    0.000   86.067   86.067 simple.py:29(hop)
        1    0.042    0.042   86.030   86.030 kb.py:156(forward)
       18    0.873    0.048    0.873    0.048 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.125    0.042    0.125    0.042 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 5228   196  2189 10885   186  2835    45
   2741  2848 13459  2892 12019  2730 11916
   6183  6050  2805  9759  3448  6079 13157
   1739  1929   824  2746  2862  4157 13535
   2624   801  2712 11514  2864 10111  6075
    605   577  6226    40 12111  2344  2934
   6316  4460  6064  1905   205  3268  8513
    731  2201 11690  6817   229  3484   691
   3412 13114  2905  2720 13937  1470  2156
   1983  7094   988 13355   827  7967  1868
   2711  7479   233  2372  2731  2955   881
    548  2688  2745 10926  2605   690   550
   2501  3431  6476  2863  2230  2752  2739
  13331  7493 12944   328  2689  2178 10096
   9269  7339]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 260.088 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  260.088  260.088 simple.py:52(score)
        3    0.000    0.000  260.085   86.695 profilehooks.py:257(new_fn)
        3    0.142    0.047  260.085   86.695 profilehooks.py:348(__call__)
        3    0.002    0.001  259.226   86.409 kb.py:122(neighbors)
        9  258.589   28.732  258.590   28.732 nms.py:31(build)
        2    0.117    0.058  173.385   86.693 kb.py:75(score)
        1    0.000    0.000   86.595   86.595 simple.py:29(hop)
        1    0.044    0.044   86.557   86.557 kb.py:156(forward)
       18    0.899    0.050    0.899    0.050 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.085    0.028    0.086    0.029 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 260.633 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  260.633  260.633 simple.py:52(score)
        3    0.000    0.000  260.629   86.876 profilehooks.py:257(new_fn)
        3    0.139    0.046  260.629   86.876 profilehooks.py:348(__call__)
        3    0.002    0.001  259.754   86.585 kb.py:122(neighbors)
        9  259.085   28.787  259.086   28.787 nms.py:31(build)
        2    0.120    0.060  173.402   86.701 kb.py:75(score)
        1    0.000    0.000   87.125   87.125 simple.py:29(hop)
        1    0.046    0.046   87.088   87.088 kb.py:156(forward)
       18    0.917    0.051    0.917    0.051 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.199    0.015 functional.py:1774(embedding)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
        3    0.106    0.035    0.107    0.036 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[10671  7133  5304 10672 12740  3978  4802
   4734  4796 11516  7527 12574  4804  4733
   4799 12920 12570  7981 12567  9678  3773
   5271 10370  6359   982 12506  3720  3660
  11819  3812 12578 10665  4921  6427  4353
  12635  4287  1274  5502  4272 10655  4273
   3401  3458  3460 12559  6493  6418  4890
   3444  4269  4891 10545  3459  3823 12118
   4303  4888  4271 11437  6475 11435  4908
   4386  4335  3400  4300 12080  9926  4270
   3461  5134 11434  3662  9675  3663  3402
   6197  5275  4911 10799  3456  5270 12595
   5207 10675 10666 10658  3748 10602  5274
   5311 10604  8775  3398 11357  4679  4316
   4919 12055]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 261.810 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  261.810  261.810 simple.py:52(score)
        3    0.000    0.000  261.806   87.269 profilehooks.py:257(new_fn)
        3    0.143    0.048  261.806   87.269 profilehooks.py:348(__call__)
        3    0.002    0.001  260.952   86.984 kb.py:122(neighbors)
        9  260.289   28.921  260.290   28.921 nms.py:31(build)
        2    0.118    0.059  174.312   87.156 kb.py:75(score)
        1    0.000    0.000   87.389   87.389 simple.py:29(hop)
        1    0.041    0.041   87.350   87.350 kb.py:156(forward)
       18    0.892    0.050    0.892    0.050 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.111    0.037    0.111    0.037 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 265.226 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  265.226  265.226 simple.py:52(score)
        3    0.000    0.000  265.222   88.407 profilehooks.py:257(new_fn)
        3    0.139    0.046  265.222   88.407 profilehooks.py:348(__call__)
        3    0.002    0.001  264.347   88.116 kb.py:122(neighbors)
        9  263.607   29.290  263.609   29.290 nms.py:31(build)
        2    0.121    0.060  176.376   88.188 kb.py:75(score)
        1    0.000    0.000   88.746   88.746 simple.py:29(hop)
        1    0.045    0.045   88.707   88.707 kb.py:156(forward)
       18    0.949    0.053    0.949    0.053 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
        3    0.150    0.050    0.150    0.050 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 5781 12549 12228  1580 12997 13064 12563
  11394  3898 11764 12826 12395  3911 12784
   9994 12883   443 11733 14094    96 10538
   3275 11569  1490 13601  7640  6678  4418
   7248    41 13337    82  7932  3397  2436
   2019  6835  8442 12523 11220  3119 12890
   2823  8672  1028  9395 11842 11719 13484
   3160 12134 13345  7949 13509  7249 12657
  12909  9492 11717   901 13618 11697 13617
   7159 12971  9766  7247 11291 13430 11864
   1367  3142  7944  1365  3959 12767 12137
  12872   155   201  3955  1972 11122 11888
  13370  8978 13438  7947 11949 12385  1342
  10536  8321 12792 14092   597   594 13553
    202  3164]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 266.075 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  266.075  266.075 simple.py:52(score)
        3    0.000    0.000  266.071   88.690 profilehooks.py:257(new_fn)
        3    0.148    0.049  266.071   88.690 profilehooks.py:348(__call__)
        3    0.002    0.001  265.219   88.406 kb.py:122(neighbors)
        9  264.561   29.396  264.563   29.396 nms.py:31(build)
        2    0.121    0.060  177.309   88.655 kb.py:75(score)
        1    0.000    0.000   88.651   88.651 simple.py:29(hop)
        1    0.043    0.043   88.613   88.613 kb.py:156(forward)
       18    0.868    0.048    0.868    0.048 {built-in method cat}
    18/15    0.007    0.000    0.207    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.110    0.037    0.111    0.037 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 267.218 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  267.218  267.218 simple.py:52(score)
        3    0.000    0.000  267.215   89.072 profilehooks.py:257(new_fn)
        3    0.137    0.046  267.215   89.072 profilehooks.py:348(__call__)
        3    0.002    0.001  266.401   88.800 kb.py:122(neighbors)
        9  265.719   29.524  265.721   29.525 nms.py:31(build)
        2    0.119    0.060  178.156   89.078 kb.py:75(score)
        1    0.000    0.000   88.960   88.960 simple.py:29(hop)
        1    0.043    0.043   88.922   88.922 kb.py:156(forward)
       18    0.847    0.047    0.847    0.047 {built-in method cat}
    18/15    0.001    0.000    0.209    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.206    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.205    0.016 functional.py:1774(embedding)
       13    0.205    0.016    0.205    0.016 {built-in method embedding}
        3    0.000    0.000    0.205    0.068 kb.py:68(generate_facts)
        3    0.127    0.042    0.128    0.043 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 3853   623 12412  6114 11304  1654  1005
  10109  2246  1571 12809  7255  1824  9010
    719   622  3924   772   580   993 13647
   3074  6452  1003  7337 14432   203   199
   5402 14015 10141  3536  7245  9621  7453
   1004 13350  8820 13102  7621   179  9696
   1401 11041  8735  6366 10222  5069  8785
  10254   943   769 10843  1006  4654  1001
  10511  2118  8261 13567  8943  1903  1176
    655  3023  8934  1373  8274  9723  8649
   1153  8344  7423  2765  2033  4946  9915
    773  9042 13872  5205 13967  5378    95
   3937  3884 13000  8902  1475 14422  6723
  12583  2521 11582  4757 13063 14397  4874
   1017  8173]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 268.819 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  268.819  268.819 simple.py:52(score)
        3    0.000    0.000  268.815   89.605 profilehooks.py:257(new_fn)
        3    0.137    0.046  268.815   89.605 profilehooks.py:348(__call__)
        3    0.002    0.001  267.979   89.326 kb.py:122(neighbors)
        9  267.264   29.696  267.266   29.696 nms.py:31(build)
        2    0.130    0.065  178.925   89.463 kb.py:75(score)
        1    0.000    0.000   89.791   89.791 simple.py:29(hop)
        1    0.041    0.041   89.753   89.753 kb.py:156(forward)
       18    0.893    0.050    0.893    0.050 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
        3    0.140    0.047    0.141    0.047 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 269.192 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  269.192  269.192 simple.py:52(score)
        3    0.000    0.000  269.188   89.729 profilehooks.py:257(new_fn)
        3    0.130    0.043  269.188   89.729 profilehooks.py:348(__call__)
        3    0.002    0.001  268.383   89.461 kb.py:122(neighbors)
        9  267.726   29.747  267.728   29.748 nms.py:31(build)
        2    0.122    0.061  179.769   89.885 kb.py:75(score)
        1    0.000    0.000   89.326   89.326 simple.py:29(hop)
        1    0.041    0.041   89.289   89.289 kb.py:156(forward)
       18    0.850    0.047    0.850    0.047 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.117    0.039    0.118    0.039 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[10196 13460  6365 13358   228   107  5984
   2372  7581  2194  4825  2156  2778   178
  12440 13944  7597  2097  6754  8186 10668
  10640  2699   205 12431  2766 10764  4738
   9133  2195  4689 12083  7493  5985  3368
  10898  5062  3525  9035  1222   820  1781
   6962 10870  5105  6704 10387  2724   577
   4121  3016  2664  2861 13508 10213   316
   2781  3372  1582  6292 10858   920  3393
   4872  4492 12151  1964  3091 11931  9934
   4519  2501  2344  1283  1357  6225  7063
   2707 11000   690  7858  2832  1015  9988
   2339  1415   864   354   567   683  4896
   3359 13442  2755  3623  2027  2864  6558
   9606  7396]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 270.969 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  270.969  270.969 simple.py:52(score)
        3    0.000    0.000  270.965   90.322 profilehooks.py:257(new_fn)
        3    0.131    0.044  270.965   90.322 profilehooks.py:348(__call__)
        3    0.002    0.001  270.140   90.047 kb.py:122(neighbors)
        9  269.445   29.938  269.447   29.939 nms.py:31(build)
        2    0.115    0.058  180.676   90.338 kb.py:75(score)
        1    0.000    0.000   90.196   90.196 simple.py:29(hop)
        1    0.046    0.046   90.158   90.158 kb.py:156(forward)
       18    0.879    0.049    0.879    0.049 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.138    0.046    0.138    0.046 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 272.958 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  272.958  272.958 simple.py:52(score)
        3    0.000    0.000  272.954   90.985 profilehooks.py:257(new_fn)
        3    0.134    0.045  272.954   90.985 profilehooks.py:348(__call__)
        3    0.002    0.001  272.105   90.702 kb.py:122(neighbors)
        9  271.382   30.154  271.384   30.154 nms.py:31(build)
        2    0.118    0.059  182.601   91.300 kb.py:75(score)
        1    0.000    0.000   90.257   90.257 simple.py:29(hop)
        1    0.041    0.041   90.219   90.219 kb.py:156(forward)
       18    0.901    0.050    0.901    0.050 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[12240  6995    23 14178 13002 13745  1062
  14096 14337 14245 14197 14451 14374 14143
  14155 14312 14208 11938 12259 11607 14151
  14331   273   264 14437 12238 14514 12247
  13810 13887 14305 14158 12243 14131 12239
  14062 11214 11786 14154 14447  5429  2056
  11718 14257 10378 14394   258 14171 11905
  12267 14234 14090 14236   251 12257  4637
   3093 14165 12256 14431 14446 14255 14157
    219  2721 14531 14162 14297 11155  5520
   2065  4630 12442 12468 12760 14364   259
  14200 14198 14285    14 11558 14230  9919
  14366 14176 14288 12258 14231 12054 10719
  12974 14186 14190 14250 11989 14287 10750
  14528 12493]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 271.943 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  271.943  271.943 simple.py:52(score)
        3    0.000    0.000  271.939   90.646 profilehooks.py:257(new_fn)
        3    0.132    0.044  271.939   90.646 profilehooks.py:348(__call__)
        3    0.002    0.001  271.105   90.368 kb.py:122(neighbors)
        9  270.410   30.046  270.412   30.046 nms.py:31(build)
        2    0.116    0.058  181.584   90.792 kb.py:75(score)
        1    0.000    0.000   90.261   90.261 simple.py:29(hop)
        1    0.043    0.043   90.223   90.223 kb.py:156(forward)
       18    0.887    0.049    0.887    0.049 {built-in method cat}
    18/15    0.001    0.000    0.208    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.205    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.205    0.016 functional.py:1774(embedding)
       13    0.205    0.016    0.205    0.016 {built-in method embedding}
        3    0.000    0.000    0.205    0.068 kb.py:68(generate_facts)
        3    0.129    0.043    0.130    0.043 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 272.742 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  272.742  272.742 simple.py:52(score)
        3    0.000    0.000  272.738   90.913 profilehooks.py:257(new_fn)
        3    0.129    0.043  272.738   90.913 profilehooks.py:348(__call__)
        3    0.002    0.001  271.875   90.625 kb.py:122(neighbors)
        9  271.131   30.126  271.132   30.126 nms.py:31(build)
        2    0.113    0.056  181.822   90.911 kb.py:75(score)
        1    0.000    0.000   90.824   90.824 simple.py:29(hop)
        1    0.042    0.042   90.787   90.787 kb.py:156(forward)
       18    0.946    0.053    0.946    0.053 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.166    0.055    0.166    0.055 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 4177  6890  5618  5208 14410 11821  2347
   9533  7178 11610  3284  9641  5916   307
   8801  6323 10677  9713  6617 14386 12392
   9233  8987  8761 10523  4312 12371   197
   1560  5797  9014  8794  2026  8376 12679
   8160  3515  5048  5543  8911 12529   243
   2213  4498  3308  5868  8084 14396 12398
  11403  4962   629  3500 11561  9101  8094
  12473  5199 12187  5291 14433   444   810
  10983  2456 13513  5363  1485  5145  4592
  13614   657  7383 11746   627 12377  9794
  11498  1063  4840  8609   183 10667 12463
   1130 10873 10148 10561  6658 10176  8935
     33  6618  8934  1282   513 12062  2981
   8861  3708]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.471 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.471  276.471 simple.py:52(score)
        3    0.000    0.000  276.467   92.156 profilehooks.py:257(new_fn)
        3    0.137    0.046  276.467   92.156 profilehooks.py:348(__call__)
        3    0.002    0.001  275.572   91.857 kb.py:122(neighbors)
        9  274.855   30.539  274.857   30.540 nms.py:31(build)
        2    0.108    0.054  184.119   92.060 kb.py:75(score)
        1    0.000    0.000   92.249   92.249 simple.py:29(hop)
        1    0.042    0.042   92.211   92.211 kb.py:156(forward)
       18    0.939    0.052    0.939    0.052 {built-in method cat}
    18/15    0.001    0.000    0.214    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.211    0.070 kb.py:68(generate_facts)
        3    0.157    0.052    0.158    0.053 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 273.438 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  273.438  273.438 simple.py:52(score)
        3    0.000    0.000  273.434   91.145 profilehooks.py:257(new_fn)
        3    0.166    0.055  273.434   91.145 profilehooks.py:348(__call__)
        3    0.002    0.001  272.523   90.841 kb.py:122(neighbors)
        9  271.812   30.201  271.814   30.202 nms.py:31(build)
        2    0.146    0.073  183.698   91.849 kb.py:75(score)
        1    0.000    0.000   89.607   89.607 simple.py:29(hop)
        1    0.043    0.043   89.570   89.570 kb.py:156(forward)
       18    0.887    0.049    0.887    0.049 {built-in method cat}
    18/15    0.001    0.000    0.204    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.163    0.054    0.163    0.054 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 4461  2576   708 11031   797  9718  3791
    176   808 12413  7661   301   851    30
    466 10123  2321  2433  9720   416 12047
   1872 14450  1397  9498   698 12203   847
   1400 10984 13006  2247 10007  1161   709
  13621   795 10510   210   433  8356   194
    799  6244   303  2706  1478 12219    53
  13956  6639  8006  7087   458  9757  6494
  10122   467   574 13608   291  1495  5615
  11846   168   638 10768 11541  5942 13031
   9632   324   603 14448   209  1986   420
    533 10760 12887 10921   672 14026  9978
   2483  6086  5820   677   674  1975   421
  10860   921  4429 11319   576  9075 13065
  13281  8988]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 274.685 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  274.685  274.685 simple.py:52(score)
        3    0.000    0.000  274.681   91.560 profilehooks.py:257(new_fn)
        3    0.141    0.047  274.681   91.560 profilehooks.py:348(__call__)
        3    0.002    0.001  273.839   91.280 kb.py:122(neighbors)
        9  273.149   30.350  273.150   30.350 nms.py:31(build)
        2    0.128    0.064  182.992   91.496 kb.py:75(score)
        1    0.000    0.000   91.585   91.585 simple.py:29(hop)
        1    0.043    0.043   91.547   91.547 kb.py:156(forward)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.194    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.110    0.037    0.110    0.037 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 274.470 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  274.470  274.470 simple.py:52(score)
        3    0.000    0.000  274.467   91.489 profilehooks.py:257(new_fn)
        3    0.136    0.045  274.466   91.489 profilehooks.py:348(__call__)
        3    0.002    0.001  273.623   91.208 kb.py:122(neighbors)
        9  272.930   30.326  272.932   30.326 nms.py:31(build)
        2    0.117    0.059  182.351   91.176 kb.py:75(score)
        1    0.000    0.000   92.016   92.016 simple.py:29(hop)
        1    0.043    0.043   91.979   91.979 kb.py:156(forward)
       18    0.910    0.051    0.910    0.051 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.194    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.119    0.040    0.120    0.040 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[11391  7162 11527  6145 11282  9647  9520
  13197 12453   980  1477  9976 12112  1723
   1663 11744 10613 11807 11492 13068  4361
  11177 10215  9436 12498  1588  5941  9038
  14053 11002  1311 10025  6788  4534  3039
   3508  2585 11395  9475 14114  3302 10059
   6138  1116  4535 14115  6259 11342  6655
  12940 10087  5113  4166 11149 13240  5015
  11222  5524  8437  1609 13001 10104  6960
  14113   978 11997  7951  8385 10690  1660
   2044   814 12449  1496 14336 11193  2482
   6256 10987  2582 11093  9655  9384  1855
   1818  4671  2795  8471  3193  1702   145
   2042  4779  3811  3866  3496 11308  6361
   1502  6683]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 275.509 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  275.509  275.509 simple.py:52(score)
        3    0.000    0.000  275.505   91.835 profilehooks.py:257(new_fn)
        3    0.133    0.044  275.505   91.835 profilehooks.py:348(__call__)
        3    0.002    0.001  274.648   91.549 kb.py:122(neighbors)
        9  273.980   30.442  273.981   30.442 nms.py:31(build)
        2    0.112    0.056  183.769   91.884 kb.py:75(score)
        1    0.000    0.000   91.641   91.641 simple.py:29(hop)
        1    0.043    0.043   91.603   91.603 kb.py:156(forward)
       18    0.919    0.051    0.919    0.051 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.107    0.036    0.107    0.036 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 274.989 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  274.989  274.989 simple.py:52(score)
        3    0.000    0.000  274.984   91.661 profilehooks.py:257(new_fn)
        3    0.137    0.046  274.984   91.661 profilehooks.py:348(__call__)
        3    0.002    0.001  274.130   91.377 kb.py:122(neighbors)
        9  273.461   30.385  273.463   30.385 nms.py:31(build)
        2    0.118    0.059  182.738   91.369 kb.py:75(score)
        1    0.000    0.000   92.147   92.147 simple.py:29(hop)
        1    0.042    0.042   92.109   92.109 kb.py:156(forward)
       18    0.893    0.050    0.893    0.050 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.126    0.042    0.127    0.042 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[  772 13647  1005   623  3924   199  6452
   7245 12412  9010 14015  1824  6114  7255
   1003   622  9621   580  9696 10511 12809
   1004  3074  3853  3536 13967  1001  4654
     95 11041  5402   769   719   655  6366
  13063 10141 10843 13567 12798 14432  4874
    773  1475 14422 11304   105  8173  9915
    943 14397 13872  1373  6723  1006  1176
   9532 12583  2033  3937 10222 13102 10254
   8344  8649  2521  4757 12050 13109  5205
   8934  4946  7621  8902   781  8943  2246
  13511  8521 11497 11757  7423  5378  7453
   9042  1017  8820  3941 13350  9984  5782
   2897  2021  2118 10109  9197  1654  3022
    775  5080]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.891 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.891  276.891 simple.py:52(score)
        3    0.000    0.000  276.887   92.296 profilehooks.py:257(new_fn)
        3    0.132    0.044  276.887   92.296 profilehooks.py:348(__call__)
        3    0.002    0.001  276.043   92.014 kb.py:122(neighbors)
        9  275.382   30.598  275.384   30.598 nms.py:31(build)
        2    0.109    0.055  184.819   92.410 kb.py:75(score)
        1    0.000    0.000   91.974   91.974 simple.py:29(hop)
        1    0.041    0.041   91.935   91.935 kb.py:156(forward)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.115    0.038    0.116    0.039 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:294(register_parameter)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 275.185 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  275.185  275.185 simple.py:52(score)
        3    0.000    0.000  275.181   91.727 profilehooks.py:257(new_fn)
        3    0.137    0.046  275.181   91.727 profilehooks.py:348(__call__)
        3    0.002    0.001  274.327   91.442 kb.py:122(neighbors)
        9  273.623   30.403  273.624   30.403 nms.py:31(build)
        2    0.084    0.042  183.516   91.758 kb.py:75(score)
        1    0.000    0.000   91.588   91.588 simple.py:29(hop)
        1    0.080    0.080   91.527   91.527 kb.py:156(forward)
       18    0.882    0.049    0.882    0.049 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.161    0.054    0.162    0.054 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 6336  8521 11746    33    95 13063  8609
   8094  1001 10511  8173  1130 12050 14397
    105   655  4874 12798  5080 12583  9472
  14422  9197 14396 11757   775 13109 11498
   9532  1282   199   657 13647   721 13967
   6723  9621  4555 14433  9839 10843 10176
   1561  8344  3937 10148  6366  5291  8935
   1485  5970  9984  3708 11041   769   773
   9572 13513  3941  5782  9696 13567   513
   7245  5363  1475  6657  9915  8336 13511
  11769 14015  8320  6258  8934  1681  6452
   3207   629  4654  1176   742   781  2897
    772  4757  5581 10561  2521 11497  7866
   8911  8649  1591  6866  1004  1017  2112
  13614  9794]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.125 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.125  276.125 simple.py:52(score)
        3    0.000    0.000  276.121   92.040 profilehooks.py:257(new_fn)
        3    0.144    0.048  276.121   92.040 profilehooks.py:348(__call__)
        3    0.002    0.001  275.248   91.749 kb.py:122(neighbors)
        9  274.581   30.509  274.583   30.509 nms.py:31(build)
        2    0.085    0.043  183.964   91.982 kb.py:75(score)
        1    0.000    0.000   92.082   92.082 simple.py:29(hop)
        1    0.076    0.076   92.013   92.013 kb.py:156(forward)
       18    0.931    0.052    0.931    0.052 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.088    0.029    0.089    0.030 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.212 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.212  276.212 simple.py:52(score)
        3    0.000    0.000  276.208   92.069 profilehooks.py:257(new_fn)
        3    0.141    0.047  276.208   92.069 profilehooks.py:348(__call__)
        3    0.002    0.001  275.375   91.792 kb.py:122(neighbors)
        9  274.665   30.518  274.667   30.519 nms.py:31(build)
        2    0.083    0.042  184.033   92.016 kb.py:75(score)
        1    0.000    0.000   92.101   92.101 simple.py:29(hop)
        1    0.076    0.076   92.034   92.034 kb.py:156(forward)
       18    0.859    0.048    0.859    0.048 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


[[11916  2730  3448  2386 12944   196 13157
  13459  2711  2835  2712 13283  2805   827
   3268   824  5228  6064  5951  2722  2892
   6558  2914  2492 11914  2731  2605   987
   3412  2923  7690  2096  7493  7094  4995
   2500   881 11996  5039 13535  2720    40
   2905  2164  6075  2344  2746 13355  2221
   2862  2955  6226  1983  5338 12151  9759
   2178  8501 10464  2621  1739  2864   354
   3372  7885 14002  2691  7479  5499  9988
   2689 13937  7967  9503  2163 11859  6050
   2624  2201 13114  1954  2734  4157    45
   2093  2741  2745 12502  3359   691  5542
    184 12236   188  6964  1224  5773   328
   4557  4661]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 273.188 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  273.188  273.188 simple.py:52(score)
        3    0.000    0.000  273.185   91.062 profilehooks.py:257(new_fn)
        3    0.115    0.038  273.185   91.062 profilehooks.py:348(__call__)
        3    0.002    0.001  272.472   90.824 kb.py:122(neighbors)
        9  271.921   30.213  271.923   30.214 nms.py:31(build)
        2    0.084    0.042  183.734   91.867 kb.py:75(score)
        1    0.000    0.000   89.373   89.373 simple.py:29(hop)
        1    0.040    0.040   89.335   89.335 kb.py:156(forward)
       18    0.785    0.044    0.785    0.044 {built-in method cat}
    18/15    0.001    0.000    0.186    0.012 module.py:715(_call_impl)
       13    0.000    0.000    0.184    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.184    0.061 kb.py:68(generate_facts)
       13    0.000    0.000    0.184    0.014 functional.py:1774(embedding)
       13    0.183    0.014    0.183    0.014 {built-in method embedding}
        3    0.041    0.014    0.042    0.014 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 275.243 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  275.243  275.243 simple.py:52(score)
        3    0.000    0.000  275.239   91.746 profilehooks.py:257(new_fn)
        3    0.137    0.046  275.239   91.746 profilehooks.py:348(__call__)
        3    0.002    0.001  274.415   91.472 kb.py:122(neighbors)
        9  273.807   30.423  273.809   30.423 nms.py:31(build)
        2    0.126    0.063  182.954   91.477 kb.py:75(score)
        1    0.000    0.000   92.186   92.186 simple.py:29(hop)
        1    0.045    0.045   92.148   92.148 kb.py:156(forward)
       18    0.833    0.046    0.833    0.046 {built-in method cat}
    18/15    0.001    0.000    0.205    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.202    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.202    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.202    0.067 kb.py:68(generate_facts)
       13    0.202    0.016    0.202    0.016 {built-in method embedding}
        3    0.074    0.025    0.075    0.025 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[10961  8111   919  8745   309  8042  9065
  14056  2725 12001  7682  2870  7789  6541
   9339 12750  9568  1340  1913  6431  2942
   7001 10814  4688  5035  3985 13429  7923
   9511  1038 12711  1645  4355  1807  8876
  10369  4684   365   737   120  4878  7363
   2626  7024  7733 10995  1316  7666  3162
   7408  7304  4133  6785  3081  6478  4319
   3447  4912 11529  1209  5089  9497  3744
   6727  5060  9948  6733  6468  5804 13853
   4290 10138   366  4456  2852 10696  9600
   7132  5294 10763  4759  3267   244  6631
   4664  2698  5835  1065  7814  3172  7537
   1139  9089  7746  5477  8840  6847  2192
     46  9576]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 273.947 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  273.947  273.947 simple.py:52(score)
        3    0.000    0.000  273.943   91.314 profilehooks.py:257(new_fn)
        3    0.137    0.046  273.943   91.314 profilehooks.py:348(__call__)
        3    0.002    0.001  273.129   91.043 kb.py:122(neighbors)
        9  272.476   30.275  272.477   30.275 nms.py:31(build)
        2    0.120    0.060  182.040   91.020 kb.py:75(score)
        1    0.000    0.000   91.804   91.804 simple.py:29(hop)
        1    0.042    0.042   91.766   91.766 kb.py:156(forward)
       18    0.855    0.048    0.855    0.048 {built-in method cat}
    18/15    0.001    0.000    0.205    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.202    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.202    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.202    0.067 kb.py:68(generate_facts)
       13    0.202    0.016    0.202    0.016 {built-in method embedding}
        3    0.096    0.032    0.097    0.032 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 273.692 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  273.692  273.692 simple.py:52(score)
        3    0.000    0.000  273.689   91.230 profilehooks.py:257(new_fn)
        3    0.133    0.044  273.689   91.230 profilehooks.py:348(__call__)
        3    0.002    0.001  272.894   90.965 kb.py:122(neighbors)
        9  272.262   30.251  272.263   30.251 nms.py:31(build)
        2    0.123    0.061  181.529   90.765 kb.py:75(score)
        1    0.000    0.000   92.065   92.065 simple.py:29(hop)
        1    0.043    0.043   92.027   92.027 kb.py:156(forward)
       18    0.819    0.046    0.819    0.046 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
       13    0.191    0.015    0.191    0.015 {built-in method embedding}
        3    0.103    0.034    0.104    0.035 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 7063  5920 11690 12390   567 10111  2731
   6078   577  6226   988  2766  2477  2755
   2724  2478  6070 12440   226  2800  4909
   2836  2727  2747  9775 13442  2652  2722
   7564  4554  1202  8186   316   230  1926
    178 10601  9759  2825  1268  2620  5381
   1033 14418   450 12976  2554 12165  6174
   2935  2707  3888  2151  6476  1739  1484
    189  6595   228  4018  4739  2709  4082
    801  3865  2742  2339  2859  3120 12061
   4584  2895  3016  9209  9185  2736  2826
    393  4714  6182  6817 14010  7588  4846
  13358  4896  2757   693  2916 12151   107
   2898  2372  7097  5295   454 11745  3077
   2705  2889]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 274.104 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  274.104  274.104 simple.py:52(score)
        3    0.000    0.000  274.101   91.367 profilehooks.py:257(new_fn)
        3    0.136    0.045  274.101   91.367 profilehooks.py:348(__call__)
        3    0.002    0.001  273.259   91.086 kb.py:122(neighbors)
        9  272.673   30.297  272.674   30.297 nms.py:31(build)
        2    0.119    0.059  182.219   91.109 kb.py:75(score)
        1    0.000    0.000   91.784   91.784 simple.py:29(hop)
        1    0.041    0.041   91.746   91.746 kb.py:156(forward)
       18    0.869    0.048    0.869    0.048 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
       13    0.191    0.015    0.191    0.015 {built-in method embedding}
        3    0.057    0.019    0.057    0.019 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.984 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.984  276.984 simple.py:52(score)
        3    0.000    0.000  276.980   92.327 profilehooks.py:257(new_fn)
        3    0.137    0.046  276.980   92.327 profilehooks.py:348(__call__)
        3    0.002    0.001  276.114   92.038 kb.py:122(neighbors)
        9  275.492   30.610  275.494   30.610 nms.py:31(build)
        2    0.119    0.059  184.864   92.432 kb.py:75(score)
        1    0.000    0.000   92.017   92.017 simple.py:29(hop)
        1    0.041    0.041   91.979   91.979 kb.py:156(forward)
       18    0.926    0.051    0.926    0.051 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.053    0.018    0.053    0.018 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 1832 13129   736 12761  7474 10192    68
   4132 11259 14279 14276 10726  2464  6613
  14280  8335 13140 13939  7742  1293 13117
   4074 12882 11426  7724  5223  2843  3742
   2315  6554 10638  7183  4730  1710   739
  10094    60  4747  3816  5097  4611 11253
  14493 11336 13097  7868  9865 14031 13164
   1805  7379 10425  3576 10033  1639 14505
   2978   131 11404 14441   726 14273 13196
   9543  5534 12494  3721   288 13113 13540
   2250  2469  8192  6350  3188  3504 13755
  12521  5904   666  6295  4453  4484 14499
  13571 14047  6904 10957  6976 12896  4222
   6900  8100  8145   640 11311 14032 10782
   1715 14500]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.300 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.300  278.300 simple.py:52(score)
        3    0.000    0.000  278.296   92.765 profilehooks.py:257(new_fn)
        3    0.117    0.039  278.296   92.765 profilehooks.py:348(__call__)
        3    0.002    0.001  277.472   92.491 kb.py:122(neighbors)
        9  276.809   30.757  276.810   30.757 nms.py:31(build)
        2    0.084    0.042  186.059   93.029 kb.py:75(score)
        1    0.000    0.000   92.158   92.158 simple.py:29(hop)
        1    0.041    0.041   92.120   92.120 kb.py:156(forward)
       18    0.921    0.051    0.921    0.051 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.119    0.040    0.120    0.040 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.207 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.207  277.207 simple.py:52(score)
        3    0.000    0.000  277.203   92.401 profilehooks.py:257(new_fn)
        3    0.143    0.048  277.203   92.401 profilehooks.py:348(__call__)
        3    0.002    0.001  276.330   92.110 kb.py:122(neighbors)
        9  275.668   30.630  275.670   30.630 nms.py:31(build)
        2    0.124    0.062  185.388   92.694 kb.py:75(score)
        1    0.000    0.000   91.716   91.716 simple.py:29(hop)
        1    0.043    0.043   91.671   91.671 kb.py:156(forward)
       18    0.895    0.050    0.895    0.050 {built-in method cat}
    18/15    0.001    0.000    0.207    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.203    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.203    0.016 functional.py:1774(embedding)
       13    0.203    0.016    0.203    0.016 {built-in method embedding}
        3    0.000    0.000    0.203    0.068 kb.py:68(generate_facts)
        3    0.111    0.037    0.111    0.037 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[    8 10745 14532  8718   260 14075     2
      7 13457 14519 14511 10743 14246     9
  14319     3 14311 14217 14310 14512 14490
  14225 14318   279    20 14074 10741 14526
  10748 14334 14361 14252  1508     6 10747
  14373 14253 14368 14215 14300   283 14117
  14393 10744 14224    17 14483 14367 12261
    253 14166 14203 13159 14152 14144 14421
  14385 14326 14322 14206 14510 14078 14537
  14139 12142 14445 13660 14138 14527 14247
  12092   261 14184 14292 14213 14303 14076
  14484 11639 14157 14539 11720 14307 14415
    274 14258   263  1513 14315 14229 14244
  10028 14228 14365 14188 14150 14259  6805
  14254 12370]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.975 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.975  277.975 simple.py:52(score)
        3    0.000    0.000  277.971   92.657 profilehooks.py:257(new_fn)
        3    0.136    0.045  277.971   92.657 profilehooks.py:348(__call__)
        3    0.002    0.001  277.054   92.351 kb.py:122(neighbors)
        9  276.418   30.713  276.420   30.713 nms.py:31(build)
        2    0.088    0.044  184.902   92.451 kb.py:75(score)
        1    0.000    0.000   92.992   92.992 simple.py:29(hop)
        1    0.072    0.072   92.932   92.932 kb.py:156(forward)
       18    0.954    0.053    0.954    0.053 {built-in method cat}
    18/15    0.001    0.000    0.212    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.209    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.209    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.209    0.070 kb.py:68(generate_facts)
       13    0.209    0.016    0.209    0.016 {built-in method embedding}
        3    0.078    0.026    0.079    0.026 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        3    0.000    0.000    0.000    0.000 {built-in method exp}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.730 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.730  278.730 simple.py:52(score)
        3    0.000    0.000  278.726   92.909 profilehooks.py:257(new_fn)
        3    0.135    0.045  278.726   92.909 profilehooks.py:348(__call__)
        3    0.002    0.001  277.880   92.627 kb.py:122(neighbors)
        9  277.169   30.797  277.171   30.797 nms.py:31(build)
        2    0.088    0.044  186.671   93.335 kb.py:75(score)
        1    0.000    0.000   91.980   91.980 simple.py:29(hop)
        1    0.076    0.076   91.921   91.921 kb.py:156(forward)
       18    0.881    0.049    0.881    0.049 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
       13    0.191    0.015    0.191    0.015 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.170    0.057    0.171    0.057 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[14396 11746 11498  5363   629  1485 10176
   8609  8094 10561  8160  9794   657  6336
   8911 13614  5970  1282 13513  4498  1130
   6657  6258    33  4840   721  5291   742
    444  5080  8336  9472  5868   775 10555
   5199 10610   513  1561 14433  9839  3708
  11757  4555  5123   105 13063  9197  9572
   9984 10148   183  8935  5145  8861  2026
   8521  8173   627 12050  1500 12327  3247
   8320  4704 14397 12798  9158  1591 12679
  12607  9014 12463  3243 13546 12473 10233
    553 13422    95  4592 14422 11769 12583
  12692  8794  8728  4874   566 13109  6723
  12472  5782   786  9532  8395  3941  4135
   4075  3055]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.187  278.187 simple.py:52(score)
        3    0.000    0.000  278.183   92.728 profilehooks.py:257(new_fn)
        3    0.131    0.044  278.183   92.728 profilehooks.py:348(__call__)
        3    0.002    0.001  277.404   92.468 kb.py:122(neighbors)
        9  276.715   30.746  276.717   30.746 nms.py:31(build)
        2    0.113    0.057  185.323   92.662 kb.py:75(score)
        1    0.000    0.000   92.767   92.767 simple.py:29(hop)
        1    0.042    0.042   92.729   92.729 kb.py:156(forward)
       18    0.812    0.045    0.812    0.045 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.165    0.055    0.165    0.055 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.203 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.203  276.203 simple.py:52(score)
        3    0.000    0.000  276.199   92.066 profilehooks.py:257(new_fn)
        3    0.114    0.038  276.199   92.066 profilehooks.py:348(__call__)
        3    0.002    0.001  275.474   91.825 kb.py:122(neighbors)
        9  274.757   30.529  274.758   30.529 nms.py:31(build)
        2    0.085    0.042  184.742   92.371 kb.py:75(score)
        1    0.000    0.000   91.382   91.382 simple.py:29(hop)
        1    0.043    0.043   91.344   91.344 kb.py:156(forward)
       18    0.835    0.046    0.835    0.046 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
       13    0.191    0.015    0.191    0.015 {built-in method embedding}
        3    0.159    0.053    0.160    0.053 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[    6 14373 10745   274 14519 13457   283
  10743  8718 14075 14511 10744 14138 14322
  11903 14139   261 14490 14483 14319 14512
  12092 14318 14225 12261 14292 12142 10748
  12481 14253 14074  1508 14184    20 14526
  12254 13660 14076 14224 13159 12264 11639
    279 14144 10741 14420 14188 14215     7
  14368   249 14527 10028   260 14529 14259
  14444 14485     2 14300   263 14385  7243
    253 10725 14367 14077  3093    17 13208
  14254 14247  9363 14310 11917 11720  6805
   1688 14311 12789 14251  5032 14326 13203
   2616 14217  1480 14532     0 14252 14331
  12266 12238 12389 11269 10750 10919 14293
   9762 10958]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.523 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.523  276.523 simple.py:52(score)
        3    0.000    0.000  276.519   92.173 profilehooks.py:257(new_fn)
        3    0.126    0.042  276.519   92.173 profilehooks.py:348(__call__)
        3    0.002    0.001  275.686   91.895 kb.py:122(neighbors)
        9  275.011   30.557  275.012   30.557 nms.py:31(build)
        2    0.114    0.057  183.705   91.853 kb.py:75(score)
        1    0.000    0.000   92.725   92.725 simple.py:29(hop)
        1    0.043    0.043   92.687   92.687 kb.py:156(forward)
       18    0.897    0.050    0.897    0.050 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.126    0.042    0.126    0.042 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.366 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.366  277.366 simple.py:52(score)
        3    0.000    0.000  277.362   92.454 profilehooks.py:257(new_fn)
        3    0.153    0.051  277.362   92.454 profilehooks.py:348(__call__)
        3    0.002    0.001  276.422   92.141 kb.py:122(neighbors)
        9  275.671   30.630  275.673   30.630 nms.py:31(build)
        2    0.148    0.074  185.007   92.504 kb.py:75(score)
        1    0.000    0.000   92.240   92.240 simple.py:29(hop)
        1    0.044    0.044   92.202   92.202 kb.py:156(forward)
       18    0.943    0.052    0.943    0.052 {built-in method cat}
    18/15    0.001    0.000    0.215    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.212    0.071 kb.py:68(generate_facts)
        3    0.174    0.058    0.174    0.058 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[   50 10592  4994 11827  7465  1885  1293
   6711 10221 11045 11281  4827 11700  4651
   8491  5960  4073  6080  1319  3562 12687
   7533  6206 11030  1709  7357  3105  1497
   7172 11800  7141 11813  1463  9590  4875
   5224  8754  1715 12454  3822  2673 11689
   8886  6703 13984 12064    74  1197 13325
  13981  7104  4215  1837  3196   760    66
  10547  9333  5350  7553  9178  9444  5631
   2978  7010  4819  6873  4697  6531  5025
  10259 12290  2481  9603    64  4961  1456
  13540  3796  8429   632 10767 14049 11780
    752 12093  4647  3816  9571 10205 11809
   4887  6865  1098 11288 10155 11685  2374
   9213  1666]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.943 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.943  276.943 simple.py:52(score)
        3    0.000    0.000  276.939   92.313 profilehooks.py:257(new_fn)
        3    0.139    0.046  276.939   92.313 profilehooks.py:348(__call__)
        3    0.002    0.001  276.097   92.032 kb.py:122(neighbors)
        9  275.440   30.604  275.442   30.605 nms.py:31(build)
        2    0.122    0.061  184.939   92.470 kb.py:75(score)
        1    0.000    0.000   91.900   91.900 simple.py:29(hop)
        1    0.043    0.043   91.861   91.861 kb.py:156(forward)
       18    0.908    0.050    0.908    0.050 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.084    0.028    0.085    0.028 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.810 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.810  277.810 simple.py:52(score)
        3    0.000    0.000  277.806   92.602 profilehooks.py:257(new_fn)
        3    0.137    0.046  277.806   92.602 profilehooks.py:348(__call__)
        3    0.002    0.001  276.983   92.328 kb.py:122(neighbors)
        9  276.328   30.703  276.330   30.703 nms.py:31(build)
        2    0.120    0.060  184.996   92.498 kb.py:75(score)
        1    0.000    0.000   92.710   92.710 simple.py:29(hop)
        1    0.043    0.043   92.673   92.673 kb.py:156(forward)
       18    0.879    0.049    0.879    0.049 {built-in method cat}
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.089    0.030    0.090    0.030 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[14441  8577  5671   141  6922  4877 11778
   9828 10981 11100  6904  5930  4484  8475
  10685  4695  3541  8214  9213   526  1423
   6925  4828  5000  5532  7172 11029 14103
   1497  1111 11685    50 11958 12364  9611
   4922  6333  3963  4829 14032  4011 11649
   7379 14443 13223 10673  9489  6580 10974
    409  3424 11377  6554  6305  6765  3870
   3819 12420  6570 11097  6600 12004 14375
  12026  2168  6650 11439  7357  2641  6442
   2978   559 13755  5673  5276 14043  8353
   5405  4073 13939  6295  3511 11259  4697
   4114 13554 10869  1884 11777 12056  5496
  13113  9070   935  7726 11827   545  4581
  10704  4132]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.283 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.283  278.283 simple.py:52(score)
        3    0.000    0.000  278.280   92.760 profilehooks.py:257(new_fn)
        3    0.140    0.047  278.280   92.760 profilehooks.py:348(__call__)
        3    0.002    0.001  277.390   92.463 kb.py:122(neighbors)
        9  276.734   30.748  276.735   30.748 nms.py:31(build)
        2    0.131    0.065  184.510   92.255 kb.py:75(score)
        1    0.000    0.000   93.668   93.668 simple.py:29(hop)
        1    0.043    0.043   93.630   93.630 kb.py:156(forward)
       18    0.904    0.050    0.904    0.050 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.125    0.042    0.126    0.042 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.766 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.766  278.766 simple.py:52(score)
        3    0.000    0.000  278.762   92.921 profilehooks.py:257(new_fn)
        3    0.137    0.046  278.762   92.921 profilehooks.py:348(__call__)
        3    0.002    0.001  277.906   92.635 kb.py:122(neighbors)
        9  277.208   30.801  277.209   30.801 nms.py:31(build)
        2    0.119    0.060  185.785   92.892 kb.py:75(score)
        1    0.000    0.000   92.878   92.878 simple.py:29(hop)
        1    0.043    0.043   92.840   92.840 kb.py:156(forward)
       18    0.878    0.049    0.878    0.049 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.170    0.057    0.171    0.057 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 1529    97  5829  3416  3970  7928   823
  10135 12659  8768  9172  4382  1914  1540
   4886 14127  2014 14261  4965 11683  1517
   6287  1230 14345 12737  5988  4634  9951
   1195  6015  8231  8461  4867  6947  5652
   5470  1747 13263  7617  8560  5468  7995
   8389  9388  4516  8939  8430 12085 12905
   7066 10752  4497  2999  9985   880 13765
   6325  9607  3706   703  5026  9174  5678
  11454  4328   342  4772  9609 13266  5580
  12161  7580   540 12372  2690 12104  8629
   1082  3968  8125   741 11593 11491  1191
    368 11837  2327  3032  6481 10174  2496
   4185 14344  1411 13987  7963  8243  3971
   3825  7336]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.725 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.725  276.725 simple.py:52(score)
        3    0.000    0.000  276.721   92.240 profilehooks.py:257(new_fn)
        3    0.114    0.038  276.721   92.240 profilehooks.py:348(__call__)
        3    0.002    0.001  275.984   91.995 kb.py:122(neighbors)
        9  275.266   30.585  275.268   30.585 nms.py:31(build)
        2    0.084    0.042  184.093   92.047 kb.py:75(score)
        1    0.000    0.000   92.552   92.552 simple.py:29(hop)
        1    0.043    0.043   92.514   92.514 kb.py:156(forward)
       18    0.825    0.046    0.825    0.046 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
        3    0.188    0.063    0.188    0.063 nms.py:51(query)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 275.835 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  275.835  275.835 simple.py:52(score)
        3    0.000    0.000  275.831   91.944 profilehooks.py:257(new_fn)
        3    0.133    0.044  275.831   91.944 profilehooks.py:348(__call__)
        3    0.001    0.000  275.033   91.678 kb.py:122(neighbors)
        9  274.424   30.492  274.425   30.492 nms.py:31(build)
        2    0.091    0.046  183.340   91.670 kb.py:75(score)
        1    0.000    0.000   92.414   92.414 simple.py:29(hop)
        1    0.072    0.072   92.358   92.358 kb.py:156(forward)
       18    0.815    0.045    0.815    0.045 {built-in method cat}
    18/15    0.001    0.000    0.186    0.012 module.py:715(_call_impl)
       13    0.000    0.000    0.183    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.183    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.183    0.061 kb.py:68(generate_facts)
       13    0.183    0.014    0.183    0.014 {built-in method embedding}
        3    0.101    0.034    0.101    0.034 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[12499 14097 11793  7615  4521  5331  2283
  10156  1945  2085  4490  1044  9312  5669
  12458   135  2583 13543  9659  1151 12993
  10208 11676  5568  1381  6348  7895  7631
    344 13267 11542 10362 10198 14376  2109
   1383 12782  2361  1199  1866  7969  2244
    399  3478  2453 13505 11305 11506   857
  10344 12957 11208  7967  4780 11230  9425
   8990 10506   977 12309   229 11674  7612
   6327 10430  9777  5688    85  1016  8984
    186  8769  9884  8408  6183  2711 12588
   4936  1593  1923 11301   334  6817  7589
  12803 12804  6959   118    78  1251 10948
   9386 11675  7339  5173 12733   364  1193
  12720  2781]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.633 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  276.633  276.633 simple.py:52(score)
        3    0.000    0.000  276.630   92.210 profilehooks.py:257(new_fn)
        3    0.116    0.039  276.630   92.210 profilehooks.py:348(__call__)
        3    0.001    0.000  275.901   91.967 kb.py:122(neighbors)
        9  275.235   30.582  275.237   30.582 nms.py:31(build)
        2    0.084    0.042  184.176   92.088 kb.py:75(score)
        1    0.000    0.000   92.376   92.376 simple.py:29(hop)
        1    0.042    0.042   92.338   92.338 kb.py:156(forward)
       18    0.799    0.044    0.799    0.044 {built-in method cat}
    18/15    0.001    0.000    0.207    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
       13    0.000    0.000    0.204    0.016 functional.py:1774(embedding)
       13    0.204    0.016    0.204    0.016 {built-in method embedding}
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.992 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.992  277.992 simple.py:52(score)
        3    0.000    0.000  277.989   92.663 profilehooks.py:257(new_fn)
        3    0.134    0.045  277.989   92.663 profilehooks.py:348(__call__)
        3    0.002    0.001  277.209   92.403 kb.py:122(neighbors)
        9  276.519   30.724  276.521   30.725 nms.py:31(build)
        2    0.112    0.056  186.027   93.014 kb.py:75(score)
        1    0.000    0.000   91.866   91.866 simple.py:29(hop)
        1    0.041    0.041   91.828   91.828 kb.py:156(forward)
       18    0.837    0.046    0.837    0.046 {built-in method cat}
    18/15    0.001    0.000    0.186    0.012 module.py:715(_call_impl)
       13    0.000    0.000    0.183    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.183    0.061 kb.py:68(generate_facts)
       13    0.000    0.000    0.183    0.014 functional.py:1774(embedding)
       13    0.183    0.014    0.183    0.014 {built-in method embedding}
        3    0.149    0.050    0.150    0.050 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[12354 12490 12660  3850 12488   385  7350
  12491  2515 10874  1242 12148 12627  6819
  11296 12355 12671 12943 12614  5926 11595
  11398 12633  1804 10992 12460 12628 12447
  12755  8748 12806 10985 12422 12741 10068
  12448 11414  9332  7849 12641  8966 12369
  10949 11446  6818  3806 12147  6520 12154
  12617  9612 12511  9738 12906 11755 10910
   7185 11823 12667 12486 10080 13555   830
  12613  1853  9887 10270  7466  6473  5279
  11705 10872  7333  1348 13133 12459 12728
  11103 12716 12644 11399   892 12433 12616
   8167  9260  8479 12512  7749  1503 13849
   4775  9653 11459 12642 10662 13533 11752
  11186 12664]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.773 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.773  278.773 simple.py:52(score)
        3    0.000    0.000  278.769   92.923 profilehooks.py:257(new_fn)
        3    0.153    0.051  278.769   92.923 profilehooks.py:348(__call__)
        3    0.002    0.001  277.876   92.625 kb.py:122(neighbors)
        9  277.189   30.799  277.190   30.799 nms.py:31(build)
        2    0.122    0.061  186.607   93.303 kb.py:75(score)
        1    0.000    0.000   92.053   92.053 simple.py:29(hop)
        1    0.050    0.050   92.010   92.010 kb.py:156(forward)
       18    0.895    0.050    0.895    0.050 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.153    0.051    0.154    0.051 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.786 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.786  278.786 simple.py:52(score)
        3    0.000    0.000  278.782   92.927 profilehooks.py:257(new_fn)
        3    0.114    0.038  278.782   92.927 profilehooks.py:348(__call__)
        3    0.002    0.001  277.896   92.632 kb.py:122(neighbors)
        9  277.197   30.800  277.198   30.800 nms.py:31(build)
        2    0.089    0.044  185.286   92.643 kb.py:75(score)
        1    0.000    0.000   93.419   93.419 simple.py:29(hop)
        1    0.044    0.044   93.382   93.382 kb.py:156(forward)
       18    0.961    0.053    0.961    0.053 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.174    0.058    0.174    0.058 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 2296  3000  7688   380  8569  2206  6317
  11568  9776 12781   326  2186  8796 13017
   1959 13461  1789  8839   173  1227 13655
   8539  6576  3274  6346  4708  3517  8637
   7449  8550  1271   151  3472  5115 12415
  12384 13599  5749  2516 12495  9698  4753
   3893  1172   159  5727   637  9156 10502
  14428  7130   457  9423  3522  1102  8557
   9957  6248 14065 12204   713 11894  5335
   7382  1032 11619   464  4217  1351 12514
   9264   678  8604  2267  8821  3932 11743
   1269 11650  3526 11729 10258 12421  3907
  13597 11908  7376  3507  9335 12301  7692
  10492  8034  5472  2446 12073  9446  7952
   4371  1182]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.192 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.192  280.192 simple.py:52(score)
        3    0.000    0.000  280.188   93.396 profilehooks.py:257(new_fn)
        3    0.136    0.045  280.188   93.396 profilehooks.py:348(__call__)
        3    0.002    0.001  279.277   93.092 kb.py:122(neighbors)
        9  278.583   30.954  278.585   30.954 nms.py:31(build)
        2    0.120    0.060  186.877   93.438 kb.py:75(score)
        1    0.000    0.000   93.214   93.214 simple.py:29(hop)
        1    0.043    0.043   93.176   93.176 kb.py:156(forward)
       18    0.944    0.052    0.944    0.052 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.847 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.847  277.847 simple.py:52(score)
        3    0.000    0.000  277.843   92.614 profilehooks.py:257(new_fn)
        3    0.131    0.044  277.843   92.614 profilehooks.py:348(__call__)
        3    0.002    0.001  276.930   92.310 kb.py:122(neighbors)
        9  276.199   30.689  276.200   30.689 nms.py:31(build)
        2    0.111    0.055  185.724   92.862 kb.py:75(score)
        1    0.000    0.000   92.028   92.028 simple.py:29(hop)
        1    0.041    0.041   91.988   91.988 kb.py:156(forward)
       18    0.959    0.053    0.959    0.053 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.189    0.063    0.189    0.063 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 9465  9345  6967  9346  3439  6546  8957
   4107  1667  9737  3441  4150  4111  1632
   1633  1630  4113  1631  4108  1635  1634
   1613  1621  1624  1615  1623  4112  1614
   1617  1628  1626  1627  1619  1629  1625
   4331  1616  1618  1620  1612  4333  1622
   6553  8533  7530  7348  1641  6603  6180
   6786  5643  6677  5557  7398  9181  7184
   7415  8375  8713 12483 12312 11517  7691
   3661 10076  9124  8101  8105  9508  9974
   8087 12754  8330  7823  8250  8907  8104
   8530  7186  7874 12815  8248  9106  6626
   9307 14338  7727  9806 12962 12673  8082
  11538  9629  7677  7873  8247  9983 10026
   7148  6565]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.491 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.491  278.491 simple.py:52(score)
        3    0.000    0.000  278.486   92.829 profilehooks.py:257(new_fn)
        3    0.127    0.042  278.486   92.829 profilehooks.py:348(__call__)
        3    0.002    0.001  277.616   92.539 kb.py:122(neighbors)
        9  277.024   30.780  277.026   30.781 nms.py:31(build)
        2    0.109    0.054  184.894   92.447 kb.py:75(score)
        1    0.000    0.000   93.503   93.503 simple.py:29(hop)
        1    0.042    0.042   93.465   93.465 kb.py:156(forward)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.227    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.224    0.017 sparse.py:123(forward)
        3    0.000    0.000    0.223    0.074 kb.py:68(generate_facts)
       13    0.000    0.000    0.223    0.017 functional.py:1774(embedding)
       13    0.223    0.017    0.223    0.017 {built-in method embedding}
        3    0.045    0.015    0.046    0.015 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.001 base.py:142(forward)
        2    0.000    0.000    0.003    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 't' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.057 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.057  279.057 simple.py:52(score)
        3    0.000    0.000  279.053   93.018 profilehooks.py:257(new_fn)
        3    0.132    0.044  279.053   93.018 profilehooks.py:348(__call__)
        3    0.002    0.001  278.268   92.756 kb.py:122(neighbors)
        9  277.677   30.853  277.679   30.853 nms.py:31(build)
        2    0.118    0.059  186.242   93.121 kb.py:75(score)
        1    0.000    0.000   92.717   92.717 simple.py:29(hop)
        1    0.047    0.047   92.680   92.680 kb.py:156(forward)
       18    0.799    0.044    0.799    0.044 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.073    0.024    0.074    0.025 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[   50  4695  2082 10704   675 14103  4697
   5405  7172 11827  1454 10467 11029 14441
   3562  2374 11030  3465  4168 11689 11700
   5496 11953 10221  6080 12961  1293 11754
   1497  8145 11685  4484  6442   752 14119
   8885  6600  2978  4828  4192  8403  1463
   4583 13223  9308 12290 10673  9571 13939
   1823 12526  7141  4922 11800 11445 11691
  11778 12687  4829 11944 10865  4073 10981
   7533  5001  1338  8214 11777  9431 14443
   1423    52  7992  1379 13833 12210  3391
  10592  1025  5671 13169  5673  9611  9213
  12056  7368 13317 10685  9162    60  9904
  10957   554  3639 11404    57  6783 11100
   8972    53]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.787 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.787  278.787 simple.py:52(score)
        3    0.000    0.000  278.784   92.928 profilehooks.py:257(new_fn)
        3    0.137    0.046  278.784   92.928 profilehooks.py:348(__call__)
        3    0.001    0.000  277.966   92.655 kb.py:122(neighbors)
        9  277.354   30.817  277.356   30.817 nms.py:31(build)
        2    0.085    0.043  186.216   93.108 kb.py:75(score)
        1    0.000    0.000   92.491   92.491 simple.py:29(hop)
        1    0.077    0.077   92.430   92.430 kb.py:156(forward)
       18    0.839    0.047    0.839    0.047 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.085    0.028    0.085    0.028 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 263.557 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  263.557  263.557 simple.py:52(score)
        3    0.000    0.000  263.554   87.851 profilehooks.py:257(new_fn)
        3    0.109    0.036  263.554   87.851 profilehooks.py:348(__call__)
        3    0.001    0.000  262.888   87.629 kb.py:122(neighbors)
        9  262.337   29.149  262.339   29.149 nms.py:31(build)
        2    0.082    0.041  180.774   90.387 kb.py:75(score)
        1    0.000    0.000   82.704   82.704 simple.py:29(hop)
        1    0.035    0.035   82.671   82.671 kb.py:156(forward)
       18    0.747    0.041    0.747    0.041 {built-in method cat}
    18/15    0.001    0.000    0.178    0.012 module.py:715(_call_impl)
       13    0.000    0.000    0.175    0.013 sparse.py:123(forward)
        3    0.000    0.000    0.175    0.058 kb.py:68(generate_facts)
       13    0.000    0.000    0.175    0.013 functional.py:1774(embedding)
       13    0.175    0.013    0.175    0.013 {built-in method embedding}
        3    0.057    0.019    0.057    0.019 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method numpy.array}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 3790  9850  2167 11494  5760   815 12332
  12496  1930  4291 13304  9874 13352  7938
   2473  9823   231  1236  5375 12500  8419
   9187 13224 14466  9861  3233 10766  9842
   4116 13455  5204  4213 11783 11217  2394
  12762  1436  7881  2132  9878  2553  2676
   2336 10527  4648 12516  2075  1218 12866
  10679  6633 13441  3238  5061  2211 13471
  13596  9846 14462  1764   468   715   227
   9829  2395  4666  1678  9849  2316  1989
   1821  2254  5508  6502   144  1377 12443
  12394  1816  2364 13386  5770  2120   859
   3832  1287  4231  7428  2675    55  4344
  14459  5414  2909  1815  9890 14480  3020
   9830   478]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.245 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.245  278.245 simple.py:52(score)
        3    0.000    0.000  278.242   92.747 profilehooks.py:257(new_fn)
        3    0.116    0.039  278.242   92.747 profilehooks.py:348(__call__)
        3    0.001    0.000  277.464   92.488 kb.py:122(neighbors)
        9  276.732   30.748  276.733   30.748 nms.py:31(build)
        2    0.091    0.045  185.425   92.713 kb.py:75(score)
        1    0.000    0.000   92.740   92.740 simple.py:29(hop)
        1    0.042    0.042   92.701   92.701 kb.py:156(forward)
       18    0.847    0.047    0.847    0.047 {built-in method cat}
    18/15    0.001    0.000    0.227    0.015 module.py:715(_call_impl)
        3    0.000    0.000    0.224    0.075 kb.py:68(generate_facts)
       13    0.000    0.000    0.224    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.224    0.017 functional.py:1774(embedding)
       13    0.224    0.017    0.224    0.017 {built-in method embedding}
        3    0.178    0.059    0.179    0.060 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.905 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.905  277.905 simple.py:52(score)
        3    0.000    0.000  277.902   92.634 profilehooks.py:257(new_fn)
        3    0.130    0.043  277.902   92.634 profilehooks.py:348(__call__)
        3    0.001    0.000  277.133   92.378 kb.py:122(neighbors)
        9  276.525   30.725  276.526   30.725 nms.py:31(build)
        2    0.083    0.041  184.985   92.493 kb.py:75(score)
        1    0.000    0.000   92.841   92.841 simple.py:29(hop)
        1    0.089    0.089   92.787   92.787 kb.py:156(forward)
       18    0.781    0.043    0.781    0.043 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
       13    0.191    0.015    0.191    0.015 {built-in method embedding}
        3    0.091    0.030    0.091    0.030 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 7564  5933  7588  2800  1941  2845   960
   7759  5920  2916   575 12390  4554   664
  14010  2714  6397  2757  4739   230 13948
   9931  8831   189  9775  2763   959  4909
   2859  3120  2477  4069 12165   914 14100
   7324  1955 14418   611  2151  4800  1268
   2707 13442 10005  6595  2826  1009  7063
   2875  2636  9209  1033  2002  1953  2817
    693 10493  2866  4226  2776 13446  2825
   2029  3676  2902  2824  4714  5295  4431
   2652  2708  7097  4183  2350  1926  5198
   7256  6712 12976  6072  2750  4203  2814
   5381  7135  8838  1579  2308  2886  3077
   5298 10615 14006 12061  2704  5426   710
  10796  6181]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.646 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.646  277.646 simple.py:52(score)
        3    0.000    0.000  277.643   92.548 profilehooks.py:257(new_fn)
        3    0.130    0.043  277.643   92.548 profilehooks.py:348(__call__)
        3    0.002    0.001  276.759   92.253 kb.py:122(neighbors)
        9  276.142   30.682  276.144   30.683 nms.py:31(build)
        2    0.114    0.057  184.955   92.478 kb.py:75(score)
        1    0.000    0.000   92.597   92.597 simple.py:29(hop)
        1    0.042    0.042   92.558   92.558 kb.py:156(forward)
       18    0.889    0.049    0.889    0.049 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.220    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.219    0.017 functional.py:1774(embedding)
       13    0.219    0.017    0.219    0.017 {built-in method embedding}
        3    0.000    0.000    0.219    0.073 kb.py:68(generate_facts)
        3    0.091    0.030    0.092    0.031 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.633 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.633  279.633 simple.py:52(score)
        3    0.000    0.000  279.629   93.210 profilehooks.py:257(new_fn)
        3    0.149    0.050  279.629   93.210 profilehooks.py:348(__call__)
        3    0.002    0.001  278.727   92.909 kb.py:122(neighbors)
        9  278.123   30.903  278.124   30.903 nms.py:31(build)
        2    0.120    0.060  185.743   92.872 kb.py:75(score)
        1    0.000    0.000   93.786   93.786 simple.py:29(hop)
        1    0.043    0.043   93.736   93.736 kb.py:156(forward)
       18    0.897    0.050    0.897    0.050 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
        3    0.000    0.000    0.218    0.073 kb.py:68(generate_facts)
       13    0.000    0.000    0.218    0.017 functional.py:1774(embedding)
       13    0.218    0.017    0.218    0.017 {built-in method embedding}
        3    0.063    0.021    0.063    0.021 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  191  1309  1766  1424  9873  1267  3887
   9007  9004  4369  5222   469  1310  1685
  11926 10540  6872  3031  1127  1124  9897
   5234  9872  9965 13334  2427 12374  9870
  11982  6519  9939 11929   321  5473  9813
   3480  4711  7250  6120 10415 14052  8954
   1598  7409  3281  5656 10923  5273   730
  11382 10011 10787  8107  2654   643  6989
  11144  3030  5769 10513   214  6769  5626
   6767  3939  4923  4606 10565 11798  9854
   4721  6129  6033  7038  6425   384  6115
   8191 10154 10150  4373  9999  8314  6073
   6954 10853  1255  6927 12109  5732  6905
   6608  9815  6077  8691  2209  3174   154
   2331 11393]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.476 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.476  277.476 simple.py:52(score)
        3    0.000    0.000  277.472   92.491 profilehooks.py:257(new_fn)
        3    0.115    0.038  277.472   92.491 profilehooks.py:348(__call__)
        3    0.002    0.001  276.673   92.224 kb.py:122(neighbors)
        9  276.064   30.674  276.066   30.674 nms.py:31(build)
        2    0.086    0.043  185.754   92.877 kb.py:75(score)
        1    0.000    0.000   91.641   91.641 simple.py:29(hop)
        1    0.041    0.041   91.603   91.603 kb.py:156(forward)
       18    0.876    0.049    0.876    0.049 {built-in method cat}
    18/15    0.001    0.000    0.210    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.207    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.207    0.069 kb.py:68(generate_facts)
       13    0.000    0.000    0.207    0.016 functional.py:1774(embedding)
       13    0.207    0.016    0.207    0.016 {built-in method embedding}
        3    0.069    0.023    0.070    0.023 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.727 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.727  279.727 simple.py:52(score)
        3    0.000    0.000  279.724   93.241 profilehooks.py:257(new_fn)
        3    0.114    0.038  279.724   93.241 profilehooks.py:348(__call__)
        3    0.001    0.000  278.973   92.991 kb.py:122(neighbors)
        9  278.257   30.917  278.258   30.918 nms.py:31(build)
        2    0.085    0.042  186.605   93.302 kb.py:75(score)
        1    0.000    0.000   93.043   93.043 simple.py:29(hop)
        1    0.043    0.043   93.005   93.005 kb.py:156(forward)
       18    0.874    0.049    0.874    0.049 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.152    0.051    0.152    0.051 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


[[ 3853 12412 11304  1654   623 10109  6114
   1571  2246   993  9010 12809   719  7255
   7337  1005   203  1824  3074   580   622
  14432  6452  1003  3924   772 13647   179
  10141   199  8820 13350  8735  5402  7453
   8785  5069  9621  7621 14015 13102  3536
   7245  1401  8261  1004 10222  2765 10254
   9696  1176  1903  2118  8274   943  3023
   1153  3884  9723 11041  6366 13000 10843
   8934  1006   769 10511  8943  8649 11582
   1001  8344  7423  4946   655  9042  5378
   2033  5205 13567  8902  1373 13872   773
  14422  3937 12583  9915  2521  4654  4874
   6723  1017 13967    95 12050 14397  1590
   4717  1475]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.395 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.395  277.395 simple.py:52(score)
        3    0.000    0.000  277.382   92.461 profilehooks.py:257(new_fn)
        3    0.143    0.048  277.382   92.461 profilehooks.py:348(__call__)
        3    0.001    0.000  276.555   92.185 kb.py:122(neighbors)
        9  275.983   30.665  275.984   30.665 nms.py:31(build)
        2    0.120    0.060  184.471   92.235 kb.py:75(score)
        1    0.000    0.000   92.812   92.812 simple.py:29(hop)
        1    0.041    0.041   92.769   92.769 kb.py:156(forward)
       18    0.815    0.045    0.815    0.045 {built-in method cat}
    18/15    0.001    0.000    0.233    0.016 module.py:715(_call_impl)
        3    0.000    0.000    0.221    0.074 kb.py:68(generate_facts)
       13    0.000    0.000    0.221    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.221    0.017 functional.py:1774(embedding)
       13    0.221    0.017    0.221    0.017 {built-in method embedding}
        3    0.047    0.016    0.047    0.016 nms.py:51(query)
        2    0.000    0.000    0.011    0.005 base.py:142(forward)
        2    0.000    0.000    0.011    0.005 base.py:143(<listcomp>)
        3    0.000    0.000    0.010    0.003 linear.py:92(forward)
        3    0.000    0.000    0.010    0.003 functional.py:1669(linear)
        3    0.010    0.003    0.010    0.003 {built-in method addmm}
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.831 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.831  283.831 simple.py:52(score)
        3    0.000    0.000  283.828   94.609 profilehooks.py:257(new_fn)
        3    0.150    0.050  283.828   94.609 profilehooks.py:348(__call__)
        3    0.002    0.001  282.687   94.229 kb.py:122(neighbors)
        9  281.880   31.320  281.882   31.320 nms.py:31(build)
        2    0.119    0.060  186.356   93.178 kb.py:75(score)
        1    0.000    0.000   97.360   97.360 simple.py:29(hop)
        1    0.040    0.040   97.322   97.322 kb.py:156(forward)
       18    1.233    0.069    1.233    0.069 {built-in method cat}
    18/15    0.001    0.000    0.252    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.250    0.019 sparse.py:123(forward)
        3    0.000    0.000    0.249    0.083 kb.py:68(generate_facts)
       13    0.000    0.000    0.249    0.019 functional.py:1774(embedding)
       13    0.249    0.019    0.249    0.019 {built-in method embedding}
        3    0.139    0.046    0.140    0.047 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 3016  5031  2372 11690  2230 13442  5945
   1781  6595   178  4939  5920  2800  7564
   7593  2664   959  2477  8922  2888   988
   8186  1484   205   189  6147   230   577
   2850 12165 10926  7063  6476  1964  4739
   1686  2195  2710  2859  3077 14100  1579
   1388  5426   710   801  2339 10111  2727
   3120  4092 14418  6050  1222   690 14006
    226  7097  1202   316  2707  2827  2501
   2935  8051  6226  2916  2757  2845   654
   9209  5751   864  2714  2728 10858  6072
   1985  2817 12440  3778  1739  2156  2724
   2708  1470   652 12061  2344  6704 14010
   3485  5198 10796 11000   188 10615  1033
   1662 13535]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.402 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  281.402  281.402 simple.py:52(score)
        3    0.000    0.000  281.399   93.800 profilehooks.py:257(new_fn)
        3    0.134    0.045  281.399   93.800 profilehooks.py:348(__call__)
        3    0.002    0.001  280.558   93.519 kb.py:122(neighbors)
        9  279.947   31.105  279.949   31.105 nms.py:31(build)
        2    0.115    0.058  188.529   94.264 kb.py:75(score)
        1    0.000    0.000   92.775   92.775 simple.py:29(hop)
        1    0.041    0.041   92.736   92.736 kb.py:156(forward)
       18    0.883    0.049    0.883    0.049 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.076    0.025    0.077    0.026 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.274 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.274  283.274 simple.py:52(score)
        3    0.000    0.000  283.270   94.423 profilehooks.py:257(new_fn)
        3    0.136    0.045  283.270   94.423 profilehooks.py:348(__call__)
        3    0.002    0.001  282.425   94.142 kb.py:122(neighbors)
        9  281.826   31.314  281.828   31.314 nms.py:31(build)
        2    0.116    0.058  189.028   94.514 kb.py:75(score)
        1    0.000    0.000   94.144   94.144 simple.py:29(hop)
        1    0.044    0.044   94.106   94.106 kb.py:156(forward)
       18    0.875    0.049    0.875    0.049 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.068    0.023    0.068    0.023 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 5781 12228  1580 12997 12563 12549 13064
  11394 11764 12883 13484 12826   443  2302
  12395 12890  2019  8442  2436  3119 11717
  13509 10454  2823  1028 12909 11291    82
   4418   901  9766  3160 12971  7949 13617
   7249 11864    41 12792    96  3898 11842
   3911 11949  3397  1490  3959   805 12784
   3955  9994 12137  3142 13618 11697  9395
  11719 12216 10538  1342  7248   597   594
   6678 13553  7247 12205 12139  7640  4105
  13601 12872  7944  6835 13430  2802  8978
  11033 13337 11733 12523 12385  7947   202
   7159  3104  6297  1948  2555 10536   688
  13609  3279   150 13748  3957  7932  8672
   1771 13258]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.739 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.739  280.739 simple.py:52(score)
        3    0.000    0.000  280.735   93.578 profilehooks.py:257(new_fn)
        3    0.135    0.045  280.735   93.578 profilehooks.py:348(__call__)
        3    0.002    0.001  279.865   93.288 kb.py:122(neighbors)
        9  279.194   31.022  279.196   31.022 nms.py:31(build)
        2    0.116    0.058  187.935   93.968 kb.py:75(score)
        1    0.000    0.000   92.703   92.703 simple.py:29(hop)
        1    0.043    0.043   92.665   92.665 kb.py:156(forward)
       18    0.929    0.052    0.929    0.052 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.186    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.185    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
       13    0.185    0.014    0.185    0.014 {built-in method embedding}
        3    0.116    0.039    0.116    0.039 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.247 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.247  282.247 simple.py:52(score)
        3    0.000    0.000  282.243   94.081 profilehooks.py:257(new_fn)
        3    0.133    0.044  282.243   94.081 profilehooks.py:348(__call__)
        3    0.002    0.001  281.432   93.811 kb.py:122(neighbors)
        9  280.669   31.185  280.671   31.186 nms.py:31(build)
        2    0.111    0.055  188.296   94.148 kb.py:75(score)
        1    0.000    0.000   93.852   93.852 simple.py:29(hop)
        1    0.041    0.041   93.814   93.814 kb.py:156(forward)
       18    0.882    0.049    0.882    0.049 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
        3    0.196    0.065    0.197    0.066 nms.py:51(query)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 4829  9611 10467  4828    50 11029  4695
  11649  7726 11700  8885  8475 10673 11100
  12056 14441  3628  8403 11685 14103 11778
   9828  9213  6922  4922 10981  6600  1497
   6442  1454  7172 11691  4877  6925  6554
  11754 13223  5496  1293  5671  5673  6904
   1147  2978 11953  4697  7141  5405 10704
   8577 12290 11030  2082  3562 13317  4073
   5507  3541 11827  2374  8214 10221  3511
   1423  5494 11689  4827 11958  8914  1835
   4414  9308  6580  7010  3354 14086   759
   3991  5493  1025  3424  1168  5495 14119
   4484  7368 11490  9798 10685  9162 11800
   9525  1834   559  3796 13833  5130  1823
  13939  3819]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.941 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.941  279.941 simple.py:52(score)
        3    0.000    0.000  279.937   93.312 profilehooks.py:257(new_fn)
        3    0.133    0.044  279.937   93.312 profilehooks.py:348(__call__)
        3    0.002    0.001  279.112   93.037 kb.py:122(neighbors)
        9  278.439   30.938  278.441   30.938 nms.py:31(build)
        2    0.113    0.057  185.602   92.801 kb.py:75(score)
        1    0.000    0.000   94.241   94.241 simple.py:29(hop)
        1    0.043    0.043   94.202   94.202 kb.py:156(forward)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.593 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  281.593  281.593 simple.py:52(score)
        3    0.000    0.000  281.590   93.863 profilehooks.py:257(new_fn)
        3    0.141    0.047  281.590   93.863 profilehooks.py:348(__call__)
        3    0.002    0.001  280.756   93.585 kb.py:122(neighbors)
        9  280.081   31.120  280.083   31.120 nms.py:31(build)
        2    0.123    0.061  187.751   93.876 kb.py:75(score)
        1    0.000    0.000   93.738   93.738 simple.py:29(hop)
        1    0.041    0.041   93.697   93.697 kb.py:156(forward)
       18    0.852    0.047    0.852    0.047 {built-in method cat}
    18/15    0.001    0.000    0.194    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.144    0.048    0.145    0.048 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[11680 12777  4920  9589 12615 12489 11653
   9687 12477 10822  9774 10964  6842 12485
   5170  3672  8697 11182 11444  6428 11834
   4090 12410 10473  5189 11511  9656 13100
  12925 10229  7053  7122 10662 12810 12476
  12619 10481  8667  7298  4212  6379 12618
  12645  5244 11102 12648  6315  9946 11411
  11752 12650  9387 12367  8780  7231  7126
  12684 10676 11808  8479  6621  9327  5139
   6130 12166 11103  3841  3355 11413 11052
   5731  8140 12664  9958  7827  9260  6773
   9751 12168  6810 13026 13316  4359  5553
  10904 12674  6990  6902 10646  8470  9230
  10670 12459 10042 10166 10991 11399 12703
  11415 12527]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.497 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.497  279.497 simple.py:52(score)
        3    0.000    0.000  279.494   93.165 profilehooks.py:257(new_fn)
        3    0.115    0.038  279.494   93.165 profilehooks.py:348(__call__)
        3    0.002    0.001  278.723   92.908 kb.py:122(neighbors)
        9  278.036   30.893  278.037   30.893 nms.py:31(build)
        2    0.087    0.043  186.055   93.028 kb.py:75(score)
        1    0.000    0.000   93.361   93.361 simple.py:29(hop)
        1    0.041    0.041   93.323   93.323 kb.py:156(forward)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.146    0.049    0.146    0.049 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.813 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.813  280.813 simple.py:52(score)
        3    0.000    0.000  280.809   93.603 profilehooks.py:257(new_fn)
        3    0.127    0.042  280.809   93.603 profilehooks.py:348(__call__)
        3    0.002    0.001  279.941   93.314 kb.py:122(neighbors)
        9  279.188   31.021  279.190   31.021 nms.py:31(build)
        2    0.109    0.055  187.149   93.575 kb.py:75(score)
        1    0.000    0.000   93.571   93.571 simple.py:29(hop)
        1    0.041    0.041   93.533   93.533 kb.py:156(forward)
       18    0.935    0.052    0.935    0.052 {built-in method cat}
        3    0.199    0.066    0.199    0.066 nms.py:51(query)
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.194    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[    6 14373   274 10745 14519   283 13457
  10743  8718 14511 14075 10744 14322 14138
  11903   261 14139 12092 14490 14319 14483
  14512 12261 12142 14292 14318 14225 10748
  12481 14253 14074 12254 14184 14526  1508
     20 13660 12264 14224 13159 14076   279
  14420 10741 14144 11639 14215 14188 14368
      7 10028   249 14527 14529 14259 14485
    260  7243 14385 14300 14077   263 13208
    253     2 14367  3093 14444    17 14247
  10725 14254  9363  1688  6805 13203  5032
   2616 14310 12789 11720 11917 12389  1480
  14311 11269 14326 10958 14251 14252 14331
  10750 12238 14217 14093 13400  9762 14532
  12959 12818]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.759 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.759  279.759 simple.py:52(score)
        3    0.000    0.000  279.755   93.252 profilehooks.py:257(new_fn)
        3    0.127    0.042  279.755   93.252 profilehooks.py:348(__call__)
        3    0.002    0.001  278.826   92.942 kb.py:122(neighbors)
        9  278.116   30.902  278.118   30.902 nms.py:31(build)
        2    0.108    0.054  187.285   93.643 kb.py:75(score)
        1    0.000    0.000   92.381   92.381 simple.py:29(hop)
        1    0.043    0.043   92.343   92.343 kb.py:156(forward)
       18    0.972    0.054    0.972    0.054 {built-in method cat}
    18/15    0.001    0.000    0.204    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.201    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.201    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
       13    0.201    0.015    0.201    0.015 {built-in method embedding}
        3    0.173    0.058    0.174    0.058 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.229 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.229  282.229 simple.py:52(score)
        3    0.000    0.000  282.225   94.075 profilehooks.py:257(new_fn)
        3    0.141    0.047  282.225   94.075 profilehooks.py:348(__call__)
        3    0.002    0.001  281.375   93.792 kb.py:122(neighbors)
        9  280.690   31.188  280.692   31.188 nms.py:31(build)
        2    0.121    0.060  188.048   94.024 kb.py:75(score)
        1    0.000    0.000   94.078   94.078 simple.py:29(hop)
        1    0.045    0.045   94.035   94.035 kb.py:156(forward)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.116    0.039    0.117    0.039 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[14396 11498 11746  1485  5363 10176 10561
   8609  9794   629  8094  5970   657  1282
   6657  6258 13614 13513  4498   742  1130
   4840  8160   721  9472  8336  6336    33
   5080  5291 10555 10610  1561   513  9839
    775  9572  4555  5123  8911   444  9197
   5199  9984   105 12327  1500   183 12607
   8320   627  8861 11757  5868 13063  3708
  12463  8173  3247  8935  1591 10148 12050
  12798 14433 14397  2026  3243  5145 10233
  12692 13546  9158  8728  5782   553 13422
  12583   786   566 11769 14422  8395  4075
   4704  9532  9912  6723  4874  3941  4135
  11497 13109  3055  8521  1681  2454 12679
   2897  7596]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.467 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.467  280.467 simple.py:52(score)
        3    0.000    0.000  280.463   93.488 profilehooks.py:257(new_fn)
        3    0.134    0.045  280.463   93.488 profilehooks.py:348(__call__)
        3    0.002    0.001  279.596   93.199 kb.py:122(neighbors)
        9  278.900   30.989  278.902   30.989 nms.py:31(build)
        2    0.103    0.051  187.796   93.898 kb.py:75(score)
        1    0.000    0.000   92.580   92.580 simple.py:29(hop)
        1    0.054    0.054   92.534   92.534 kb.py:156(forward)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.157    0.052    0.158    0.053 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.965 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.965  279.965 simple.py:52(score)
        3    0.000    0.000  279.961   93.320 profilehooks.py:257(new_fn)
        3    0.131    0.044  279.961   93.320 profilehooks.py:348(__call__)
        3    0.002    0.001  279.141   93.047 kb.py:122(neighbors)
        9  278.402   30.934  278.403   30.934 nms.py:31(build)
        2    0.089    0.044  185.399   92.700 kb.py:75(score)
        1    0.000    0.000   94.482   94.482 simple.py:29(hop)
        1    0.065    0.065   94.432   94.432 kb.py:156(forward)
       18    0.875    0.049    0.875    0.049 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
        3    0.192    0.064    0.193    0.064 nms.py:51(query)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 2730  2835   186 11916  7967  2711  6064
  13535  5228 11996  3448  2275  2862 11227
   2892 13459 13157  2492  4460  2096  8513
   6226  2758  2805  2914 12944 12855  6966
   6050   870  8916 11514  2731  2189   196
   2934  2722  7012  2848  6183   987  2741
   1983 11654  2872  9989  3268  2230   166
  12847  2624  2386  2712 13355  6817   187
   7479  3431   881  7271   691  2720 10096
   3056   731  2621    45 13490  1929  2864
   2691  2927  2752 10885  2811  1905   328
   2905   609  2827 12111  6316 10346   617
   2178 12502  4936 11859   188  2688   206
    233 13937  9759  2745  4157 12862 13343
  10318   229]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.516 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.516  282.516 simple.py:52(score)
        3    0.000    0.000  282.512   94.171 profilehooks.py:257(new_fn)
        3    0.143    0.048  282.512   94.171 profilehooks.py:348(__call__)
        3    0.002    0.001  281.620   93.873 kb.py:122(neighbors)
        9  280.929   31.214  280.930   31.214 nms.py:31(build)
        2    0.087    0.043  188.046   94.023 kb.py:75(score)
        1    0.000    0.000   94.390   94.390 simple.py:29(hop)
        1    0.074    0.074   94.324   94.324 kb.py:156(forward)
       18    0.903    0.050    0.903    0.050 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.164    0.055    0.164    0.055 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.747 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.747  282.747 simple.py:52(score)
        3    0.000    0.000  282.744   94.248 profilehooks.py:257(new_fn)
        3    0.116    0.039  282.744   94.248 profilehooks.py:348(__call__)
        3    0.002    0.001  281.920   93.973 kb.py:122(neighbors)
        9  281.182   31.242  281.184   31.243 nms.py:31(build)
        2    0.086    0.043  188.885   94.442 kb.py:75(score)
        1    0.000    0.000   93.783   93.783 simple.py:29(hop)
        1    0.045    0.045   93.744   93.744 kb.py:156(forward)
       18    0.937    0.052    0.937    0.052 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.168    0.056    0.169    0.056 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[  653 11913  4816  2258  5239   735 12411
    163   530  7454 13960  1549 10351   472
   6034 11257 11106  4455   119   586 11101
   5130 13605 11254 13105  5841  2558  2659
   8802   198  4014 13572  4132  1854 12577
   8553  2248   185  5791 12711   634  1979
   4665  6901 12702  1526  5526  7007   408
   8362   137  1300 13085  7042  4202  5666
   2405   682  4216  7836  9730 11315  3967
   5915  1347  2078  5921  3280   293  1523
   7027  5812  5092   375 11346  5112  2045
   4013  6119 13198  6044  7431  3896  4364
   5305  3381 14035  7349   506  7034 12534
   5443  6950  5417  2619  5261  5419 10033
   8618  6607]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.881 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.881  280.881 simple.py:52(score)
        3    0.000    0.000  280.877   93.626 profilehooks.py:257(new_fn)
        3    0.129    0.043  280.877   93.626 profilehooks.py:348(__call__)
        3    0.002    0.001  279.988   93.329 kb.py:122(neighbors)
        9  279.305   31.034  279.307   31.034 nms.py:31(build)
        2    0.105    0.052  187.046   93.523 kb.py:75(score)
        1    0.000    0.000   93.741   93.741 simple.py:29(hop)
        1    0.045    0.045   93.702   93.702 kb.py:156(forward)
       18    0.924    0.051    0.924    0.051 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.191    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.164    0.055    0.165    0.055 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.789 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.789  282.789 simple.py:52(score)
        3    0.000    0.000  282.785   94.262 profilehooks.py:257(new_fn)
        3    0.142    0.047  282.785   94.262 profilehooks.py:348(__call__)
        3    0.002    0.001  281.961   93.987 kb.py:122(neighbors)
        9  281.252   31.250  281.253   31.250 nms.py:31(build)
        2    0.119    0.060  188.368   94.184 kb.py:75(score)
        1    0.000    0.000   94.314   94.314 simple.py:29(hop)
        1    0.042    0.042   94.275   94.275 kb.py:156(forward)
       18    0.851    0.047    0.851    0.047 {built-in method cat}
    18/15    0.001    0.000    0.206    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.203    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.202    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.202    0.067 kb.py:68(generate_facts)
       13    0.202    0.016    0.202    0.016 {built-in method embedding}
        3    0.161    0.054    0.162    0.054 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 8787  6715  8474  6490  7417  7156  7123
  10159  7539  8717  4388  7538 11640  3218
   8240 12093  3829  9911  7100  5767  9727
   9685 10963  5492  5211  6561  7703 10574
   2828  8899  7606  4869 10620  5998  6597
   1943  3928  8565 10224 11594  9739  4141
   8453  6484  7216  2028  9910  7605  4839
  10157  9454  8566 11022  2377 11766  6281
   9950  5632  5578  9796 11626 11589  4806
   6337  9933  9686 12662  4826  8755  4742
   9453    59  7115 12700  7802 11162  9389
   7639 12997  9293  7065  4701  7463  9893
   4477  3915  8354  7495  7638  3354  6469
   9456  8469  3392  1755 11481  8451  5698
   6977 10621]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.645 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.645  280.645 simple.py:52(score)
        3    0.000    0.000  280.641   93.547 profilehooks.py:257(new_fn)
        3    0.137    0.046  280.641   93.547 profilehooks.py:348(__call__)
        3    0.002    0.001  279.770   93.257 kb.py:122(neighbors)
        9  279.073   31.008  279.075   31.008 nms.py:31(build)
        2    0.096    0.048  187.202   93.601 kb.py:75(score)
        1    0.000    0.000   93.348   93.348 simple.py:29(hop)
        1    0.056    0.056   93.301   93.301 kb.py:156(forward)
       18    0.921    0.051    0.921    0.051 {built-in method cat}
    18/15    0.001    0.000    0.208    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
       13    0.000    0.000    0.203    0.016 functional.py:1774(embedding)
       13    0.203    0.016    0.203    0.016 {built-in method embedding}
        3    0.138    0.046    0.139    0.046 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.002 base.py:142(forward)
        2    0.000    0.000    0.003    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.003    0.001 linear.py:92(forward)
        3    0.000    0.000    0.003    0.001 functional.py:1669(linear)
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.804 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  281.804  281.804 simple.py:52(score)
        3    0.000    0.000  281.801   93.934 profilehooks.py:257(new_fn)
        3    0.116    0.039  281.801   93.934 profilehooks.py:348(__call__)
        3    0.002    0.001  281.036   93.679 kb.py:122(neighbors)
        9  280.351   31.150  280.353   31.150 nms.py:31(build)
        2    0.088    0.044  187.163   93.581 kb.py:75(score)
        1    0.000    0.000   94.561   94.561 simple.py:29(hop)
        1    0.042    0.042   94.522   94.522 kb.py:156(forward)
       18    0.843    0.047    0.843    0.047 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.154    0.051    0.154    0.051 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[14433  8934 13109 12529  8094 13513  2026
   5868 14422 12050 12679  1130  8344 12412
   9014  5291   657  5199  6366  9010   775
    444  4498 11041 10148   622 12463  6723
   8935 13614  9696  3937  9915  9984  1282
    513 14015    33 11757  5080  8160   183
    721  8609 11769 12583 10843  1499  1485
    627  3074 11746  2897   810  9794 14397
    199  5145  6452   773  3941  1475  8320
  10511  5970  9572  5745  4840  1500  5363
   4874 12473  3515   629   655  4654 12798
    742  9621  8911  8861    95  8336 10561
  13063 13546   105 10176  8173 11498  9472
   3708  6258   553  1001  4592  8649  3247
    769  6336]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.016 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.016  284.016 simple.py:52(score)
        3    0.000    0.000  284.012   94.671 profilehooks.py:257(new_fn)
        3    0.143    0.048  284.012   94.671 profilehooks.py:348(__call__)
        3    0.002    0.001  283.161   94.387 kb.py:122(neighbors)
        9  282.441   31.382  282.442   31.382 nms.py:31(build)
        2    0.115    0.058  188.845   94.423 kb.py:75(score)
        1    0.000    0.000   95.063   95.063 simple.py:29(hop)
        1    0.044    0.044   95.024   95.024 kb.py:156(forward)
       18    0.892    0.050    0.892    0.050 {built-in method cat}
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.194    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.168    0.056    0.169    0.056 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.622 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.622  282.622 simple.py:52(score)
        3    0.000    0.000  282.618   94.206 profilehooks.py:257(new_fn)
        3    0.142    0.047  282.618   94.206 profilehooks.py:348(__call__)
        3    0.002    0.001  281.785   93.928 kb.py:122(neighbors)
        9  281.133   31.237  281.134   31.237 nms.py:31(build)
        2    0.113    0.056  188.546   94.273 kb.py:75(score)
        1    0.000    0.000   93.969   93.969 simple.py:29(hop)
        1    0.041    0.041   93.930   93.930 kb.py:156(forward)
       18    0.855    0.047    0.855    0.047 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.186    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.135    0.045    0.136    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 6128   166   609  8642  2275  6966  2758
  12164  2492  3143 12913  5962 12685  6249
  11343 10061  6066  9697 11227  9636  8004
   1141 11996 13619  8535 14358  2893  9981
   6899  8507  6831  1427  9006  8916 11654
  13449  7804  8850  6127  8952  9402  8339
   8513  9357  6221  5761 13535  9627  5226
  11159  7045  9604  6988  2835    25  5764
   8073  6577  7795 10032 12847  6231  2811
   6858  6642  3899  9337  3575  5357 11156
  11699  7206  8294  5823  9914  9040 12732
   6049  5857  9295   407  5775 12695   809
    462  7695  2672  1878  6462  6261  6210
   9580 13409  2678  3010  8843  1679   918
  11420  5876]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.201 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.201  282.201 simple.py:52(score)
        3    0.000    0.000  282.198   94.066 profilehooks.py:257(new_fn)
        3    0.137    0.046  282.198   94.066 profilehooks.py:348(__call__)
        3    0.002    0.001  281.228   93.743 kb.py:122(neighbors)
        9  280.587   31.176  280.588   31.176 nms.py:31(build)
        2    0.084    0.042  188.721   94.360 kb.py:75(score)
        1    0.000    0.000   93.400   93.400 simple.py:29(hop)
        1    0.075    0.075   93.341   93.341 kb.py:156(forward)
       18    0.991    0.055    0.991    0.055 {built-in method cat}
    18/15    0.001    0.000    0.210    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.207    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.207    0.069 kb.py:68(generate_facts)
       13    0.000    0.000    0.207    0.016 functional.py:1774(embedding)
       13    0.207    0.016    0.207    0.016 {built-in method embedding}
        3    0.103    0.034    0.103    0.034 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.324 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.324  284.324 simple.py:52(score)
        3    0.000    0.000  284.320   94.773 profilehooks.py:257(new_fn)
        3    0.138    0.046  284.320   94.773 profilehooks.py:348(__call__)
        3    0.002    0.001  283.431   94.477 kb.py:122(neighbors)
        9  282.756   31.417  282.758   31.418 nms.py:31(build)
        2    0.084    0.042  188.984   94.492 kb.py:75(score)
        1    0.000    0.000   95.259   95.259 simple.py:29(hop)
        1    0.076    0.076   95.199   95.199 kb.py:156(forward)
       18    0.926    0.051    0.926    0.051 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 5781 12997 12228 12563 11291 11603 12549
  11697   805  2302  8978 12137 11569  5344
  12872  1428 11724    96 14094  3898 12883
   1580 11237  3959  3955  2591 10454 12784
  12113  1028 10538 13188  4105 13484 14185
  12890 11764 14091  1342  1490 13337  5746
   1947 13601  2823 11717 13064   150 12909
  13509  7159  7947  8264   806 12385 11733
   3498  3164 12987  4418   443  3911 12657
   3275 11220  7640  7932  9953  1365  7248
  13345 12523 12395 11394  1971  2436  2019
   8442  9492  3104  6835  6678 12134  7880
   7234 13443  3119 13583  6297  3820  7232
  12826 12916  9994  3160  7249  3279 11487
  13573   400]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.649 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.649  283.649 simple.py:52(score)
        3    0.000    0.000  283.645   94.548 profilehooks.py:257(new_fn)
        3    0.138    0.046  283.645   94.548 profilehooks.py:348(__call__)
        3    0.002    0.001  282.705   94.235 kb.py:122(neighbors)
        9  282.015   31.335  282.017   31.335 nms.py:31(build)
        2    0.087    0.043  188.846   94.423 kb.py:75(score)
        1    0.000    0.000   94.721   94.721 simple.py:29(hop)
        1    0.084    0.084   94.661   94.661 kb.py:156(forward)
       18    0.953    0.053    0.953    0.053 {built-in method cat}
    18/15    0.001    0.000    0.220    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.217    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.217    0.017 functional.py:1774(embedding)
        3    0.000    0.000    0.217    0.072 kb.py:68(generate_facts)
       13    0.217    0.017    0.217    0.017 {built-in method embedding}
        3    0.135    0.045    0.136    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.950 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.950  282.950 simple.py:52(score)
        3    0.000    0.000  282.947   94.316 profilehooks.py:257(new_fn)
        3    0.137    0.046  282.947   94.316 profilehooks.py:348(__call__)
        3    0.002    0.001  282.090   94.030 kb.py:122(neighbors)
        9  281.397   31.266  281.399   31.267 nms.py:31(build)
        2    0.089    0.045  188.602   94.301 kb.py:75(score)
        1    0.000    0.000   94.267   94.267 simple.py:29(hop)
        1    0.077    0.077   94.207   94.207 kb.py:156(forward)
       18    0.901    0.050    0.901    0.050 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.135    0.045    0.136    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 7754  9193  9681 14370  8283  1322  3877
   8576  8269  7146 10029  9682  3026  8380
   9194  4138  8574 14369  6334  3025  7908
   6674  3024  8268  3006  3879  6993  5905
   9351  9280  1279  8266  7541 12213 12082
  12225  9666 12032 10057 12315  3649 12069
   8050 12222  3650 10914 12094  6992  3620
   3615  9671  5149  3546  3467  5246  6144
   4743  4789 11015  8049  9673  2006 12198
   3647  1819 12224 12030  5245 12270  5247
  12960  6191 12029  4744 11932  3593  5816
   8171 13062 13048 12274 11076 13034 13054
   5931 13058 13044 13043 13052  2530 13041
  13035  6190 13040 13036 13037 13057 13060
  13059  3545]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.556 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.556  284.556 simple.py:52(score)
        3    0.000    0.000  284.553   94.851 profilehooks.py:257(new_fn)
        3    0.142    0.047  284.552   94.851 profilehooks.py:348(__call__)
        3    0.002    0.001  283.635   94.545 kb.py:122(neighbors)
        9  282.927   31.436  282.928   31.436 nms.py:31(build)
        2    0.128    0.064  189.487   94.743 kb.py:75(score)
        1    0.000    0.000   94.964   94.964 simple.py:29(hop)
        1    0.043    0.043   94.923   94.923 kb.py:156(forward)
       18    0.954    0.053    0.954    0.053 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.154    0.051    0.154    0.051 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.872 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.872  283.872 simple.py:52(score)
        3    0.000    0.000  283.868   94.623 profilehooks.py:257(new_fn)
        3    0.140    0.047  283.868   94.623 profilehooks.py:348(__call__)
        3    0.002    0.001  283.005   94.335 kb.py:122(neighbors)
        9  282.286   31.365  282.288   31.365 nms.py:31(build)
        2    0.122    0.061  189.214   94.607 kb.py:75(score)
        1    0.000    0.000   94.553   94.553 simple.py:29(hop)
        1    0.049    0.049   94.514   94.514 kb.py:156(forward)
       18    0.876    0.049    0.876    0.049 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.182    0.061    0.182    0.061 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 6384  8791 11852  5786 12704  8118  8570
   3857 11851  8065 10629  8116   139  6437
   8862  7289  8924 11692  7325  5389   528
  11375 11376  9455  4749  4742  6821  6859
   8021 10620  8883  6002 11640  8209 11378
  10902  5685  8594  2828 10153  6597  6958
   5129  5011  5892  8453  5144  6333 12596
   4310 10574 11623 11518 10570  3883  8758
   4701  5937  3829  6159  8898  7606 12214
   6024  4916  5404  4097  8517 10963  5844
   3641 10444 11790  8800  4805  3892 10275
   4015  6868  5397  7821 10179  7735  3351
   8175  8426  2970  8011 10225 10534  3392
   4955  3783  8026  5911 11681  2003  8180
   8755  8234]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.879 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.879  284.879 simple.py:52(score)
        3    0.000    0.000  284.876   94.959 profilehooks.py:257(new_fn)
        3    0.121    0.040  284.876   94.959 profilehooks.py:348(__call__)
        3    0.002    0.001  284.096   94.699 kb.py:122(neighbors)
        9  283.375   31.486  283.376   31.486 nms.py:31(build)
        2    0.087    0.044  190.022   95.011 kb.py:75(score)
        1    0.000    0.000   94.777   94.777 simple.py:29(hop)
        1    0.043    0.043   94.733   94.733 kb.py:156(forward)
       18    0.861    0.048    0.861    0.048 {built-in method cat}
    18/15    0.001    0.000    0.205    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.202    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.202    0.067 kb.py:68(generate_facts)
       13    0.000    0.000    0.202    0.016 functional.py:1774(embedding)
       13    0.202    0.016    0.202    0.016 {built-in method embedding}
        3    0.172    0.057    0.173    0.058 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.862 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.862  283.862 simple.py:52(score)
        3    0.000    0.000  283.859   94.620 profilehooks.py:257(new_fn)
        3    0.132    0.044  283.859   94.620 profilehooks.py:348(__call__)
        3    0.002    0.001  283.060   94.353 kb.py:122(neighbors)
        9  282.358   31.373  282.360   31.373 nms.py:31(build)
        2    0.114    0.057  189.156   94.578 kb.py:75(score)
        1    0.000    0.000   94.609   94.609 simple.py:29(hop)
        1    0.043    0.043   94.571   94.571 kb.py:156(forward)
       18    0.837    0.047    0.837    0.047 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.186    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.172    0.057    0.173    0.058 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 2296   380  3000 11568  2186  6317  7688
  12781  9776  8569  8539  2206  1789 13017
    173  8839  6346  1227  4708  3517  7449
   1959  8796  3472  8637 12415 12384   326
  13655 13599  5749  2516 13461  6576  9698
   3274  8550  1271   151  5115  5727  3893
   4753  1172 10502 14428  3522  1102  9156
    637 11894 11729  7130  9423  7382   457
  11650  3907  9957 13597 12495   713  3507
   8821 12301  9335  9264  5472  7692  8034
  11908  6248  9446  7952 10492  4371 12073
   2446  1182 11366   159  2289  2267 11267
  12204   678  5335 11743  8557  3526 14065
   1032  4217  1351 11619 12514  8604  3908
   3523 10258]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.401 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.401  283.401 simple.py:52(score)
        3    0.000    0.000  283.398   94.466 profilehooks.py:257(new_fn)
        3    0.134    0.045  283.398   94.466 profilehooks.py:348(__call__)
        3    0.002    0.001  282.511   94.170 kb.py:122(neighbors)
        9  281.778   31.309  281.779   31.309 nms.py:31(build)
        2    0.114    0.057  188.954   94.477 kb.py:75(score)
        1    0.000    0.000   94.348   94.348 simple.py:29(hop)
        1    0.042    0.042   94.309   94.309 kb.py:156(forward)
       18    0.921    0.051    0.921    0.051 {built-in method cat}
        3    0.205    0.068    0.206    0.069 nms.py:51(query)
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.546 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.546  284.546 simple.py:52(score)
        3    0.000    0.000  284.542   94.847 profilehooks.py:257(new_fn)
        3    0.144    0.048  284.542   94.847 profilehooks.py:348(__call__)
        3    0.002    0.001  283.600   94.533 kb.py:122(neighbors)
        9  282.881   31.431  282.882   31.431 nms.py:31(build)
        2    0.112    0.056  189.468   94.734 kb.py:75(score)
        1    0.000    0.000   94.970   94.970 simple.py:29(hop)
        1    0.044    0.044   94.930   94.930 kb.py:156(forward)
       18    0.981    0.055    0.981    0.055 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.176    0.059    0.177    0.059 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 5781 12228  1580 12549 12883 12563 13064
  12997 13484    89 11394  1028  2302 12137
   9395 11719 14094 12826 12206 11842  3160
   3911    82 13618 11488  6678    41   901
  11238 12971  9766  7640 13617 13438  9994
  11733   443  3898  1367 14536   597 12134
  12395   594 12784 13553  9492  8672 12792
   3164  2802 11616  7932 11949 13430 13370
   7248 10881 12523  2967 10454  7247 10424
  11764  4418  1972 14092  1606 10536  1771
   1052  1792 13601  7944  2335 13354   201
   6835  7949  3142 12520    84   155  8321
  13609 13456  3397 13488  6451 11888   202
   4083  2019  8442  3498  3373  1605 11864
  11760 13337]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.174 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.174  284.174 simple.py:52(score)
        3    0.000    0.000  284.170   94.723 profilehooks.py:257(new_fn)
        3    0.129    0.043  284.170   94.723 profilehooks.py:348(__call__)
        3    0.002    0.001  283.259   94.420 kb.py:122(neighbors)
        9  282.544   31.394  282.545   31.394 nms.py:31(build)
        2    0.106    0.053  189.295   94.647 kb.py:75(score)
        1    0.000    0.000   94.785   94.785 simple.py:29(hop)
        1    0.042    0.042   94.746   94.746 kb.py:156(forward)
       18    0.990    0.055    0.990    0.055 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.199    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.144    0.048    0.145    0.048 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method exp}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.664 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.664  284.664 simple.py:52(score)
        3    0.000    0.000  284.661   94.887 profilehooks.py:257(new_fn)
        3    0.129    0.043  284.661   94.887 profilehooks.py:348(__call__)
        3    0.002    0.001  283.753   94.584 kb.py:122(neighbors)
        9  283.041   31.449  283.043   31.449 nms.py:31(build)
        2    0.108    0.054  189.740   94.870 kb.py:75(score)
        1    0.000    0.000   94.831   94.831 simple.py:29(hop)
        1    0.044    0.044   94.792   94.792 kb.py:156(forward)
       18    0.929    0.052    0.929    0.052 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.218    0.017 functional.py:1774(embedding)
        3    0.000    0.000    0.218    0.073 kb.py:68(generate_facts)
       13    0.218    0.017    0.218    0.017 {built-in method embedding}
        3    0.176    0.059    0.176    0.059 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[  299   196  5228  2745  3148  3448  2624
   2862 13157 13114  2691  2712  3412  6050
    233  2720   187  2933  5338   229  7094
   2621   824  7318  2914  2189  2178 13331
  14112 10096  6075  3334 11514  2892  3268
    617  3865  2863   827  2221   691  2864
    881  7493  4157  2955  6183  2201  9759
   2906  2605 14002 12502  2269 11250 13270
   4448  4557 13937  2927 11859  2027 12150
   2746 13459  1739  1868  6719  7271  2805
   7242    40 12019 10318  3056  2868  2741
   6316  7299  2739 13490  2829  5951  2060
   1905  2905  8051   190 12236  2865  4724
   7338  2815  2051  2791  2730  1983 11916
  11231 11914]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.880 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.880  282.880 simple.py:52(score)
        3    0.000    0.000  282.876   94.292 profilehooks.py:257(new_fn)
        3    0.129    0.043  282.876   94.292 profilehooks.py:348(__call__)
        3    0.002    0.001  281.985   93.995 kb.py:122(neighbors)
        9  281.374   31.264  281.376   31.264 nms.py:31(build)
        2    0.108    0.054  188.923   94.462 kb.py:75(score)
        1    0.000    0.000   93.863   93.863 simple.py:29(hop)
        1    0.043    0.043   93.824   93.824 kb.py:156(forward)
       18    0.942    0.052    0.942    0.052 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
        3    0.066    0.022    0.066    0.022 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.626 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.626  277.626 simple.py:52(score)
        3    0.000    0.000  277.623   92.541 profilehooks.py:257(new_fn)
        3    0.127    0.042  277.623   92.541 profilehooks.py:348(__call__)
        3    0.001    0.000  276.717   92.239 kb.py:122(neighbors)
        9  276.029   30.670  276.031   30.670 nms.py:31(build)
        2    0.105    0.053  183.632   91.816 kb.py:75(score)
        1    0.000    0.000   93.902   93.902 simple.py:29(hop)
        1    0.042    0.042   93.863   93.863 kb.py:156(forward)
       18    0.956    0.053    0.956    0.053 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.162    0.054    0.163    0.054 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


[[  685  2781  2175  6074  5443  8981 11101
   2595  1415 10618  7034 14008  2212   687
   1460   506  4182  9365   507  3260  6785
  10550  3895  4943  5062  8779  1806  8198
   2558  9179  7509  8417  7858  9712  3550
    473  2938  5840  5986  5086 14009  2900
    722 10351  3497   319 10786  2786  5403
   2699 12411  5112   171 12020   129  1065
   7327 13210 13369  1939 13032  3694  6929
  12109  4816 10821  7378  9044  7834  9052
   2217   634  5626   119  1651  4689  2228
    338  8400  4525   588 11701 10853  1642
   8079  2078 11913 12277  8179  2910 10282
   2861  2405  2899  2852  2153   871 13594
  11529   163]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.447 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  281.447  281.447 simple.py:52(score)
        3    0.000    0.000  281.444   93.815 profilehooks.py:257(new_fn)
        3    0.121    0.040  281.444   93.815 profilehooks.py:348(__call__)
        3    0.002    0.001  280.539   93.513 kb.py:122(neighbors)
        9  279.854   31.095  279.855   31.095 nms.py:31(build)
        2    0.088    0.044  186.846   93.423 kb.py:75(score)
        1    0.000    0.000   94.518   94.518 simple.py:29(hop)
        1    0.042    0.042   94.477   94.477 kb.py:156(forward)
       18    1.002    0.056    1.002    0.056 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.134    0.045    0.134    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.547 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.547  283.547 simple.py:52(score)
        3    0.000    0.000  283.543   94.514 profilehooks.py:257(new_fn)
        3    0.129    0.043  283.543   94.514 profilehooks.py:348(__call__)
        3    0.002    0.001  282.595   94.198 kb.py:122(neighbors)
        9  281.918   31.324  281.920   31.324 nms.py:31(build)
        2    0.106    0.053  189.561   94.781 kb.py:75(score)
        1    0.000    0.000   93.891   93.891 simple.py:29(hop)
        1    0.042    0.042   93.852   93.852 kb.py:156(forward)
       18    1.009    0.056    1.009    0.056 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
       13    0.000    0.000    0.199    0.015 functional.py:1774(embedding)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.124    0.041    0.124    0.041 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  387  3886  1096  6382  4368 10930  4022
    699  2444  7861   311  9779  5924  3766
   3313  4646 10917  4623  3083  9371  4169
   1594  1928  8769  2244   763 13127  9638
   6082  3733 11775  6615 13503  7375  5790
   3704   593 13093  2952  3554 12601  1997
   3838  5018  7138 12870 14080  8493 10422
    334  7840 14535  8322  9960  2962  3321
  14095  3443  3809  8358  1866 10164  3387
   2453  8984  9884 11230 12782 12643 11675
   4780   857  1199   399  7497  8408  1593
  12804  4088  2361  9386  1193 13505 10430
  11506 10354  1383 12720 11952 10362 10198
     78  5099 12803 10344 12733 11674   152
  13448 14376]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.841 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.841  286.841 simple.py:52(score)
        3    0.000    0.000  286.837   95.612 profilehooks.py:257(new_fn)
        3    0.130    0.043  286.837   95.612 profilehooks.py:348(__call__)
        3    0.002    0.001  285.930   95.310 kb.py:122(neighbors)
        9  285.245   31.694  285.246   31.694 nms.py:31(build)
        2    0.104    0.052  190.896   95.448 kb.py:75(score)
        1    0.000    0.000   95.851   95.851 simple.py:29(hop)
        1    0.046    0.046   95.811   95.811 kb.py:156(forward)
       18    0.956    0.053    0.956    0.053 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.343 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.343  285.343 simple.py:52(score)
        3    0.000    0.000  285.339   95.113 profilehooks.py:257(new_fn)
        3    0.133    0.044  285.339   95.113 profilehooks.py:348(__call__)
        3    0.002    0.001  284.384   94.795 kb.py:122(neighbors)
        9  283.674   31.519  283.675   31.519 nms.py:31(build)
        2    0.109    0.055  190.016   95.008 kb.py:75(score)
        1    0.000    0.000   95.234   95.234 simple.py:29(hop)
        1    0.047    0.047   95.191   95.191 kb.py:156(forward)
       18    1.026    0.057    1.026    0.057 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.137    0.046    0.138    0.046 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 9307  7727  2960  8249  7186  6565  7544
   7676 14338  8414  9629  9925  7829  8907
   2975  8247  9508  8199  7873 13561  8248
   4326  9983  9298 10369  8443  7874  3322
   8087  4306  7067  8082  6847 11054  8366
   3834  9974  4355  7591  7823  2577 10414
  11538 12845 14352 10026  5317  2663  8952
   6626 12673  3149  8357  4259  2115  6875
   8656  6569  8250 13237  8572   898  3793
   7132   737  5566  6829   403 14194 11892
   9806  6951 12815   918   998  1569  3154
   5659  3845  3451  3744  2236 10043  5126
   4396  5233 13585 13604  1900 11286 14501
   9688 12434 12853  2677   584  5306  5929
    120  5027]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.625 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.625  285.625 simple.py:52(score)
        3    0.000    0.000  285.621   95.207 profilehooks.py:257(new_fn)
        3    0.143    0.048  285.621   95.207 profilehooks.py:348(__call__)
        3    0.002    0.001  284.781   94.927 kb.py:122(neighbors)
        9  284.145   31.572  284.147   31.572 nms.py:31(build)
        2    0.121    0.060  190.201   95.100 kb.py:75(score)
        1    0.000    0.000   95.316   95.316 simple.py:29(hop)
        1    0.043    0.043   95.277   95.277 kb.py:156(forward)
       18    0.858    0.048    0.858    0.048 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.107    0.036    0.108    0.036 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.608 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.608  284.608 simple.py:52(score)
        3    0.000    0.000  284.604   94.868 profilehooks.py:257(new_fn)
        3    0.135    0.045  284.604   94.868 profilehooks.py:348(__call__)
        3    0.002    0.001  283.812   94.604 kb.py:122(neighbors)
        9  283.114   31.457  283.115   31.457 nms.py:31(build)
        2    0.116    0.058  189.460   94.730 kb.py:75(score)
        1    0.000    0.000   95.049   95.049 simple.py:29(hop)
        1    0.043    0.043   95.010   95.010 kb.py:156(forward)
       18    0.826    0.046    0.826    0.046 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.169    0.056    0.170    0.057 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 7606  7816 11734  2828  9844  3991  9221
   4736  5223  7543   456 12009  5646  3351
   4873  6295  8474 14274   935  1908   554
   6561 10136  6034 10620 11723  7156 10681
  12004 12682  7637  3391  5844 14032 12588
   5582  1251  4310  6169 10626 10986 10218
  12991  1979    54  3963  8234  2168  6020
   3921  1719  8211  4839  8771  3770   977
  11594   549  1409 11906 12210  9668 10902
   5011  8002  9792 10574  5657  4174  8603
   9745 11589   817  6765  4011 11445  7509
   4114 10261  5911 11640 11301   528  7355
  13993 11306  3912  5803  7650  9835  4788
  10974   844 10444  1884  6024  5492  9739
   9070  6331]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.838 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.838  285.838 simple.py:52(score)
        3    0.000    0.000  285.834   95.278 profilehooks.py:257(new_fn)
        3    0.129    0.043  285.834   95.278 profilehooks.py:348(__call__)
        3    0.002    0.001  285.041   95.014 kb.py:122(neighbors)
        9  284.361   31.596  284.362   31.596 nms.py:31(build)
        2    0.085    0.042  189.583   94.791 kb.py:75(score)
        1    0.000    0.000   96.174   96.174 simple.py:29(hop)
        1    0.063    0.063   96.123   96.123 kb.py:156(forward)
       18    0.846    0.047    0.846    0.047 {built-in method cat}
    18/15    0.001    0.000    0.208    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.205    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.205    0.068 kb.py:68(generate_facts)
       13    0.000    0.000    0.205    0.016 functional.py:1774(embedding)
       13    0.204    0.016    0.204    0.016 {built-in method embedding}
        3    0.132    0.044    0.133    0.044 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.349 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.349  285.349 simple.py:52(score)
        3    0.000    0.000  285.345   95.115 profilehooks.py:257(new_fn)
        3    0.137    0.046  285.345   95.115 profilehooks.py:348(__call__)
        3    0.002    0.001  284.504   94.835 kb.py:122(neighbors)
        9  283.802   31.534  283.804   31.534 nms.py:31(build)
        2    0.086    0.043  189.510   94.755 kb.py:75(score)
        1    0.000    0.000   95.757   95.757 simple.py:29(hop)
        1    0.078    0.078   95.698   95.698 kb.py:156(forward)
       18    0.878    0.049    0.878    0.049 {built-in method cat}
    18/15    0.001    0.000    0.190    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.160    0.053    0.160    0.053 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[14433  8934 13109 12529  8094 13513  2026
   5868 14422 12050 12679  1130  8344 12412
   5291  9014   657  6366  5199  9010   775
    444  4498 11041 10148   622 12463  6723
   8935 13614  9696  3937  9915  9984  1282
    513 14015    33 11757  5080  8160   183
    721  8609 12583 11769 10843  1499  1485
    627  3074  2897 11746  9794   810 14397
    199  5145  6452   773  3941  1475  8320
  10511  5970  9572  5745  4840  1500  5363
   4874 12473   655  4654   629  3515 12798
    742  9621  8911    95  8861  8336 10561
  13063 13546   105 10176  8173 11498  3708
   9472  6258   553  1001  8649  3247  4592
    769  6336]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.363 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.363  285.363 simple.py:52(score)
        3    0.000    0.000  285.360   95.120 profilehooks.py:257(new_fn)
        3    0.145    0.048  285.360   95.120 profilehooks.py:348(__call__)
        3    0.002    0.001  284.474   94.825 kb.py:122(neighbors)
        9  283.780   31.531  283.782   31.531 nms.py:31(build)
        2    0.088    0.044  189.638   94.819 kb.py:75(score)
        1    0.000    0.000   95.642   95.642 simple.py:29(hop)
        1    0.079    0.079   95.576   95.576 kb.py:156(forward)
       18    0.850    0.047    0.850    0.047 {built-in method cat}
    18/15    0.001    0.000    0.239    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.236    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.236    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.236    0.079 kb.py:68(generate_facts)
        3    0.165    0.055    0.166    0.055 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.671 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.671  285.671 simple.py:52(score)
        3    0.000    0.000  285.667   95.222 profilehooks.py:257(new_fn)
        3    0.137    0.046  285.666   95.222 profilehooks.py:348(__call__)
        3    0.002    0.001  284.815   94.938 kb.py:122(neighbors)
        9  284.078   31.564  284.080   31.564 nms.py:31(build)
        2    0.083    0.042  189.854   94.927 kb.py:75(score)
        1    0.000    0.000   95.735   95.735 simple.py:29(hop)
        1    0.076    0.076   95.675   95.675 kb.py:156(forward)
       18    0.897    0.050    0.897    0.050 {built-in method cat}
    18/15    0.001    0.000    0.207    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
       13    0.000    0.000    0.204    0.016 functional.py:1774(embedding)
       13    0.204    0.016    0.204    0.016 {built-in method embedding}
        3    0.176    0.059    0.176    0.059 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 5694  1382  6806  3265  5691  8113   939
   3429  8808  1445  8689  8709  6245  1565
  10761 12964  7616  7681  6213  5327   239
   9149  8968  8660 10994 12955  5910 11068
  11330 13954  6270  2301  8711  6422  3327
  10452  6524  7359  5028   938  2381   247
  11970  4941 12785  9896  7953  7601 11104
   9430  1106 10712  2956  5353  6319  8622
   9923  7667  6505  5252  3609 11772  2921
   3585  1682  5695  8318  2337  6098  8682
   2948  7384  9860  4228 14378  2411 12544
   2441  8639  7975  1128  2463  7955  3643
   9667  6942  7196  2804  9462   370  8256
   7522  7088  7521   763  8322  1997  3554
  13093  2952]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.835 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.835  286.835 simple.py:52(score)
        3    0.000    0.000  286.832   95.611 profilehooks.py:257(new_fn)
        3    0.133    0.044  286.832   95.611 profilehooks.py:348(__call__)
        3    0.002    0.001  285.998   95.333 kb.py:122(neighbors)
        9  285.204   31.689  285.205   31.689 nms.py:31(build)
        2    0.085    0.043  190.897   95.449 kb.py:75(score)
        1    0.000    0.000   95.856   95.856 simple.py:29(hop)
        1    0.071    0.071   95.801   95.801 kb.py:156(forward)
       18    0.974    0.054    0.974    0.054 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
        3    0.156    0.052    0.157    0.052 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.012 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.012  287.012 simple.py:52(score)
        3    0.000    0.000  287.008   95.669 profilehooks.py:257(new_fn)
        3    0.133    0.044  287.008   95.669 profilehooks.py:348(__call__)
        3    0.002    0.001  286.180   95.393 kb.py:122(neighbors)
        9  285.461   31.718  285.462   31.718 nms.py:31(build)
        2    0.084    0.042  191.612   95.806 kb.py:75(score)
        1    0.000    0.000   95.317   95.317 simple.py:29(hop)
        1    0.071    0.071   95.263   95.263 kb.py:156(forward)
       18    0.892    0.050    0.892    0.050 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.163    0.054    0.163    0.054 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[    6 10745 14519 14373 13457 10743 14511
    283 14075  8718   274 10744 14319 11903
  14483 14322 14138 14490 14512   261 14139
  14225 14318 14292 10748 14253 12092 14074
  12142 13159    20 12481 10741 14144   279
  13660 14215 14526 14184  1508 14224 12261
  14076 14420 11639 14368 14527     7 12254
  12264   260    17 14188 14247 14529 10028
      2 14300 14444 14259 14367   253 14077
   7243  3093 13208   249  9363  5032 14252
  10725  6805 14331 11917 14385 14310 14254
  11720  1688 11269 14311 14532 14485 12389
  12789 14217  1480 13203 14326   263  2616
  10750 10958  9762  1413 14213 14256     0
  14251 10971]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.888 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.888  285.888 simple.py:52(score)
        3    0.000    0.000  285.884   95.295 profilehooks.py:257(new_fn)
        3    0.129    0.043  285.884   95.295 profilehooks.py:348(__call__)
        3    0.002    0.001  285.066   95.022 kb.py:122(neighbors)
        9  284.390   31.599  284.392   31.599 nms.py:31(build)
        2    0.082    0.041  190.273   95.136 kb.py:75(score)
        1    0.000    0.000   95.533   95.533 simple.py:29(hop)
        1    0.062    0.062   95.482   95.482 kb.py:156(forward)
       18    0.889    0.049    0.889    0.049 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.119    0.040    0.119    0.040 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.640 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.640  285.640 simple.py:52(score)
        3    0.000    0.000  285.636   95.212 profilehooks.py:257(new_fn)
        3    0.131    0.044  285.636   95.212 profilehooks.py:348(__call__)
        3    0.002    0.001  284.794   94.931 kb.py:122(neighbors)
        9  284.110   31.568  284.112   31.568 nms.py:31(build)
        2    0.087    0.043  191.051   95.525 kb.py:75(score)
        1    0.000    0.000   94.508   94.508 simple.py:29(hop)
        1    0.065    0.065   94.455   94.455 kb.py:156(forward)
       18    0.892    0.050    0.892    0.050 {built-in method cat}
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.143    0.048    0.143    0.048 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 6657  6258  1561  9472  8728 11498  1282
   4555  9839  5123 10555  9197 10561 10610
   8336  5970  9912  1591   786  5080  6866
   9572 10176 11746 12327 10188  6649   742
   1681   721  2454  1485  7838   543 12607
  12692  7596  5936  5581  3243   105  2907
   8320   332  4171  8395  1130  8173   775
  12798  9783  3247  5782  1672  3207 14397
   3055  9532 10330  5363   513  7866 10233
   4075 13422  4607  3476  9794 13063 11497
  11757  8609  9158   553 12583  8094 11769
   8524  3338  9782 14396   566  4135  5369
   4840   780  1500  6548  5723 13614  4874
  13511  9984    33 13546  2112  3941 12281
   6723  2897]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.432 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.432  286.432 simple.py:52(score)
        3    0.000    0.000  286.428   95.476 profilehooks.py:257(new_fn)
        3    0.138    0.046  286.428   95.476 profilehooks.py:348(__call__)
        3    0.002    0.001  285.609   95.203 kb.py:122(neighbors)
        9  284.892   31.655  284.894   31.655 nms.py:31(build)
        2    0.117    0.059  191.480   95.740 kb.py:75(score)
        1    0.000    0.000   94.849   94.849 simple.py:29(hop)
        1    0.044    0.044   94.810   94.810 kb.py:156(forward)
       18    0.846    0.047    0.846    0.047 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.179    0.060    0.179    0.060 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.207 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.207  286.207 simple.py:52(score)
        3    0.000    0.000  286.203   95.401 profilehooks.py:257(new_fn)
        3    0.138    0.046  286.203   95.401 profilehooks.py:348(__call__)
        3    0.002    0.001  285.326   95.109 kb.py:122(neighbors)
        9  284.577   31.620  284.579   31.620 nms.py:31(build)
        2    0.119    0.059  190.808   95.404 kb.py:75(score)
        1    0.000    0.000   95.296   95.296 simple.py:29(hop)
        1    0.047    0.047   95.257   95.257 kb.py:156(forward)
       18    0.916    0.051    0.916    0.051 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.194    0.065    0.194    0.065 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[11805 11049  8470  4657  7122 11396 11900
   6830  7592  7768  8780 11969 10724 10518
   5182  8786 12405  6428 13751   873 11052
   7126  7438  3806  7333  1482    69 10067
  11038  8452 12350 12943  6773  1574 12358
  10120  7139 10905  8667  5995 10878 11844
   9751  8818  3880  8680  6949  6432  3337
   6473  2462 12460 10481 10985 11713 12160
  12357 11079  6621  1804  4952  5731 11146
   2684  8652  5365 11027  4279 10809  9256
   8387  7624 13133  9177 11666 12536 10785
  12634   102 12881 12669  9784  5302 10968
   5729 11334 11828  5279  5358  1462 10904
    613  4791 12899  9946  8448 10731 14123
  12512  7137]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.192 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.192  286.192 simple.py:52(score)
        3    0.000    0.000  286.189   95.396 profilehooks.py:257(new_fn)
        3    0.133    0.044  286.189   95.396 profilehooks.py:348(__call__)
        3    0.002    0.001  285.392   95.131 kb.py:122(neighbors)
        9  284.714   31.635  284.716   31.635 nms.py:31(build)
        2    0.114    0.057  191.391   95.695 kb.py:75(score)
        1    0.000    0.000   94.704   94.704 simple.py:29(hop)
        1    0.042    0.042   94.665   94.665 kb.py:156(forward)
       18    0.852    0.047    0.852    0.047 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.128    0.043    0.129    0.043 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.605 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.605  287.605 simple.py:52(score)
        3    0.000    0.000  287.601   95.867 profilehooks.py:257(new_fn)
        3    0.134    0.045  287.601   95.867 profilehooks.py:348(__call__)
        3    0.002    0.001  286.708   95.569 kb.py:122(neighbors)
        9  286.004   31.778  286.005   31.778 nms.py:31(build)
        2    0.115    0.057  192.210   96.105 kb.py:75(score)
        1    0.000    0.000   95.297   95.297 simple.py:29(hop)
        1    0.041    0.041   95.257   95.257 kb.py:156(forward)
       18    0.947    0.053    0.947    0.053 {built-in method cat}
    18/15    0.001    0.000    0.205    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.201    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.201    0.015 functional.py:1774(embedding)
       13    0.201    0.015    0.201    0.015 {built-in method embedding}
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
        3    0.143    0.048    0.143    0.048 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[14433  8934 13109 12529  8094 13513  2026
   5868 14422 12050 12679  1130  5291  8344
  12412   657  9014  5199  6366   775  9010
    444  4498 11041 10148   622 12463  6723
   8935 13614  9696  3937  9915  9984  1282
    513    33 14015 11757  5080  8160   183
    721  8609 12583 11769 10843  1485  1499
    627 11746  3074  2897  9794   199 14397
   5145   773  6452  3941   810  1475  8320
  10511  5970  9572  5745  4840  1500  5363
   4874   629 12473   655  4654 12798  3515
    742  9621  8911    95  8861  8336 10561
  13063   105 13546 10176  8173 11498  3708
   9472  6258  1001   553  8649  6336  4592
   3247   769]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.541 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.541  286.541 simple.py:52(score)
        3    0.000    0.000  286.537   95.512 profilehooks.py:257(new_fn)
        3    0.152    0.051  286.537   95.512 profilehooks.py:348(__call__)
        3    0.002    0.001  285.671   95.224 kb.py:122(neighbors)
        9  284.949   31.661  284.951   31.661 nms.py:31(build)
        2    0.142    0.071  191.019   95.509 kb.py:75(score)
        1    0.000    0.000   95.405   95.405 simple.py:29(hop)
        1    0.044    0.044   95.366   95.366 kb.py:156(forward)
       18    0.895    0.050    0.895    0.050 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.141    0.047    0.142    0.047 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.596 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  288.596  288.596 simple.py:52(score)
        3    0.000    0.000  288.591   96.197 profilehooks.py:257(new_fn)
        3    0.148    0.049  288.591   96.197 profilehooks.py:348(__call__)
        3    0.002    0.001  287.681   95.894 kb.py:122(neighbors)
        9  286.958   31.884  286.959   31.884 nms.py:31(build)
        2    0.121    0.061  192.614   96.307 kb.py:75(score)
        1    0.000    0.000   95.868   95.868 simple.py:29(hop)
        1    0.044    0.044   95.829   95.829 kb.py:156(forward)
       18    0.921    0.051    0.921    0.051 {built-in method cat}
    18/15    0.001    0.000    0.205    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.201    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.201    0.015 functional.py:1774(embedding)
       13    0.201    0.015    0.201    0.015 {built-in method embedding}
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
        3    0.180    0.060    0.181    0.060 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 7224 11514  9742  9229  9605  2784  3411
  13936  3865 10892   563  6719  2742  7144
    186  2933  2912  4724  1056  2726  4082
   1937  1166  5217  4937   289  2777 10557
   2940  6722  9297  2790  1048 11003   476
  10601  5562  6174  4460   635  2872 10486
    393  2545  9248  5621 14104   302  2490
   1736  7017  2189  2314  2900  5228  7299
   6050  1777  2744  2862  3486  6178  2778
   2740  4380  9807 10309  8612  6220  6316
  12061  2766  4479  8513  6584  6744  1974
  10346  2761 12593 11328 13270 14383  3201
   3189  8051 13114  9759 11236 14530 11839
  13282  2027 12557  5381  2610   882  2891
   2691  2060]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.233 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.233  288.233 simple.py:52(score)
        3    0.000    0.000  288.229   96.076 profilehooks.py:257(new_fn)
        3    0.122    0.041  288.229   96.076 profilehooks.py:348(__call__)
        3    0.002    0.001  287.432   95.811 kb.py:122(neighbors)
        9  286.793   31.866  286.795   31.866 nms.py:31(build)
        2    0.087    0.043  192.255   96.128 kb.py:75(score)
        1    0.000    0.000   95.894   95.894 simple.py:29(hop)
        1    0.042    0.042   95.852   95.852 kb.py:156(forward)
       18    0.891    0.050    0.891    0.050 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.085    0.028    0.086    0.029 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.079 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.079  285.079 simple.py:52(score)
        3    0.000    0.000  285.076   95.025 profilehooks.py:257(new_fn)
        3    0.129    0.043  285.076   95.025 profilehooks.py:348(__call__)
        3    0.001    0.000  284.291   94.764 kb.py:122(neighbors)
        9  283.660   31.518  283.661   31.518 nms.py:31(build)
        2    0.084    0.042  189.463   94.732 kb.py:75(score)
        1    0.000    0.000   95.534   95.534 simple.py:29(hop)
        1    0.062    0.062   95.484   95.484 kb.py:156(forward)
       18    0.860    0.048    0.860    0.048 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.078    0.026    0.078    0.026 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


[[12997  3898  7932 10538 13601    89  6678
   7248 11394  6835  3164 13064 11733 12872
   3397  3911  1365  9492  5781 12784  2302
  11569    96 13430  7640  7247 12657 12767
  12826  7944  9395 10536 10352 11719 12523
  12395    41 13438 13345 13337 12385 11842
   7949  7249  1972  1580 11864  1490 12563
   3275  3119  7947  3160 12285  9103 13618
  11888 10424  4418   202   443   284 13258
     82 11764 13615 13371  8442  2019 12878
  13443 13583 14094  4612  4105 13370 13748
   7059  1893  1435  8978 11220 14038  2436
   3373 11621  1771  1792 10881  1367 11697
  13573    84  2823 13609  7880  7159 11122
  12909 13509]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.824 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.824  285.824 simple.py:52(score)
        3    0.000    0.000  285.821   95.274 profilehooks.py:257(new_fn)
        3    0.143    0.048  285.821   95.274 profilehooks.py:348(__call__)
        3    0.002    0.001  284.898   94.966 kb.py:122(neighbors)
        9  284.261   31.585  284.263   31.585 nms.py:31(build)
        2    0.116    0.058  189.883   94.941 kb.py:75(score)
        1    0.000    0.000   95.840   95.840 simple.py:29(hop)
        1    0.047    0.047   95.795   95.795 kb.py:156(forward)
       18    0.944    0.052    0.944    0.052 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.201    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.201    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
       13    0.201    0.015    0.201    0.015 {built-in method embedding}
        3    0.094    0.031    0.095    0.032 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.522 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.522  291.522 simple.py:52(score)
        3    0.000    0.000  291.518   97.173 profilehooks.py:257(new_fn)
        3    0.119    0.040  291.518   97.173 profilehooks.py:348(__call__)
        3    0.002    0.001  290.687   96.896 kb.py:122(neighbors)
        9  290.034   32.226  290.035   32.226 nms.py:31(build)
        2    0.084    0.042  195.117   97.558 kb.py:75(score)
        1    0.000    0.000   96.323   96.323 simple.py:29(hop)
        1    0.046    0.046   96.282   96.282 kb.py:156(forward)
       18    0.877    0.049    0.877    0.049 {built-in method cat}
    18/15    0.001    0.000    0.211    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.208    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.207    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.207    0.069 kb.py:68(generate_facts)
       13    0.207    0.016    0.207    0.016 {built-in method embedding}
        3    0.136    0.045    0.137    0.046 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[10961  8111   919  8042 12750  2870  6431
  10814  7923  7682  2942  8745  9568  6541
   3162  3930  7001  1209  5035  9339  7789
   5477  4759 10290  9065  1331  4131 12001
   7304  3788  5322  7537  2358  8876  2236
   9089  6785  7733 10180  5483  5476  9599
   7666  7854 10405  3386  1065  8312   244
   2957  7363  7024  1340  1807  9948  4664
   5849  9377 10054   129  5089  5835  3595
   8840 14056 10696  3761  7554 10763  6586
  10995 11826  2558  8743  4684  6478  9421
   5037   120  9403  7842   312  8128 10214
   2780 11350  4189  1830  1976  4319 10144
   7746  9005   149  7914  3258  6624  6813
   5804  8544]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.031 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.031  289.031 simple.py:52(score)
        3    0.000    0.000  289.028   96.343 profilehooks.py:257(new_fn)
        3    0.131    0.044  289.028   96.343 profilehooks.py:348(__call__)
        3    0.002    0.001  288.131   96.044 kb.py:122(neighbors)
        9  287.504   31.945  287.506   31.945 nms.py:31(build)
        2    0.110    0.055  192.829   96.414 kb.py:75(score)
        1    0.000    0.000   96.107   96.107 simple.py:29(hop)
        1    0.045    0.045   96.068   96.068 kb.py:156(forward)
       18    0.974    0.054    0.974    0.054 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.186    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.185    0.014 functional.py:1774(embedding)
       13    0.185    0.014    0.185    0.014 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.060    0.020    0.061    0.020 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.887 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.887  286.887 simple.py:52(score)
        3    0.000    0.000  286.883   95.628 profilehooks.py:257(new_fn)
        3    0.139    0.046  286.883   95.628 profilehooks.py:348(__call__)
        3    0.002    0.001  285.972   95.324 kb.py:122(neighbors)
        9  285.276   31.697  285.277   31.697 nms.py:31(build)
        2    0.108    0.054  191.035   95.517 kb.py:75(score)
        1    0.000    0.000   95.753   95.753 simple.py:29(hop)
        1    0.043    0.043   95.709   95.709 kb.py:156(forward)
       18    0.952    0.053    0.952    0.053 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.159    0.053    0.159    0.053 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[12431  6226   188   577 12440  2731 11690
  13535   316 13460 12083  2372  2751   563
    987 10111  7097  2755  2724  6050  2664
   2938  1917 13358  2275 12944  2822  6291
    228  2814   988  2722  2747 13442  2595
   2230   328  6147  2850  1470  2805  2339
   3016  2490 10061  2189  9759  2689  5228
  12856   710  6078  1388  2060  2477  2707
   9775   690  2742  1415  2703  2895  2096
    107  2892   230  6181   801   205  2935
   6014  8186  2875 10885  3990   697  1926
   4069  1222  4525   567 10926  2827  2741
  12976  6595 13355 12390  6059  2848  9035
     45  6476    13 14100  2766  2732  2156
   6079  2501]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.937 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.937  287.937 simple.py:52(score)
        3    0.000    0.000  287.933   95.978 profilehooks.py:257(new_fn)
        3    0.138    0.046  287.933   95.978 profilehooks.py:348(__call__)
        3    0.002    0.001  286.889   95.630 kb.py:122(neighbors)
        9  286.283   31.809  286.284   31.809 nms.py:31(build)
        2    0.117    0.058  191.486   95.743 kb.py:75(score)
        1    0.000    0.000   96.349   96.349 simple.py:29(hop)
        1    0.041    0.041   96.310   96.310 kb.py:156(forward)
       18    1.053    0.058    1.053    0.058 {built-in method cat}
    18/15    0.001    0.000    0.224    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.221    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.220    0.017 functional.py:1774(embedding)
        3    0.000    0.000    0.220    0.073 kb.py:68(generate_facts)
       13    0.220    0.017    0.220    0.017 {built-in method embedding}
        3    0.065    0.022    0.066    0.022 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.084 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.084  289.084 simple.py:52(score)
        3    0.000    0.000  289.080   96.360 profilehooks.py:257(new_fn)
        3    0.142    0.047  289.080   96.360 profilehooks.py:348(__call__)
        3    0.002    0.001  288.185   96.062 kb.py:122(neighbors)
        9  287.462   31.940  287.464   31.940 nms.py:31(build)
        2    0.133    0.066  192.759   96.379 kb.py:75(score)
        1    0.000    0.000   96.219   96.219 simple.py:29(hop)
        1    0.042    0.042   96.179   96.179 kb.py:156(forward)
       18    0.913    0.051    0.913    0.051 {built-in method cat}
    18/15    0.001    0.000    0.200    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.176    0.059    0.177    0.059 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[   50 11029  4132  4828  5673  1293  5130
   4829  3511  9828  1147 11944  2978  4922
   6600 11700  9611  5495  5507 14035 11097
   6922 10113 11778 14441  8885   287 10094
   5135  1979  4827  1168  1834  5671  2673
   4073 14031 10467  6363  6554  4697  6380
   9213  7172  1497  8214 10981 11800  4695
  11060 10974 14119  7726  1585  8026 14103
   3562  6904  8403 11030  3354  3991 11685
  11649  1832 12420  6783  1454   288 10192
   5172  9633  5496 11953 11958 10544  4414
  10221   456 10033  7141  4581  4877 13755
  11404  1716 13223   572  5223  5224  6580
   3742  6871  6765  5494  6295  4819 12056
   1835 10673]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.020 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.020  288.020 simple.py:52(score)
        3    0.000    0.000  288.016   96.005 profilehooks.py:257(new_fn)
        3    0.136    0.045  288.016   96.005 profilehooks.py:348(__call__)
        3    0.002    0.001  287.128   95.709 kb.py:122(neighbors)
        9  286.405   31.823  286.406   31.823 nms.py:31(build)
        2    0.102    0.051  191.816   95.908 kb.py:75(score)
        1    0.000    0.000   96.111   96.111 simple.py:29(hop)
        1    0.057    0.057   96.065   96.065 kb.py:156(forward)
       18    0.935    0.052    0.935    0.052 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.170    0.057    0.170    0.057 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.772 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.772  288.772 simple.py:52(score)
        3    0.000    0.000  288.769   96.256 profilehooks.py:257(new_fn)
        3    0.129    0.043  288.769   96.256 profilehooks.py:348(__call__)
        3    0.002    0.001  287.993   95.998 kb.py:122(neighbors)
        9  287.283   31.920  287.285   31.921 nms.py:31(build)
        2    0.088    0.044  192.167   96.084 kb.py:75(score)
        1    0.000    0.000   96.523   96.523 simple.py:29(hop)
        1    0.062    0.062   96.473   96.473 kb.py:156(forward)
       18    0.833    0.046    0.833    0.046 {built-in method cat}
    18/15    0.001    0.000    0.204    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.201    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.201    0.015 functional.py:1774(embedding)
       13    0.201    0.015    0.201    0.015 {built-in method embedding}
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
        3    0.157    0.052    0.157    0.052 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[  387  3886  1096  6382  4368 10930  4022
    699  2444  7861   311  9779  5924  3766
   3313  4646 10917  4623  3083  9371  4169
   1594  1928  8769  2244   763 13127  9638
   6082  3733 11775  6615 13503  7375  5790
   3704   593 13093  2952  3554 12601  1997
   3838  5018  7138 12870 14080  8493 10422
    334  7840 14535  8322  9960  2962  3321
  14095  3443  3809  8358  1866 10164  3387
   2453  8984  9884 11230 12782 12643 11675
   4780   857  1199   399  7497  8408  1593
  12804  4088  2361  9386  1193 13505 10430
  11506 10354  1383 12720 11952 10362 10198
     78  5099 12803 10344 12733 11674   152
  13448 14376]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.045 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.044  287.044 simple.py:52(score)
        3    0.000    0.000  287.041   95.680 profilehooks.py:257(new_fn)
        3    0.137    0.046  287.041   95.680 profilehooks.py:348(__call__)
        3    0.002    0.001  286.066   95.355 kb.py:122(neighbors)
        9  285.313   31.701  285.314   31.702 nms.py:31(build)
        2    0.090    0.045  192.082   96.041 kb.py:75(score)
        1    0.000    0.000   94.875   94.875 simple.py:29(hop)
        1    0.069    0.069   94.822   94.822 kb.py:156(forward)
       18    1.016    0.056    1.016    0.056 {built-in method cat}
    18/15    0.001    0.000    0.225    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.223    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.222    0.017 functional.py:1774(embedding)
       13    0.222    0.017    0.222    0.017 {built-in method embedding}
        3    0.000    0.000    0.222    0.074 kb.py:68(generate_facts)
        3    0.177    0.059    0.178    0.059 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.588 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.588  288.588 simple.py:52(score)
        3    0.000    0.000  288.583   96.194 profilehooks.py:257(new_fn)
        3    0.135    0.045  288.583   96.194 profilehooks.py:348(__call__)
        3    0.002    0.001  287.657   95.886 kb.py:122(neighbors)
        9  286.939   31.882  286.941   31.882 nms.py:31(build)
        2    0.087    0.044  192.105   96.053 kb.py:75(score)
        1    0.000    0.000   96.397   96.397 simple.py:29(hop)
        1    0.069    0.069   96.344   96.344 kb.py:156(forward)
       18    0.934    0.052    0.934    0.052 {built-in method cat}
    18/15    0.001    0.000    0.227    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.224    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.223    0.017 functional.py:1774(embedding)
       13    0.223    0.017    0.223    0.017 {built-in method embedding}
        3    0.000    0.000    0.223    0.074 kb.py:68(generate_facts)
        3    0.178    0.059    0.179    0.060 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  739 14276  5964 11320    68 14280 11259
  10726 10425 13939 10638  1805  6554 13117
  11151 13129 10192 13752 13950  1010  8214
  12761  7183 14441  4473  4074 14502  3576
  10650  1640  8335 13140  5930 14279  5097
  11377  7930  2464  5903  6295  5697 12882
  10788 12521  4611  9543 10865  6650  6613
  13990 10782  3187  3816    60  4730 10575
  10189 11723 14500 14047  5054  1448 13540
   3709  7742  7474 11253  2547  7700 12639
   7791  1639  9123 13164 14499    62 14120
   9281   640 10955  6118 10732 10810 13976
  13201    73  9340  7164 11311  5904 13097
   6976  4002  2978 12891   733  3192  3632
  13312 14005]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.886 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.886  288.886 simple.py:52(score)
        3    0.000    0.000  288.883   96.294 profilehooks.py:257(new_fn)
        3    0.131    0.044  288.883   96.294 profilehooks.py:348(__call__)
        3    0.002    0.001  288.074   96.025 kb.py:122(neighbors)
        9  287.418   31.935  287.419   31.935 nms.py:31(build)
        2    0.084    0.042  192.313   96.157 kb.py:75(score)
        1    0.000    0.000   96.491   96.491 simple.py:29(hop)
        1    0.066    0.066   96.438   96.438 kb.py:156(forward)
       18    0.855    0.048    0.855    0.048 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.125    0.042    0.125    0.042 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.410 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.410  288.410 simple.py:52(score)
        3    0.000    0.000  288.406   96.135 profilehooks.py:257(new_fn)
        3    0.132    0.044  288.406   96.135 profilehooks.py:348(__call__)
        3    0.002    0.001  287.578   95.859 kb.py:122(neighbors)
        9  286.934   31.882  286.936   31.882 nms.py:31(build)
        2    0.085    0.042  192.687   96.343 kb.py:75(score)
        1    0.000    0.000   95.640   95.640 simple.py:29(hop)
        1    0.067    0.067   95.587   95.587 kb.py:156(forward)
       18    0.862    0.048    0.862    0.048 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.111    0.037    0.112    0.037 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 4414 10094 11253 10433  2493  6295  7731
  11151  1805 10218  2843 14442  1448 10429
  12548 10189 14032  5658  5964  6169  7379
  14031  7876 13326  4611 13993   739  5004
   4473  8252  1637 14276  2288  4730 12375
    549 13204  7080 10136   935 13755  7584
   1531  1704  6976   738   288 10865  4484
    736 12530  7743  7700 14495  8211   666
  10782 13976  3923 11377  3192  6554  1528
   1010 10575  2464  8331  5903  4924  9844
  13238   761 14274  4951 13577  8788  1851
  13329  4132  3504  5904 14124  7183  1908
   6118   572   669  3992 10781 13949  4686
   4114   131 14505  5966  8506  2437 11723
    747  4188]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.608 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.608  287.608 simple.py:52(score)
        3    0.000    0.000  287.604   95.868 profilehooks.py:257(new_fn)
        3    0.138    0.046  287.604   95.868 profilehooks.py:348(__call__)
        3    0.002    0.001  286.753   95.584 kb.py:122(neighbors)
        9  286.024   31.780  286.026   31.781 nms.py:31(build)
        2    0.086    0.043  191.531   95.766 kb.py:75(score)
        1    0.000    0.000   95.995   95.995 simple.py:29(hop)
        1    0.089    0.089   95.935   95.935 kb.py:156(forward)
       18    0.877    0.049    0.877    0.049 {built-in method cat}
        3    0.189    0.063    0.190    0.063 nms.py:51(query)
    18/15    0.001    0.000    0.188    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.185    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.185    0.014 functional.py:1774(embedding)
       13    0.185    0.014    0.185    0.014 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.054 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.054  289.054 simple.py:52(score)
        3    0.000    0.000  289.050   96.350 profilehooks.py:257(new_fn)
        3    0.136    0.045  289.050   96.350 profilehooks.py:348(__call__)
        3    0.002    0.001  288.207   96.069 kb.py:122(neighbors)
        9  287.467   31.941  287.469   31.941 nms.py:31(build)
        2    0.086    0.043  192.619   96.310 kb.py:75(score)
        1    0.000    0.000   96.352   96.352 simple.py:29(hop)
        1    0.071    0.071   96.294   96.294 kb.py:156(forward)
       18    0.899    0.050    0.899    0.050 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.178    0.059    0.179    0.060 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 2232  5125  1013  1014   700  1848  8292
   3371  2754  8823  1545  1334  1746  4125
   1645  7611 11327  8841 10708  7408  9692
   2445  3344   887 13556 12651  3163  8022
   8536   241  9265 11175  6766  6335  2265
  11984  6178  6010  3953  3110  6047  1340
   3221 13557   612 12707  5896  2443  1680
  13214  1886  1345  4541 12765   701  4615
   5085 10864  1079  4610  6031 12174  4464
   6415  5573 11979  2610  6362  1862  2762
   3286  2261  8088  2888  7288  9743  2930
    536   995   907  2645  8740  2979  4252
  11770  4077  1890  5111 11441  2479  7781
   2238  5740  1980  7207   732  9497 10828
  11065  5605]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.262 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.262  289.262 simple.py:52(score)
        3    0.000    0.000  289.259   96.420 profilehooks.py:257(new_fn)
        3    0.132    0.044  289.259   96.420 profilehooks.py:348(__call__)
        3    0.002    0.001  288.433   96.144 kb.py:122(neighbors)
        9  287.791   31.977  287.793   31.977 nms.py:31(build)
        2    0.086    0.043  192.927   96.463 kb.py:75(score)
        1    0.000    0.000   96.252   96.252 simple.py:29(hop)
        1    0.072    0.072   96.199   96.199 kb.py:156(forward)
       18    0.902    0.050    0.902    0.050 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.068    0.023    0.068    0.023 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.449 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.449  289.449 simple.py:52(score)
        3    0.000    0.000  289.445   96.482 profilehooks.py:257(new_fn)
        3    0.132    0.044  289.445   96.482 profilehooks.py:348(__call__)
        3    0.002    0.001  288.652   96.217 kb.py:122(neighbors)
        9  287.956   31.995  287.958   31.995 nms.py:31(build)
        2    0.087    0.044  192.878   96.439 kb.py:75(score)
        1    0.000    0.000   96.487   96.487 simple.py:29(hop)
        1    0.068    0.068   96.435   96.435 kb.py:156(forward)
       18    0.846    0.047    0.846    0.047 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.146    0.049    0.147    0.049 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 8811  5162  3672 12956 11832 10170 14506
  12536 12634  2066  3841  8786 11671 14277
  12672 12405  9687 13750  8667 11481 12350
  13991  7547 10822  8697 11027  4359  9050
  10727 10968 12513 12927 11297  4791  7122
  10518  9467 12160  7605  8849 11687 12410
  11241  6985  8257 12478 12357 11427 10785
   1482  9645  5956 11688  8387  6842    67
  12669    69 12925  8818 14123  9784  6830
   6315  8645  5995  4388 13161  2504  6518
  10884  9751  6949  4657  5170  5631 12755
  11025  1574  7185  9683  3797  9177 13133
  11653 10964  4826  1462  6432 10878 10962
  12166 10229 10616  2462  4963 13589 11396
   8652 11020]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.182 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.182  288.182 simple.py:52(score)
        3    0.000    0.000  288.178   96.059 profilehooks.py:257(new_fn)
        3    0.138    0.046  288.178   96.059 profilehooks.py:348(__call__)
        3    0.002    0.001  287.314   95.771 kb.py:122(neighbors)
        9  286.564   31.840  286.566   31.841 nms.py:31(build)
        2    0.119    0.059  192.106   96.053 kb.py:75(score)
        1    0.000    0.000   95.974   95.974 simple.py:29(hop)
        1    0.043    0.043   95.934   95.934 kb.py:156(forward)
       18    0.913    0.051    0.913    0.051 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.185    0.062    0.186    0.062 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.218 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.218  289.218 simple.py:52(score)
        3    0.000    0.000  289.215   96.405 profilehooks.py:257(new_fn)
        3    0.141    0.047  289.214   96.405 profilehooks.py:348(__call__)
        3    0.002    0.001  288.352   96.117 kb.py:122(neighbors)
        9  287.612   31.957  287.613   31.957 nms.py:31(build)
        2    0.120    0.060  191.983   95.992 kb.py:75(score)
        1    0.000    0.000   97.131   97.131 simple.py:29(hop)
        1    0.044    0.044   97.090   97.090 kb.py:156(forward)
       18    0.918    0.051    0.918    0.051 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.168    0.056    0.169    0.056 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 4305  5274  6197  8229  4412  5270  4931
   8129  4925  8692 12080  4917  5269 11819
  10545  4966  5268  4921  5275 10370  4303
  10655  4300 12172  4918 10367 10665  4677
   5281  9559 12574 10666  8052  8767  6203
  10366 10368  8696  6201 10371  8695  5311
  10605 10376  3765  4771  4891  3748  5284
  12018  4903  4967 12170  6359  4908 12559
  10675  7535  4763  7322  4299 10609 10304
   8450  8481 10635 12118  5382  8134  4890
   4888  9535  3720 10647 10672  5351  7982
   7510  8690  8775 12570 11190 12171  8449
   5213  8694  7981  1047  5952  5287  7527
   4804  4919 12920  3978 10674 12844   982
  13965  9675]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.738 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.738  288.738 simple.py:52(score)
        3    0.000    0.000  288.735   96.245 profilehooks.py:257(new_fn)
        3    0.138    0.046  288.735   96.245 profilehooks.py:348(__call__)
        3    0.002    0.001  287.935   95.978 kb.py:122(neighbors)
        9  287.189   31.910  287.191   31.910 nms.py:31(build)
        2    0.112    0.056  191.384   95.692 kb.py:75(score)
        1    0.000    0.000   97.251   97.251 simple.py:29(hop)
        1    0.041    0.041   97.212   97.212 kb.py:156(forward)
       18    0.876    0.049    0.876    0.049 {built-in method cat}
    18/15    0.001    0.000    0.188    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.185    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.185    0.014 functional.py:1774(embedding)
       13    0.185    0.014    0.185    0.014 {built-in method embedding}
        3    0.178    0.059    0.179    0.060 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.565 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.565  289.565 simple.py:52(score)
        3    0.000    0.000  289.561   96.520 profilehooks.py:257(new_fn)
        3    0.133    0.044  289.561   96.520 profilehooks.py:348(__call__)
        3    0.002    0.001  288.739   96.246 kb.py:122(neighbors)
        9  288.020   32.002  288.022   32.002 nms.py:31(build)
        2    0.087    0.044  192.743   96.371 kb.py:75(score)
        1    0.000    0.000   96.739   96.739 simple.py:29(hop)
        1    0.069    0.069   96.686   96.686 kb.py:156(forward)
       18    0.869    0.048    0.869    0.048 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
        3    0.175    0.058    0.175    0.058 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 9553  9909   541  3430  4849  1292 12524
   6393 10589  7279  4103  7717  9169 12783
   3231  9055   825  7810 10402 10037 11169
  13492 12800  3962  1732  7718  4797  9322
    926 12838 13405 13137 11590  7458  3106
  13123  4669  9929  6434  7323  4310 11731
   1698  5308  1779 14063 13742  9752 12875
  12294  6184 11525 13313  1539 13250  8525
  13739  5392  6036  9741   879  6266  8527
   1741  1978  6423 10620 10558  2330 11623
  13874  7735  2315  5034  5193  4742  8833
  11043  5658  2843 10522  8298  4990   582
   7284  8889  9462  8556  7176  3113  6333
  10322  3392 10128   170  5299  9693  8787
   8453  3762]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.959 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.959  289.959 simple.py:52(score)
        3    0.000    0.000  289.955   96.652 profilehooks.py:257(new_fn)
        3    0.140    0.047  289.955   96.652 profilehooks.py:348(__call__)
        3    0.002    0.001  289.111   96.370 kb.py:122(neighbors)
        9  288.386   32.043  288.388   32.043 nms.py:31(build)
        2    0.085    0.042  193.272   96.636 kb.py:75(score)
        1    0.000    0.000   96.602   96.602 simple.py:29(hop)
        1    0.081    0.081   96.542   96.542 kb.py:156(forward)
       18    0.884    0.049    0.884    0.049 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.164    0.055    0.165    0.055 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.820 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.820  288.820 simple.py:52(score)
        3    0.000    0.000  288.816   96.272 profilehooks.py:257(new_fn)
        3    0.140    0.047  288.816   96.272 profilehooks.py:348(__call__)
        3    0.002    0.001  288.006   96.002 kb.py:122(neighbors)
        9  287.336   31.926  287.338   31.926 nms.py:31(build)
        2    0.094    0.047  192.821   96.411 kb.py:75(score)
        1    0.000    0.000   95.910   95.910 simple.py:29(hop)
        1    0.064    0.064   95.856   95.856 kb.py:156(forward)
       18    0.845    0.047    0.845    0.047 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.132    0.044    0.132    0.044 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.001    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[12009 14031   456  4174  7882 12300  6669
   3991  9836   817  3391  3699  6380   554
   5070  7368  7816 11987 12210  5087  5911
   6295  1338 11419  7543  2546 12682  6331
   2828  8880  5373 14032  7216 10783  9221
   4788  3709  4736  4857  4114  7072 12074
  10626  8252 11594 11906 11723 10986  5011
    549  8621  8240  9394  8685  1979  9852
   9668  5223  8558 14274  7822 10094 11734
   8603 11184  9316   774  8517  8771 13329
    935  5582  3923 11589  4132  1908 14119
   4841  8002  8565  6637  9070  5703  3713
   7721  5632  1704 10218 13993 12004  9223
   3774  9731   131  9904  9739 10078 12026
  11677  1710]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.486 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.486  290.486 simple.py:52(score)
        3    0.000    0.000  290.482   96.827 profilehooks.py:257(new_fn)
        3    0.139    0.046  290.482   96.827 profilehooks.py:348(__call__)
        3    0.002    0.001  289.632   96.544 kb.py:122(neighbors)
        9  288.970   32.108  288.972   32.108 nms.py:31(build)
        2    0.117    0.059  193.335   96.668 kb.py:75(score)
        1    0.000    0.000   97.048   97.048 simple.py:29(hop)
        1    0.042    0.042   97.008   97.008 kb.py:156(forward)
       18    0.888    0.049    0.888    0.049 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
        3    0.111    0.037    0.112    0.037 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.223 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.223  290.223 simple.py:52(score)
        3    0.000    0.000  290.219   96.740 profilehooks.py:257(new_fn)
        3    0.141    0.047  290.219   96.740 profilehooks.py:348(__call__)
        3    0.002    0.001  289.357   96.452 kb.py:122(neighbors)
        9  288.684   32.076  288.686   32.076 nms.py:31(build)
        2    0.124    0.062  194.127   97.063 kb.py:75(score)
        1    0.000    0.000   95.993   95.993 simple.py:29(hop)
        1    0.047    0.047   95.952   95.952 kb.py:156(forward)
       18    0.878    0.049    0.878    0.049 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.139    0.046    0.140    0.047 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[13485    12  3934  9360 11261 11155 13257
  12163 14454   266 14416 12016  7340 14417
    276 10723 12240 14109 11940 11638 14297
  14350  4379 11732 14242 14446 14137 14258
  13464 14515  1189 14413 10378  2036 13952
   1915 11905 12760 14295 13230  5902 14233
   7410  3228    24 14305  6995 13745 14514
  13812 14219 14447 14237 12014     1  2034
  14449 10393 14398 13826 14111 14154 12242
  13002   606     5 14245 14349 13986 14156
  11242 14241   275  2528 14160 10721 12267
  14337 14286 14062 11758 13538 14364 10749
  14191 12239 14365 10719 14414 14189 14304
  14353 14363 13654   219 14187 11943 14070
  14256    19]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.635 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.635  289.635 simple.py:52(score)
        3    0.000    0.000  289.631   96.544 profilehooks.py:257(new_fn)
        3    0.136    0.045  289.631   96.544 profilehooks.py:348(__call__)
        3    0.002    0.001  288.739   96.246 kb.py:122(neighbors)
        9  288.096   32.011  288.098   32.011 nms.py:31(build)
        2    0.115    0.057  192.527   96.264 kb.py:75(score)
        1    0.000    0.000   97.009   97.009 simple.py:29(hop)
        1    0.044    0.044   96.968   96.968 kb.py:156(forward)
       18    0.938    0.052    0.938    0.052 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.087    0.029    0.088    0.029 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.828 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.828  289.828 simple.py:52(score)
        3    0.000    0.000  289.824   96.608 profilehooks.py:257(new_fn)
        3    0.152    0.051  289.824   96.608 profilehooks.py:348(__call__)
        3    0.002    0.001  288.892   96.297 kb.py:122(neighbors)
        9  288.181   32.020  288.183   32.020 nms.py:31(build)
        2    0.143    0.071  193.297   96.648 kb.py:75(score)
        1    0.000    0.000   96.415   96.415 simple.py:29(hop)
        1    0.042    0.042   96.375   96.375 kb.py:156(forward)
       18    0.919    0.051    0.919    0.051 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.181    0.060    0.182    0.061 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  227  2612  1377   849 14477  1249  9863
   4540 14459  5760  4741  2394  1361  1152
   1678  7457 10396  4666 14472  5204   468
  13946  1317   373  3034  1558   134  3323
   5667 10766  9980  5137  3798   144  1449
   1238  3311  1693  1201  9187  7093 10490
   4079 14473  5413  9359  1231 11004  4208
   1816   355  2634 14478  5480 10312  1968
   1213  9861  2167   323  2176  3836  1171
   9829   127  8890  7316 14466  1711  8419
   2909  6742  2254  8571   815 13029 14469
   1551  2310  1144  3540  2360    38  9845
    192 13596 12666  5375  8830  8909  1404
   1399 13386  3020  5759  3082  3008  1918
  13087  4648]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.965 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.965  289.965 simple.py:52(score)
        3    0.000    0.000  289.961   96.654 profilehooks.py:257(new_fn)
        3    0.146    0.049  289.961   96.654 profilehooks.py:348(__call__)
        3    0.002    0.001  289.081   96.360 kb.py:122(neighbors)
        9  288.399   32.044  288.401   32.045 nms.py:31(build)
        2    0.118    0.059  193.110   96.555 kb.py:75(score)
        1    0.000    0.000   96.747   96.747 simple.py:29(hop)
        1    0.044    0.044   96.705   96.705 kb.py:156(forward)
       18    0.947    0.053    0.947    0.053 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.191    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
       13    0.191    0.015    0.191    0.015 {built-in method embedding}
        3    0.099    0.033    0.099    0.033 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.113 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.113  289.113 simple.py:52(score)
        3    0.000    0.000  289.109   96.370 profilehooks.py:257(new_fn)
        3    0.147    0.049  289.109   96.370 profilehooks.py:348(__call__)
        3    0.002    0.001  288.125   96.042 kb.py:122(neighbors)
        9  287.408   31.934  287.409   31.934 nms.py:31(build)
        2    0.117    0.058  192.138   96.069 kb.py:75(score)
        1    0.000    0.000   96.869   96.869 simple.py:29(hop)
        1    0.042    0.042   96.824   96.824 kb.py:156(forward)
       18    1.009    0.056    1.009    0.056 {built-in method cat}
    18/15    0.001    0.000    0.215    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.212    0.071 kb.py:68(generate_facts)
        3    0.158    0.053    0.158    0.053 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 5781 12228 12549  1580 12997 13064 12563
  13484 12883 12826  9994 12395 11764 12784
   1028   443 11394 12792  3911    96  1490
  12890 13509   901 12971  9766  3119 12909
  11949  2436  8672 11717 13337  3898  2823
  13617  2019 12295 12137  8442 13370  3397
  12205 12139  8321 13601  7949  3160  4418
  11733 10538 11033 11291 13618 12216 12134
  12086  3959  1342  7249 13345 11487  3955
    155  3142    82  7640  6835 11842  7932
  11719   805  9395    41  6678  2967  4105
  11864   597 11237 12657 11488  1367 13553
    594  2802 11697  2459  7248 14092   201
   7247   806 11220 12541 13430  7944  2260
   6689  1474]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.990 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.990  288.990 simple.py:52(score)
        3    0.000    0.000  288.986   96.329 profilehooks.py:257(new_fn)
        3    0.139    0.046  288.986   96.329 profilehooks.py:348(__call__)
        3    0.002    0.001  288.070   96.023 kb.py:122(neighbors)
        9  287.420   31.936  287.422   31.936 nms.py:31(build)
        2    0.116    0.058  191.830   95.915 kb.py:75(score)
        1    0.000    0.000   97.057   97.057 simple.py:29(hop)
        1    0.043    0.043   97.017   97.017 kb.py:156(forward)
       18    0.921    0.051    0.921    0.051 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
        3    0.133    0.044    0.134    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.073 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.073  291.073 simple.py:52(score)
        3    0.000    0.000  291.069   97.023 profilehooks.py:257(new_fn)
        3    0.141    0.047  291.069   97.023 profilehooks.py:348(__call__)
        3    0.002    0.001  290.254   96.751 kb.py:122(neighbors)
        9  289.565   32.174  289.567   32.174 nms.py:31(build)
        2    0.122    0.061  193.611   96.805 kb.py:75(score)
        1    0.000    0.000   97.357   97.357 simple.py:29(hop)
        1    0.043    0.043   97.317   97.317 kb.py:156(forward)
       18    0.854    0.047    0.854    0.047 {built-in method cat}
    18/15    0.001    0.000    0.188    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.185    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.185    0.014 functional.py:1774(embedding)
       13    0.185    0.014    0.185    0.014 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.142    0.047    0.143    0.048 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  982 12570  7981 12578  6359 13206 13965
  12574 12595 10655  5275 10672  8692 12567
   3978 10370 10366  5274 12576 10671  5270
   4412  4925 12562  4305  4966 12635 13425
   6197  4917  4931 12172 11819   984  4891
   4796 11516  7133  4802  3458  5269  4734
  12080  1274  4272 10665  5304 12740 12579
   4908 12920 12597  4287 12118  9678  3461
  10545  4921  6427 12561  3460  6493 12572
   4269 12569  3720 12580  4733  7982  5271
   5502  4273  5268  4353  3660  4919  4804
  12575  7527  4799 12560 10647 10666 10605
   4911 10675 10377  4271  3773 12559  3401
   9675  3444  6418  4386  6475 12170  4890
   4303  3459]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.644 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.644  289.644 simple.py:52(score)
        3    0.000    0.000  289.640   96.547 profilehooks.py:257(new_fn)
        3    0.166    0.055  289.640   96.547 profilehooks.py:348(__call__)
        3    0.002    0.001  288.606   96.202 kb.py:122(neighbors)
        9  287.873   31.986  287.875   31.986 nms.py:31(build)
        2    0.120    0.060  193.203   96.601 kb.py:75(score)
        1    0.000    0.000   96.343   96.343 simple.py:29(hop)
        1    0.046    0.046   96.271   96.271 kb.py:156(forward)
       18    1.080    0.060    1.080    0.060 {built-in method cat}
    18/15    0.001    0.000    0.268    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.265    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.264    0.020 functional.py:1774(embedding)
       13    0.264    0.020    0.264    0.020 {built-in method embedding}
        3    0.000    0.000    0.262    0.087 kb.py:68(generate_facts)
        3    0.071    0.024    0.072    0.024 nms.py:51(query)
        3    0.003    0.001    0.006    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method exp}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.178 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.178  291.178 simple.py:52(score)
        3    0.000    0.000  291.174   97.058 profilehooks.py:257(new_fn)
        3    0.137    0.046  291.173   97.058 profilehooks.py:348(__call__)
        3    0.002    0.001  290.260   96.753 kb.py:122(neighbors)
        9  289.603   32.178  289.605   32.178 nms.py:31(build)
        2    0.111    0.056  194.263   97.132 kb.py:75(score)
        1    0.000    0.000   96.815   96.815 simple.py:29(hop)
        1    0.045    0.045   96.773   96.773 kb.py:156(forward)
       18    0.954    0.053    0.954    0.053 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
        3    0.112    0.037    0.113    0.038 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[11680 12777  4920  9589 12615 12489 11653
   9687 12477 10822  9774 10964  6842 12485
   5170  3672  8697 11182 11444  6428 11834
   4090 12410 10473  5189 11511  9656 13100
  12925 10229  7053  7122 10662 12810 12476
  12619 10481  8667  7298  4212  6379 12618
  12645  5244 11102 12648  6315  9946 11411
  11752 12650  9387 12367  8780  7231  7126
  12684 10676 11808  8479  6621  9327  5139
   6130 12166 11103  3841  3355 11413 11052
   5731  8140 12664  9958  7827  9260  6773
   9751 12168  6810 13026 13316  4359  5553
  10904 12674  6990  6902 10646  8470  9230
  10670 12459 10042 10166 10991 11399 12703
  11415 12527]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.000 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.000  290.000 simple.py:52(score)
        3    0.000    0.000  289.996   96.665 profilehooks.py:257(new_fn)
        3    0.151    0.050  289.996   96.665 profilehooks.py:348(__call__)
        3    0.002    0.001  289.111   96.370 kb.py:122(neighbors)
        9  288.495   32.055  288.497   32.055 nms.py:31(build)
        2    0.117    0.059  193.730   96.865 kb.py:75(score)
        1    0.000    0.000   96.165   96.165 simple.py:29(hop)
        1    0.041    0.041   96.115   96.115 kb.py:156(forward)
       18    0.906    0.050    0.906    0.050 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.076    0.025    0.077    0.026 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.093 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.093  290.093 simple.py:52(score)
        3    0.000    0.000  290.088   96.696 profilehooks.py:257(new_fn)
        3    0.125    0.042  290.088   96.696 profilehooks.py:348(__call__)
        3    0.002    0.001  289.237   96.412 kb.py:122(neighbors)
        9  288.523   32.058  288.525   32.058 nms.py:31(build)
        2    0.086    0.043  193.704   96.852 kb.py:75(score)
        1    0.000    0.000   96.299   96.299 simple.py:29(hop)
        1    0.045    0.045   96.258   96.258 kb.py:156(forward)
       18    0.953    0.053    0.953    0.053 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.199    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.141    0.047    0.142    0.047 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.001 base.py:142(forward)
        2    0.000    0.000    0.003    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.003    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 4305  5274  5270  4412  5275  6197  4925
   8692  4917  4931 12574 10366  5269  5268
  10370 11819  4966 12172 12080 10655  6359
   8129  4677  4918 12570 10367  4921  8229
   6201 10665 10545  7981  6203 10605  4771
  12562  7322 10672  4300 13965 10368  7982
  13206   982 10666  4303 12018 10635  8052
   8696  3765 12170  4891 12595 10376 12578
  10609  4903 12576 10371 13425 10304  1047
  10675 10647  5281  8695  8767  3978  9559
   4763  5311  3748  4967  5284 12559 12118
   7510  4908  8450 12597 10671 12579  7535
   9678  3720  5351  5271 12560  5382  8690
  12920  7527  8481 12171  4299 11190  4888
  10377  4890]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.168 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.168  290.168 simple.py:52(score)
        3    0.000    0.000  290.164   96.721 profilehooks.py:257(new_fn)
        3    0.142    0.047  290.164   96.721 profilehooks.py:348(__call__)
        3    0.002    0.001  289.273   96.424 kb.py:122(neighbors)
        9  288.524   32.058  288.526   32.058 nms.py:31(build)
        2    0.103    0.051  192.758   96.379 kb.py:75(score)
        1    0.000    0.000   97.317   97.317 simple.py:29(hop)
        1    0.057    0.057   97.265   97.265 kb.py:156(forward)
       18    0.939    0.052    0.939    0.052 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.190    0.063    0.191    0.064 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.952 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.952  291.952 simple.py:52(score)
        3    0.000    0.000  291.948   97.316 profilehooks.py:257(new_fn)
        3    0.142    0.047  291.948   97.316 profilehooks.py:348(__call__)
        3    0.002    0.001  291.058   97.019 kb.py:122(neighbors)
        9  290.380   32.264  290.381   32.265 nms.py:31(build)
        2    0.119    0.059  194.888   97.444 kb.py:75(score)
        1    0.000    0.000   96.957   96.957 simple.py:29(hop)
        1    0.041    0.041   96.918   96.918 kb.py:156(forward)
       18    0.913    0.051    0.913    0.051 {built-in method cat}
    18/15    0.001    0.000    0.207    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.204    0.016 functional.py:1774(embedding)
       13    0.204    0.016    0.204    0.016 {built-in method embedding}
        3    0.000    0.000    0.203    0.068 kb.py:68(generate_facts)
        3    0.134    0.045    0.134    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 6929  3052   165   369  5732  5571  5850
   5626 12868 10853  2311  2412  7946   296
  13015 12623  1544 13305  3840 10145  6608
    164  1458  9449  4389  9052  3626  2130
   7761  1159  7480  7378 10351  7509   765
  10329  7806 12109  5475  5478 12748  8179
   6567  9113  4254  7956 12624 11138  2698
  14009  6609  3948  8668 10786  9391 10350
   7326  9986  6954 13369  7764  2217  8386
   4943  9971 11178  7192  3581   154  2342
   4986  8928  1190  3826 13417  4527 11583
  12999  7719  8714  2656 11647  2270 12873
    507  9078  9311  8400   171 11477  4260
  10167  3482  7819  7925   508  7513 11539
    812 12441]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.410 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.410  290.410 simple.py:52(score)
        3    0.000    0.000  290.406   96.802 profilehooks.py:257(new_fn)
        3    0.133    0.044  290.406   96.802 profilehooks.py:348(__call__)
        3    0.002    0.001  289.573   96.524 kb.py:122(neighbors)
        9  288.830   32.092  288.832   32.092 nms.py:31(build)
        2    0.087    0.044  194.096   97.048 kb.py:75(score)
        1    0.000    0.000   96.228   96.228 simple.py:29(hop)
        1    0.062    0.062   96.177   96.177 kb.py:156(forward)
       18    0.940    0.052    0.940    0.052 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.186    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.186    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.331 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.331  289.331 simple.py:52(score)
        3    0.000    0.000  289.327   96.442 profilehooks.py:257(new_fn)
        3    0.133    0.044  289.327   96.442 profilehooks.py:348(__call__)
        3    0.002    0.001  288.486   96.162 kb.py:122(neighbors)
        9  287.774   31.975  287.776   31.975 nms.py:31(build)
        2    0.107    0.053  192.344   96.172 kb.py:75(score)
        1    0.000    0.000   96.892   96.892 simple.py:29(hop)
        1    0.047    0.047   96.851   96.851 kb.py:156(forward)
       18    0.873    0.049    0.873    0.049 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.183    0.061    0.183    0.061 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


[[ 9472  9197  1561  3207  6866  4555  9839
   1681  1001 14397  9532  7838 12798  5080
   5581  5630 13063 13967  6657  2112 13511
   8173  7866   105  9912  4874 12583   655
  10188  8728  2454  5936  8573  5369   543
   9782  4607  9572  7941 13567  6548  1017
    781  6039  5782 12281  2907 14422  2021
   6258  1591  1282  6723  9783   769  8524
   6649  2033 11757  6406   775  3937   332
   5378  1469 11497 13872   994  1475  5123
    786  3115  7596 10330  8902   721  7648
  13109  1672  4998  4171  4757  8336  2521
   8649   773 10843  1176  5367  3583  8320
  12050   780  5205 11769  1130  3941  3338
   9593  2897]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.547 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.547  291.547 simple.py:52(score)
        3    0.000    0.000  291.544   97.181 profilehooks.py:257(new_fn)
        3    0.120    0.040  291.544   97.181 profilehooks.py:348(__call__)
        3    0.002    0.001  290.651   96.884 kb.py:122(neighbors)
        9  289.926   32.214  289.928   32.214 nms.py:31(build)
        2    0.087    0.043  194.363   97.181 kb.py:75(score)
        1    0.000    0.000   97.101   97.101 simple.py:29(hop)
        1    0.044    0.044   97.061   97.061 kb.py:156(forward)
       18    0.989    0.055    0.989    0.055 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
        3    0.171    0.057    0.171    0.057 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.001    0.001 base.py:142(forward)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.769 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.769  288.769 simple.py:52(score)
        3    0.000    0.000  288.766   96.255 profilehooks.py:257(new_fn)
        3    0.134    0.045  288.766   96.255 profilehooks.py:348(__call__)
        3    0.002    0.001  287.971   95.990 kb.py:122(neighbors)
        9  287.279   31.920  287.281   31.920 nms.py:31(build)
        2    0.111    0.055  191.964   95.982 kb.py:75(score)
        1    0.000    0.000   96.708   96.708 simple.py:29(hop)
        1    0.044    0.044   96.668   96.668 kb.py:156(forward)
       18    0.842    0.047    0.842    0.047 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.190    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
       13    0.190    0.015    0.190    0.015 {built-in method embedding}
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.000    0.000    0.000    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 9819 12966  1763 11904  8370  8631 13386
   1812 11927  2120  2336   815  9876  2857
   8973  1811 12396  9811 13028  1725  2343
   5195  1813   560   521  2167  9855  9562
   1764   147  4344 14039  1810  2274  2415
   1800  6633 10766  2395  2544  2713  2132
   6620   893  3798  1669  2299  3234  7199
   3547 12797  4291  5342  3832 11082  9850
   2286  1930   478  2627  1762 13304 14314
  11217  9857  1436  9481  1425   169  5760
    859  8419  5783  3316  1761  5012  7428
   4648  3293  3395 12332  1045 10632  4809
   5375  1799  4590  3695  2318  3020  4116
   1815  5770  2394  3292  5414  9861  2316
   9823  4268]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.406 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.406  291.406 simple.py:52(score)
        3    0.000    0.000  291.403   97.134 profilehooks.py:257(new_fn)
        3    0.140    0.047  291.403   97.134 profilehooks.py:348(__call__)
        3    0.002    0.001  290.600   96.867 kb.py:122(neighbors)
        9  289.904   32.212  289.905   32.212 nms.py:31(build)
        2    0.085    0.043  194.489   97.244 kb.py:75(score)
        1    0.000    0.000   96.834   96.834 simple.py:29(hop)
        1    0.076    0.076   96.774   96.774 kb.py:156(forward)
       18    0.833    0.046    0.833    0.046 {built-in method cat}
    18/15    0.001    0.000    0.189    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.187    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.186    0.014    0.186    0.014 {built-in method embedding}
        3    0.163    0.054    0.163    0.054 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.985 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.985  292.985 simple.py:52(score)
        3    0.000    0.000  292.981   97.660 profilehooks.py:257(new_fn)
        3    0.143    0.048  292.981   97.660 profilehooks.py:348(__call__)
        3    0.002    0.001  292.130   97.377 kb.py:122(neighbors)
        9  291.413   32.379  291.414   32.379 nms.py:31(build)
        2    0.085    0.042  195.520   97.760 kb.py:75(score)
        1    0.000    0.000   97.379   97.379 simple.py:29(hop)
        1    0.077    0.077   97.319   97.319 kb.py:156(forward)
       18    0.869    0.048    0.869    0.048 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.185    0.062    0.186    0.062 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[11746 14396 11498  8609  8094  6336  1130
   1485    33   657  1282  5363 10176   629
  13513 10561  5291 13063  8521   721   775
   5080 14433 13614  9472  9794  8173  5970
   6258 11757  9197 10148 12050  3708  8336
   1561   105  8911   742    95   513  6657
   8160  8935 14397  9984  4555  4498  9839
   9572 12798 12583 14422  4840  4874  8320
   5868   444 11769  6723 10511 13109   183
    655  9532  1001   627  3941  5782 10555
  10610  1500 12463  8344  1591  3937  5199
   8861  3243  6366   553  9915  5123  8934
  12607 12327  1681 10843  1475   773  4075
  12692  2897 11497 11041 13546 13967  2026
  13422 12679]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.751 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.751  291.751 simple.py:52(score)
        3    0.000    0.000  291.747   97.249 profilehooks.py:257(new_fn)
        3    0.137    0.046  291.747   97.249 profilehooks.py:348(__call__)
        3    0.002    0.001  290.931   96.977 kb.py:122(neighbors)
        9  290.227   32.247  290.229   32.248 nms.py:31(build)
        2    0.117    0.058  194.525   97.262 kb.py:75(score)
        1    0.000    0.000   97.126   97.126 simple.py:29(hop)
        1    0.044    0.044   97.085   97.085 kb.py:156(forward)
       18    0.839    0.047    0.839    0.047 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.179    0.060    0.179    0.060 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.697 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.697  291.697 simple.py:52(score)
        3    0.000    0.000  291.694   97.231 profilehooks.py:257(new_fn)
        3    0.122    0.041  291.694   97.231 profilehooks.py:348(__call__)
        3    0.002    0.001  290.909   96.970 kb.py:122(neighbors)
        9  290.164   32.240  290.166   32.241 nms.py:31(build)
        2    0.085    0.042  194.809   97.404 kb.py:75(score)
        1    0.000    0.000   96.803   96.803 simple.py:29(hop)
        1    0.045    0.045   96.763   96.763 kb.py:156(forward)
       18    0.870    0.048    0.870    0.048 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.199    0.015 functional.py:1774(embedding)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
        3    0.193    0.064    0.194    0.065 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[11341 10299 11630 14356  4372  4161  4283
   9104  5384  9372 14013  1447 11941  1337
   1988  5065 13186   794  8379   310  9263
  11910  5815 10115  7197  8657 12130  7939
   1007  4147 13219 13356 12079 11672 11946
   6212 10038  8018  6282 12378  9292 12739
  12766  8918 11785 12267 14255  6995 12240
  11905 12255 13230 13840 12262 12852 11598
  11599  9973 13745  8857 11261  2526  9534
    445 12238  6300  4408 14090  1062 14516
  11155  9051 10393  4432 12242  9711 11889
  12239 12260  2529  2480 14163   762 11938
  11572 10779  1051 11945  2391  9919 11947
  11718  1573 14454 11607 10392 12016 14451
   5527 14197]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.731 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.731  292.731 simple.py:52(score)
        3    0.000    0.000  292.725   97.575 profilehooks.py:257(new_fn)
        3    0.146    0.049  292.725   97.575 profilehooks.py:348(__call__)
        3    0.002    0.001  291.825   97.275 kb.py:122(neighbors)
        9  291.139   32.349  291.140   32.349 nms.py:31(build)
        2    0.133    0.066  195.200   97.600 kb.py:75(score)
        1    0.000    0.000   97.419   97.419 simple.py:29(hop)
        1    0.042    0.042   97.379   97.379 kb.py:156(forward)
       18    0.906    0.050    0.906    0.050 {built-in method cat}
    18/15    0.001    0.000    0.209    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
       13    0.000    0.000    0.203    0.016 functional.py:1774(embedding)
       13    0.203    0.016    0.203    0.016 {built-in method embedding}
        3    0.140    0.047    0.140    0.047 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.479 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.479  292.479 simple.py:52(score)
        3    0.000    0.000  292.475   97.492 profilehooks.py:257(new_fn)
        3    0.138    0.046  292.475   97.492 profilehooks.py:348(__call__)
        3    0.002    0.001  291.617   97.206 kb.py:122(neighbors)
        9  290.891   32.321  290.893   32.321 nms.py:31(build)
        2    0.124    0.062  195.179   97.590 kb.py:75(score)
        1    0.000    0.000   97.198   97.198 simple.py:29(hop)
        1    0.045    0.045   97.158   97.158 kb.py:156(forward)
       18    0.904    0.050    0.904    0.050 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.158    0.053    0.159    0.053 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[11418  6034 10018   653 11300   408  9963
  13605    54 10707  8877  2937  4658  8001
    735  6003   137  2045 10202  7007  3065
   5841  7006  2659  8489  5915   530   472
   6263 11315  8832    39 12846  5921  8806
  11344  8822  4381   293  8592  5239 10684
  11913 13960  5676  6640  1854 10976 11374
   3616  3896 10272  1549  2497  9835 13105
    193  6119  7562  4014  4455 12702  7800
  12730  8553   375   232  9964 11254  2458
   8590  5526  8802 12577   586  5136  7454
     85 12411  2203  2001  6679  9234   828
   5791  2248  6731   412  8608 13572   198
   4179  9716  6882  6959   427  7448 11843
  11101  5901]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.034 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.034  293.034 simple.py:52(score)
        3    0.000    0.000  293.030   97.677 profilehooks.py:257(new_fn)
        3    0.132    0.044  293.029   97.676 profilehooks.py:348(__call__)
        3    0.002    0.001  292.221   97.407 kb.py:122(neighbors)
        9  291.509   32.390  291.511   32.390 nms.py:31(build)
        2    0.107    0.053  195.753   97.877 kb.py:75(score)
        1    0.000    0.000   97.185   97.185 simple.py:29(hop)
        1    0.044    0.044   97.144   97.144 kb.py:156(forward)
       18    0.877    0.049    0.877    0.049 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.149    0.050    0.149    0.050 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.642 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.642  290.642 simple.py:52(score)
        3    0.000    0.000  290.638   96.879 profilehooks.py:257(new_fn)
        3    0.133    0.044  290.638   96.879 profilehooks.py:348(__call__)
        3    0.002    0.001  289.848   96.616 kb.py:122(neighbors)
        9  289.130   32.126  289.131   32.126 nms.py:31(build)
        2    0.103    0.051  193.916   96.958 kb.py:75(score)
        1    0.000    0.000   96.629   96.629 simple.py:29(hop)
        1    0.041    0.041   96.589   96.589 kb.py:156(forward)
       18    0.864    0.048    0.864    0.048 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.151    0.050    0.152    0.051 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 7868  9178 10094  5223  3679  3713  6295
  14031  4873 13329  9221   736  2250  9836
   8788 13117  4453   761  7731  8252 12420
   6613  1805  3721  9841  1710  7400  3504
   2315  5966  4788  5168 14050 10573 12896
   8002 13850  2546  7474  3340 11723 13755
   1461 10218  5025  3912   817 12300   287
   9844  1666  1837  5993  3192 14032    72
  11253  6394   572  7791 10113 11677 10681
  14119  4751  8415  4132  3007  1979  1716
   3992 11734 10590  4961  4777  4215  2481
   9047 11151   131  7882  8621  5097    71
  10433 12677  6976 10136  7802 14274  8335
  12530 10781  1908  3742  9731  9921  2437
  10798  1704]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.994 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.994  290.994 simple.py:52(score)
        3    0.000    0.000  290.991   96.997 profilehooks.py:257(new_fn)
        3    0.121    0.040  290.991   96.997 profilehooks.py:348(__call__)
        3    0.002    0.001  290.237   96.746 kb.py:122(neighbors)
        9  289.537   32.171  289.538   32.171 nms.py:31(build)
        2    0.086    0.043  194.197   97.099 kb.py:75(score)
        1    0.000    0.000   96.713   96.713 simple.py:29(hop)
        1    0.044    0.044   96.672   96.672 kb.py:156(forward)
       18    0.844    0.047    0.844    0.047 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.197    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.147    0.049    0.148    0.049 nms.py:51(query)
        3    0.002    0.001    0.003    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.532 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.532  291.532 simple.py:52(score)
        3    0.000    0.000  291.528   97.176 profilehooks.py:257(new_fn)
        3    0.141    0.047  291.528   97.176 profilehooks.py:348(__call__)
        3    0.002    0.001  290.713   96.904 kb.py:122(neighbors)
        9  290.002   32.222  290.004   32.223 nms.py:31(build)
        2    0.112    0.056  195.853   97.927 kb.py:75(score)
        1    0.000    0.000   95.575   95.575 simple.py:29(hop)
        1    0.044    0.044   95.533   95.533 kb.py:156(forward)
       18    0.848    0.047    0.848    0.047 {built-in method cat}
    18/15    0.001    0.000    0.186    0.012 module.py:715(_call_impl)
       13    0.000    0.000    0.183    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.183    0.014 functional.py:1774(embedding)
       13    0.183    0.014    0.183    0.014 {built-in method embedding}
        3    0.000    0.000    0.182    0.061 kb.py:68(generate_facts)
        3    0.181    0.060    0.182    0.061 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 6397   189 10796  2916 10493  1033  4183
   4431 14100  1941  2800 14382  2029  9276
   2732  3120 14006  5920 13580  3901  4939
  13446  3676  1955  9931  4203  2054  2824
   9458  1953  5295 12152  2032  7063   914
   2477  2002  1985  5933  4800  7256  3903
   7324  9775  4896  7564  2636  6262 13948
   2350 14010   659  2845  2714  2859  4892
   6712   178  2850  4554  5426   230  6147
   2664  8838  1881  4871  4739  3485 14418
    575  1202  4714  1781  5945  3047  6072
   7759 13442  1268  7588   188  2918  1911
    664  2875 11690  2826    79  8422  2017
   1850  2404  6181   695  2915  1357  6595
  12609  2704]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.954 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.954  290.954 simple.py:52(score)
        3    0.000    0.000  290.946   96.982 profilehooks.py:257(new_fn)
        3    0.137    0.046  290.946   96.982 profilehooks.py:348(__call__)
        3    0.002    0.001  290.114   96.705 kb.py:122(neighbors)
        9  289.394   32.155  289.396   32.155 nms.py:31(build)
        2    0.115    0.058  193.970   96.985 kb.py:75(score)
        1    0.000    0.000   96.878   96.878 simple.py:29(hop)
        1    0.044    0.044   96.838   96.838 kb.py:156(forward)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.211    0.070 kb.py:68(generate_facts)
        3    0.161    0.054    0.162    0.054 nms.py:51(query)
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.435 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.435  292.435 simple.py:52(score)
        3    0.000    0.000  292.430   97.477 profilehooks.py:257(new_fn)
        3    0.138    0.046  292.430   97.477 profilehooks.py:348(__call__)
        3    0.002    0.001  291.567   97.189 kb.py:122(neighbors)
        9  290.929   32.325  290.930   32.326 nms.py:31(build)
        2    0.114    0.057  194.684   97.342 kb.py:75(score)
        1    0.000    0.000   97.651   97.651 simple.py:29(hop)
        1    0.043    0.043   97.609   97.609 kb.py:156(forward)
       18    0.895    0.050    0.895    0.050 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.106    0.035    0.106    0.035 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 1619  1629  4333  1618  1628  1621  4113
   4108  6553  1634  1633  4150  1626  1631
   1616  1623  6967  6603  1627  1632  1617
   4111  6786  1630  1635  1624  4331  1612
   1614  1625  1613  1615  1620  1622  4107
   8957  4112  9346  9345  9737  3439  9465
   1667  6677  3441  5557  9181  7398  1641
   8375  7184  5643  6546  7415  6180  7530
   8713  7348  8533 12483 11517 10076  7691
   8105  9124 12312 12754 13432  8101  5471
    570 12759  8330 14380  3661  8530  3295
   9974  8906  4425  8104  9508   161 12815
   3270  8087 11693  3404   108 11578 11814
   8250  7823  9106  1262  6622 12962  4020
    201   155]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.903 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.903  290.903 simple.py:52(score)
        3    0.000    0.000  290.899   96.966 profilehooks.py:257(new_fn)
        3    0.151    0.050  290.899   96.966 profilehooks.py:348(__call__)
        3    0.002    0.001  289.976   96.659 kb.py:122(neighbors)
        9  289.276   32.142  289.277   32.142 nms.py:31(build)
        2    0.134    0.067  193.797   96.898 kb.py:75(score)
        1    0.000    0.000   96.992   96.992 simple.py:29(hop)
        1    0.044    0.044   96.952   96.952 kb.py:156(forward)
       18    0.923    0.051    0.923    0.051 {built-in method cat}
    18/15    0.001    0.000    0.199    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.196    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.196    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
       13    0.196    0.015    0.196    0.015 {built-in method embedding}
        3    0.160    0.053    0.160    0.053 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.460 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.460  292.460 simple.py:52(score)
        3    0.000    0.000  292.456   97.485 profilehooks.py:257(new_fn)
        3    0.123    0.041  292.456   97.485 profilehooks.py:348(__call__)
        3    0.002    0.001  291.705   97.235 kb.py:122(neighbors)
        9  290.996   32.333  290.998   32.333 nms.py:31(build)
        2    0.088    0.044  195.107   97.554 kb.py:75(score)
        1    0.000    0.000   97.267   97.267 simple.py:29(hop)
        1    0.044    0.044   97.225   97.225 kb.py:156(forward)
       18    0.821    0.046    0.821    0.046 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.187    0.014 functional.py:1774(embedding)
       13    0.187    0.014    0.187    0.014 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.181    0.060    0.182    0.061 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  164 12623 11529  8668  7761  6929  5475
   7682 13417 10853  9576  5732  2412  7509
  10329  7956  3267 13963  9113  4389  4527
   6927  2698  8147 14452  5672  1167  4216
   9971 13960  3184  9052 12774  3985  4254
  12873  2130 13429  4912 12568  1065  2311
   6608 10145   812  6129  6740  1159 10167
   3381  8314 13369  8928  2852  4394    81
   5850  2701   369  3895  7666 10855  2331
   9311  8069  7526 13015 10350  6508 12702
   9065  5626 12748   722  8198 12999  7326
   3482  2725 12109  6785 13107 11714  9240
   2870  9930  9033 11701   765 10950  7192
  10550  8733  3581  2702 10351 12868   891
   6609  3948]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.670 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.670  291.670 simple.py:52(score)
        3    0.000    0.000  291.666   97.222 profilehooks.py:257(new_fn)
        3    0.131    0.044  291.666   97.222 profilehooks.py:348(__call__)
        3    0.002    0.001  290.819   96.940 kb.py:122(neighbors)
        9  290.098   32.233  290.100   32.233 nms.py:31(build)
        2    0.104    0.052  193.737   96.869 kb.py:75(score)
        1    0.000    0.000   97.837   97.837 simple.py:29(hop)
        1    0.045    0.045   97.797   97.797 kb.py:156(forward)
       18    0.894    0.050    0.894    0.050 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.179    0.060    0.180    0.060 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.314 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.314  292.314 simple.py:52(score)
        3    0.000    0.000  292.310   97.437 profilehooks.py:257(new_fn)
        3    0.150    0.050  292.310   97.437 profilehooks.py:348(__call__)
        3    0.002    0.001  291.390   97.130 kb.py:122(neighbors)
        9  290.671   32.297  290.673   32.297 nms.py:31(build)
        2    0.123    0.061  195.067   97.534 kb.py:75(score)
        1    0.000    0.000   97.136   97.136 simple.py:29(hop)
        1    0.042    0.042   97.094   97.094 kb.py:156(forward)
       18    0.914    0.051    0.914    0.051 {built-in method cat}
    18/15    0.001    0.000    0.216    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.213    0.071 kb.py:68(generate_facts)
       13    0.000    0.000    0.213    0.016 functional.py:1774(embedding)
       13    0.213    0.016    0.213    0.016 {built-in method embedding}
        3    0.182    0.061    0.183    0.061 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[12578 12595   982 12570 13206 13965 13425
  12562 12574 12576  7981  5270 12567  5275
   5274  6359  7982  4412 12597  4931 12579
   4917  5269  4925 11819  4305 10672 12569
  12560 12080  8692 10366 10370 12572 12635
  10655 12580 10671  6197  1047  5268 10647
   4966  3978 10605  9678 10377 10635  7322
  12172 12571 11974 11516  5271 10609 10368
   5304  4921 10367  7133  6203 10376  4677
   3773  4918  3660 10665  4771  6201  8129
   8229   984 10545 10666 10675  4300 12506
  10304  4903  8696  7527  3720 10371  3765
  12561 12740  4303  4802  4734 12170 12920
   4804  4763  5311 12575  4891  5281  8450
   5284  9559]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.904 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.904  292.904 simple.py:52(score)
        3    0.000    0.000  292.901   97.634 profilehooks.py:257(new_fn)
        3    0.143    0.048  292.901   97.634 profilehooks.py:348(__call__)
        3    0.002    0.001  292.009   97.336 kb.py:122(neighbors)
        9  291.277   32.364  291.279   32.364 nms.py:31(build)
        2    0.123    0.061  195.309   97.654 kb.py:75(score)
        1    0.000    0.000   97.490   97.490 simple.py:29(hop)
        1    0.044    0.044   97.450   97.450 kb.py:156(forward)
       18    0.926    0.051    0.926    0.051 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
        3    0.174    0.058    0.175    0.058 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.903 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.903  291.903 simple.py:52(score)
        3    0.000    0.000  291.899   97.300 profilehooks.py:257(new_fn)
        3    0.137    0.046  291.899   97.300 profilehooks.py:348(__call__)
        3    0.002    0.001  291.002   97.001 kb.py:122(neighbors)
        9  290.287   32.254  290.288   32.254 nms.py:31(build)
        2    0.111    0.056  194.204   97.102 kb.py:75(score)
        1    0.000    0.000   97.597   97.597 simple.py:29(hop)
        1    0.043    0.043   97.557   97.557 kb.py:156(forward)
       18    0.950    0.053    0.950    0.053 {built-in method cat}
    18/15    0.001    0.000    0.206    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.202    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.202    0.016 functional.py:1774(embedding)
       13    0.202    0.016    0.202    0.016 {built-in method embedding}
        3    0.000    0.000    0.202    0.067 kb.py:68(generate_facts)
        3    0.152    0.051    0.153    0.051 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 5964  7183 13129 14279  8335   739 14276
  11259  1805 14280  6295  7742  5223 11320
  13117 11377  2843  5903 11723  4132 13939
   6554 13238 13097 11253 12761  3721  6613
    842  1640 10575  9543  4730  2464 14032
   8214  1832  5097  7930 12689 11151 13140
   4473   666 12882 13752  5534    68 11959
   4484 10638  4611  7724 14502   736  3576
   4074 10726 11426  7791  1010  5532 14031
   3709 10192  6765 13164 13312  7700  5904
  14441 10094 13201 14500  3923    60  4784
   3966 14005 10788 10425   733 13755 10189
  10865  7259 12521  1448  7474   726 13990
   5054  1293 10782    62   456 13976 10650
   7379 12896]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.502 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.502  294.502 simple.py:52(score)
        3    0.000    0.000  294.498   98.166 profilehooks.py:257(new_fn)
        3    0.134    0.045  294.498   98.166 profilehooks.py:348(__call__)
        3    0.002    0.001  293.663   97.888 kb.py:122(neighbors)
        9  292.996   32.555  292.998   32.555 nms.py:31(build)
        2    0.107    0.054  196.093   98.047 kb.py:75(score)
        1    0.000    0.000   98.312   98.312 simple.py:29(hop)
        1    0.047    0.047   98.271   98.271 kb.py:156(forward)
       18    0.871    0.048    0.871    0.048 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.193    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.193    0.015 functional.py:1774(embedding)
       13    0.193    0.015    0.193    0.015 {built-in method embedding}
        3    0.134    0.045    0.134    0.045 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.740 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.740  293.740 simple.py:52(score)
        3    0.000    0.000  293.736   97.912 profilehooks.py:257(new_fn)
        3    0.141    0.047  293.736   97.912 profilehooks.py:348(__call__)
        3    0.002    0.001  292.890   97.630 kb.py:122(neighbors)
        9  292.230   32.470  292.231   32.470 nms.py:31(build)
        2    0.104    0.052  195.926   97.963 kb.py:75(score)
        1    0.000    0.000   97.719   97.719 simple.py:29(hop)
        1    0.070    0.070   97.670   97.670 kb.py:156(forward)
       18    0.868    0.048    0.868    0.048 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.110    0.037    0.110    0.037 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[11510 14201 14181 11468 12977 13287 13885
  11083 13379 13394 13678 13384 11556 13135
  11773 13797 13318 14355 11089 13396 13383
  13905  3157 13527 14079 13922 10730 13685
  13668 13175 13923 13760 13899 14351 13183
  13180 13912 14406 11553 11644 11617 13913
  13288 13851 13896 11815 13398 14412  5660
  13528 13724 13910 13783 14489 13802 13378
  14329 13391 13178 13487 13707 13803 13531
  13794    11 13638 13532 14482 12156 14222
  13919 13680 13806 14486 13110 13525 14098
  14394 11978 12981 13340 13881 13389 12266
  12197 13290 10084 13779 13733 13637 10721
  13861 12984 13388 13689 13883 13769 14158
  13636 13767]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.326 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.326  291.326 simple.py:52(score)
        3    0.000    0.000  291.322   97.107 profilehooks.py:257(new_fn)
        3    0.143    0.048  291.322   97.107 profilehooks.py:348(__call__)
        3    0.002    0.001  290.498   96.833 kb.py:122(neighbors)
        9  289.787   32.199  289.789   32.199 nms.py:31(build)
        2    0.088    0.044  194.263   97.132 kb.py:75(score)
        1    0.000    0.000   96.976   96.976 simple.py:29(hop)
        1    0.073    0.073   96.916   96.916 kb.py:156(forward)
       18    0.860    0.048    0.860    0.048 {built-in method cat}
    18/15    0.001    0.000    0.208    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
       13    0.000    0.000    0.204    0.016 functional.py:1774(embedding)
       13    0.204    0.016    0.204    0.016 {built-in method embedding}
        3    0.149    0.050    0.150    0.050 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.343 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.343  289.343 simple.py:52(score)
        3    0.000    0.000  289.338   96.446 profilehooks.py:257(new_fn)
        3    0.143    0.048  289.338   96.446 profilehooks.py:348(__call__)
        3    0.002    0.001  288.466   96.155 kb.py:122(neighbors)
        9  287.750   31.972  287.752   31.972 nms.py:31(build)
        2    0.087    0.044  191.944   95.972 kb.py:75(score)
        1    0.000    0.000   97.310   97.310 simple.py:29(hop)
        1    0.069    0.069   97.251   97.251 kb.py:156(forward)
       18    0.932    0.052    0.932    0.052 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.147    0.049    0.147    0.049 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[ 2478   567 10601 12390  3865  2755  9185
   9759  2727  7063  2766  2790   988 10111
   6226  6174   226  5381  4082  1739  8186
   2620 11690  6078  6178  2742  2652  2722
   9605 12440   577  4909   450   608  2912
   5920 11745  2477  7144  2933  3411 11514
  12151  4554  2731  2724  2554 13358  2836
   2490  6719   393  9248  2868  2761  2747
   8051 14530  9807  2784 12165   228  7493
   2889  2754  2027 12061   882  7017  7564
  12917  6050  6065  2746  1926   188   801
   2372  2151   563  9742  2800  2898  1736
   2935 10892  4292   316  2895  2707   476
   2884  2778  5298  7808  3016  2930   178
    230 11236]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.174 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.174  293.174 simple.py:52(score)
        3    0.000    0.000  293.170   97.723 profilehooks.py:257(new_fn)
        3    0.136    0.045  293.170   97.723 profilehooks.py:348(__call__)
        3    0.002    0.001  292.350   97.450 kb.py:122(neighbors)
        9  291.634   32.404  291.636   32.404 nms.py:31(build)
        2    0.085    0.043  194.823   97.412 kb.py:75(score)
        1    0.000    0.000   98.265   98.265 simple.py:29(hop)
        1    0.068    0.068   98.211   98.211 kb.py:156(forward)
       18    0.891    0.050    0.891    0.050 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.151    0.050    0.151    0.050 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.977 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.977  292.977 simple.py:52(score)
        3    0.000    0.000  292.973   97.658 profilehooks.py:257(new_fn)
        3    0.132    0.044  292.973   97.658 profilehooks.py:348(__call__)
        3    0.002    0.001  292.144   97.381 kb.py:122(neighbors)
        9  291.451   32.383  291.453   32.384 nms.py:31(build)
        2    0.088    0.044  195.103   97.551 kb.py:75(score)
        1    0.000    0.000   97.789   97.789 simple.py:29(hop)
        1    0.065    0.065   97.738   97.738 kb.py:156(forward)
       18    0.891    0.050    0.891    0.050 {built-in method cat}
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.142    0.047    0.142    0.047 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[  308 13364 12501  6154  6938  5057  7684
   2475  9905  2640  2998  9255  6588 12329
   4764   929 13361  6513  9536 12469  5196
   4285  3348  6507  6486  9115 13125  4493
   3689    37 13628 11094 13366  9257 11870
  11869   979  2926  4494 13367  9895 11317
   9619  1724 13363  4211 11868  2683  6352
   2385 11871  9555   237  8368 14427  5500
   5821  4318  9516  6419  3635  1394  8519
    592  5625 10040  9672  7889  2809  8390
   1875  2332 10972  1244  7900  4862 11791
   6515  5197    29  9703   602  9200 13365
   4403 13368  3369   411  1012  3214  3246
  13736 13590  2658  5066 12919  7877  2222
  11872  8848]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.070 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.070  294.070 simple.py:52(score)
        3    0.000    0.000  294.065   98.022 profilehooks.py:257(new_fn)
        3    0.137    0.046  294.065   98.022 profilehooks.py:348(__call__)
        3    0.002    0.001  293.210   97.737 kb.py:122(neighbors)
        9  292.528   32.503  292.529   32.503 nms.py:31(build)
        2    0.090    0.045  195.161   97.580 kb.py:75(score)
        1    0.000    0.000   98.818   98.818 simple.py:29(hop)
        1    0.055    0.055   98.767   98.767 kb.py:156(forward)
       18    0.905    0.050    0.905    0.050 {built-in method cat}
    18/15    0.001    0.000    0.213    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.209    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.209    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.208    0.069 kb.py:68(generate_facts)
       13    0.208    0.016    0.208    0.016 {built-in method embedding}
        3    0.125    0.042    0.126    0.042 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.003    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.002    0.001    0.002    0.001 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.271 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.271  292.271 simple.py:52(score)
        3    0.000    0.000  292.267   97.422 profilehooks.py:257(new_fn)
        3    0.145    0.048  292.267   97.422 profilehooks.py:348(__call__)
        3    0.002    0.001  291.405   97.135 kb.py:122(neighbors)
        9  290.751   32.306  290.753   32.306 nms.py:31(build)
        2    0.115    0.058  194.737   97.368 kb.py:75(score)
        1    0.000    0.000   97.428   97.428 simple.py:29(hop)
        1    0.047    0.047   97.385   97.385 kb.py:156(forward)
       18    0.878    0.049    0.878    0.049 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.197    0.015 functional.py:1774(embedding)
       13    0.197    0.015    0.197    0.015 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.117    0.039    0.118    0.039 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[12345  7577  9374 11559  2981  2456 12377
   9101 11561   197   243  7383  5543 12187
  10335  2347 11403  8084  8987 12062  5916
   7178  6617  2213  5048 12392 11610  6323
   8801  6618  9641  3284 11187  4354 14410
   5797 12371  9713  1560 10523 10677  8376
   5618  9233  9533   307 12398  6658  5208
   4312 10873  4962  8761 10983 11821 10667
   3308   126 12947  5175  6890  1067  4177
   9013  3500  7523 10716   970  3309  1063
   7319  5613 10907 14386  7313  6952 11662
   6683 12096  9491 12177  9482 12097 14392
    179   203  2765 14333 13000  8820  3023
   3884  9723  8274  3271  7453  3533  1728
   5147 13445]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.685 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.685  290.685 simple.py:52(score)
        3    0.000    0.000  290.681   96.894 profilehooks.py:257(new_fn)
        3    0.140    0.047  290.681   96.894 profilehooks.py:348(__call__)
        3    0.002    0.001  289.819   96.606 kb.py:122(neighbors)
        9  289.080   32.120  289.082   32.120 nms.py:31(build)
        2    0.117    0.059  194.453   97.227 kb.py:75(score)
        1    0.000    0.000   96.129   96.129 simple.py:29(hop)
        1    0.047    0.047   96.088   96.088 kb.py:156(forward)
       18    0.924    0.051    0.924    0.051 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.160    0.053    0.160    0.053 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.898 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.898  291.898 simple.py:52(score)
        3    0.000    0.000  291.895   97.298 profilehooks.py:257(new_fn)
        3    0.141    0.047  291.895   97.298 profilehooks.py:348(__call__)
        3    0.002    0.001  291.083   97.028 kb.py:122(neighbors)
        9  290.351   32.261  290.353   32.261 nms.py:31(build)
        2    0.084    0.042  194.367   97.183 kb.py:75(score)
        1    0.000    0.000   97.445   97.445 simple.py:29(hop)
        1    0.074    0.074   97.387   97.387 kb.py:156(forward)
       18    0.860    0.048    0.860    0.048 {built-in method cat}
    18/15    0.001    0.000    0.191    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.188    0.014 sparse.py:123(forward)
       13    0.000    0.000    0.188    0.014 functional.py:1774(embedding)
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
       13    0.188    0.014    0.188    0.014 {built-in method embedding}
        3    0.180    0.060    0.181    0.060 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[  195  3248  7179  4387  6522  4350  2651
   7283  4378  7253  6328 14379  5049  9690
   3987 14371  5055  9266   821  3084  1363
   5007  4224  9691  7210  3080  8643  9355
   7777  7887  8271  9684  7221  1820  4223
   3076  7558  7910 13048 12271  3066  7516
   8732 11440  2523  4187  6344 12834  6041
  13034  5041  3545 13043  7307 13607  8402
   9278  3069  1360 13037  5799  5356 13050
   7911  2506  9356 11932  7598 13049 13044
   6264 13041 13081 13070 13059  7515 13038
  13062  8394  4258 13054 13341  7566 13053
  12958 11142  7514 12946 13052  7519  7905
   4055 13061 10427 12379 10349 13039 13036
   5247  7450]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.519 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.519  293.519 simple.py:52(score)
        3    0.000    0.000  293.515   97.838 profilehooks.py:257(new_fn)
        3    0.134    0.045  293.514   97.838 profilehooks.py:348(__call__)
        3    0.002    0.001  292.707   97.569 kb.py:122(neighbors)
        9  291.984   32.443  291.986   32.443 nms.py:31(build)
        2    0.088    0.044  194.882   97.441 kb.py:75(score)
        1    0.000    0.000   98.550   98.550 simple.py:29(hop)
        1    0.061    0.061   98.499   98.499 kb.py:156(forward)
       18    0.869    0.048    0.869    0.048 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
        3    0.165    0.055    0.165    0.055 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.191 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.191  291.191 simple.py:52(score)
        3    0.000    0.000  291.187   97.062 profilehooks.py:257(new_fn)
        3    0.133    0.044  291.187   97.062 profilehooks.py:348(__call__)
        3    0.002    0.001  290.381   96.794 kb.py:122(neighbors)
        9  289.696   32.188  289.698   32.189 nms.py:31(build)
        2    0.086    0.043  194.524   97.262 kb.py:75(score)
        1    0.000    0.000   96.581   96.581 simple.py:29(hop)
        1    0.064    0.064   96.530   96.530 kb.py:156(forward)
       18    0.858    0.048    0.858    0.048 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
        3    0.142    0.047    0.142    0.047 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 6138  6145  9647 12453  1663 11744 11177
   5941 11492 12498 14053  1723  1311  1588
  11807  4534  7162  1477 10215  4361 11527
  11282  4535  1116  1660  9475 11395  5113
  10104 14114 14115 11342 12112 10613 13197
  10087  3039 10025 12940   814  3508 11222
   4166  9436 10987  2044 10059  6655 13068
   6960  6788 11193  2585  6259  2482   978
   9038 14113  1496 11002 11093  3302   145
  10690  7951  1855 11391  5524   980 11997
  13001 14336 12449  9655 11308  4779  3193
   8437  8471  3866 11149  2582  1818  5015
   3811  3496  8385  2042  9520   394  5908
   2418  1609  9237  1702 12399  3428  9384
   6361  1502]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.761 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.761  293.761 simple.py:52(score)
        3    0.000    0.000  293.757   97.919 profilehooks.py:257(new_fn)
        3    0.144    0.048  293.757   97.919 profilehooks.py:348(__call__)
        3    0.002    0.001  292.951   97.650 kb.py:122(neighbors)
        9  292.229   32.470  292.231   32.470 nms.py:31(build)
        2    0.087    0.043  195.522   97.761 kb.py:75(score)
        1    0.000    0.000   98.148   98.148 simple.py:29(hop)
        1    0.071    0.071   98.091   98.091 kb.py:156(forward)
       18    0.879    0.049    0.879    0.049 {built-in method cat}
    18/15    0.001    0.000    0.198    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.195    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.195    0.015 functional.py:1774(embedding)
       13    0.195    0.015    0.195    0.015 {built-in method embedding}
        3    0.135    0.045    0.136    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.909 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.909  291.909 simple.py:52(score)
        3    0.000    0.000  291.905   97.302 profilehooks.py:257(new_fn)
        3    0.135    0.045  291.905   97.302 profilehooks.py:348(__call__)
        3    0.002    0.001  291.079   97.026 kb.py:122(neighbors)
        9  290.390   32.266  290.391   32.266 nms.py:31(build)
        2    0.085    0.042  193.879   96.940 kb.py:75(score)
        1    0.000    0.000   97.942   97.942 simple.py:29(hop)
        1    0.066    0.066   97.890   97.890 kb.py:156(forward)
       18    0.866    0.048    0.866    0.048 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.141    0.047    0.142    0.047 nms.py:51(query)
        3    0.007    0.002    0.007    0.002 {built-in method builtins.min}
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 8636  3885  7779  8037  9377  4202  9901
   3930  8091  5967  4191  2231  5323  9165
   9840 11257  8413  9066  7929  1192   149
   5715  5849  1460  5194  5376  3986  8218
   9358  3386  4163  3729  2653  4968  6253
   2957  5944 10214  1453  5319  2495 10180
   3530  4664  7722 12411  3061   538  9074
   8618 11402  5416 11234  5663  2405  9089
   3636  6165  6218   843 11072  4455  6085
    511  9695  5255  9577 12215  8110  7820
   7772  4958  8584   396  2904  7047  6474
  13198  9090  1451  4162  8553  4087 13162
   6194  3405 10242  4853  2162  9948   853
   5706  4585  5455   662  2780  5091  9166
   3272  5572]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.427 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.427  293.427 simple.py:52(score)
        3    0.000    0.000  293.423   97.808 profilehooks.py:257(new_fn)
        3    0.136    0.045  293.423   97.808 profilehooks.py:348(__call__)
        3    0.002    0.001  292.511   97.504 kb.py:122(neighbors)
        9  291.837   32.426  291.839   32.427 nms.py:31(build)
        2    0.107    0.053  194.551   97.275 kb.py:75(score)
        1    0.000    0.000   98.778   98.778 simple.py:29(hop)
        1    0.044    0.044   98.736   98.736 kb.py:156(forward)
       18    0.932    0.052    0.932    0.052 {built-in method cat}
    18/15    0.001    0.000    0.229    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.226    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.226    0.017 functional.py:1774(embedding)
        3    0.000    0.000    0.226    0.075 kb.py:68(generate_facts)
       13    0.226    0.017    0.226    0.017 {built-in method embedding}
        3    0.124    0.041    0.125    0.042 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.345 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.345  293.345 simple.py:52(score)
        3    0.000    0.000  293.342   97.781 profilehooks.py:257(new_fn)
        3    0.140    0.047  293.342   97.781 profilehooks.py:348(__call__)
        3    0.002    0.001  292.483   97.494 kb.py:122(neighbors)
        9  291.815   32.424  291.817   32.424 nms.py:31(build)
        2    0.087    0.044  195.075   97.537 kb.py:75(score)
        1    0.000    0.000   98.183   98.183 simple.py:29(hop)
        1    0.071    0.071   98.126   98.126 kb.py:156(forward)
       18    0.883    0.049    0.883    0.049 {built-in method cat}
    18/15    0.001    0.000    0.193    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.190    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.139    0.046    0.140    0.047 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[  191  1309  1424  1267  3887  9007  4369
    469  1310 10540  3031  5234  6872  1685
  11926  5222 12374  2427   321  9939  3030
   7923  1127  9743  1766  1124  7461  9403
   9067  8078  1759 12200   625  4373  3281
   5932 10814  3028  7554  4711  1598  9815
    384  5459  7103  3264  7914  8872  7733
   9426  1645 10324 11384  7408 11255  5737
  10077  9085  4635  3569  3315  3263  7586
   7001  7746  1909  6478  8547 10961 10054
   2904  7212  9511  6989  8712  4773 10422
  10633  3733  6082  8493  5656 13093  2952
  12870 10164  3554   763  3704  3443  7138
  11775  5790 12601 14080  8358  3182  3809
  11529  1997]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.101 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.101  294.101 simple.py:52(score)
        3    0.000    0.000  294.097   98.032 profilehooks.py:257(new_fn)
        3    0.140    0.047  294.097   98.032 profilehooks.py:348(__call__)
        3    0.002    0.001  293.250   97.750 kb.py:122(neighbors)
        9  292.601   32.511  292.602   32.511 nms.py:31(build)
        2    0.091    0.046  195.683   97.841 kb.py:75(score)
        1    0.000    0.000   98.331   98.331 simple.py:29(hop)
        1    0.072    0.072   98.274   98.274 kb.py:156(forward)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.197    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.194    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
       13    0.000    0.000    0.194    0.015 functional.py:1774(embedding)
       13    0.194    0.015    0.194    0.015 {built-in method embedding}
        3    0.116    0.039    0.117    0.039 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.455 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.455  295.455 simple.py:52(score)
        3    0.000    0.000  295.451   98.484 profilehooks.py:257(new_fn)
        3    0.141    0.047  295.451   98.484 profilehooks.py:348(__call__)
        3    0.002    0.001  294.576   98.192 kb.py:122(neighbors)
        9  293.866   32.652  293.868   32.652 nms.py:31(build)
        2    0.084    0.042  196.625   98.312 kb.py:75(score)
        1    0.000    0.000   98.742   98.742 simple.py:29(hop)
        1    0.072    0.072   98.685   98.685 kb.py:156(forward)
       18    0.909    0.050    0.909    0.050 {built-in method cat}
    18/15    0.001    0.000    0.201    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.198    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.198    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
       13    0.198    0.015    0.198    0.015 {built-in method embedding}
        3    0.165    0.055    0.165    0.055 nms.py:51(query)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}


[[ 6254  2087  1016   278 14350    24 14518
  10948 14413 13464 14398   631  1915 14187
  14137  3288  6959 13501 12895  9511   118
  12370 14109  6893 14400 10792 14417 14189
  14365   275 14510  6398  1691 12760  2036
   2034  9576   277 13538 13239   276  4878
   7432 14447 13853 14239  6152 14353 14160
  12850  5462 14241  6731 14237 14233  8443
  14216  2236   606 11529  2557 12853 10719
  11943  3795     9 10749    39  6909   266
  14199 14337  3881  7600 13952  4456  6733
   8316 14416 13845 11239 14257 10162  1513
  10825  4843 14515 14446 14221 14449 14229
    281  8223   375  6035  6012 14414  9065
   2177 12705]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.624 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.624  293.624 simple.py:52(score)
        3    0.000    0.000  293.620   97.873 profilehooks.py:257(new_fn)
        3    0.136    0.045  293.620   97.873 profilehooks.py:348(__call__)
        3    0.002    0.001  292.801   97.600 kb.py:122(neighbors)
        9  292.115   32.457  292.117   32.457 nms.py:31(build)
        2    0.095    0.047  195.040   97.520 kb.py:75(score)
        1    0.000    0.000   98.497   98.497 simple.py:29(hop)
        1    0.066    0.066   98.445   98.445 kb.py:156(forward)
       18    0.883    0.049    0.883    0.049 {built-in method cat}
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.118    0.039    0.119    0.040 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.465 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.465  292.465 simple.py:52(score)
        3    0.000    0.000  292.462   97.487 profilehooks.py:257(new_fn)
        3    0.133    0.044  292.462   97.487 profilehooks.py:348(__call__)
        3    0.002    0.001  291.664   97.221 kb.py:122(neighbors)
        9  290.964   32.329  290.966   32.330 nms.py:31(build)
        2    0.103    0.052  194.358   97.179 kb.py:75(score)
        1    0.000    0.000   98.012   98.012 simple.py:29(hop)
        1    0.044    0.044   97.971   97.971 kb.py:156(forward)
       18    0.834    0.046    0.834    0.046 {built-in method cat}
    18/15    0.001    0.000    0.203    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.200    0.015 sparse.py:123(forward)
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
       13    0.000    0.000    0.200    0.015 functional.py:1774(embedding)
       13    0.200    0.015    0.200    0.015 {built-in method embedding}
        3    0.169    0.056    0.170    0.057 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


[[ 4790  7156 10963  3829  4869  7177  6751
   5767  5578 10157 10939  3915  5998 11064
  11640 10137  8777  7100 10636  7703  9293
   1216  2340 10656  9950  6561  9274  6780
   6868 11293  7115 10574  8758 10407  5617
   1943  4855  7129  9454 11626  3218  6715
   8240  9796  9893  5537 10495  7606  8898
   8469  8044  1450  6281  9739  4806  8474
   1647 14043  5803  8787  6597  6412  3351
  11518  5685 11681  7388 11021 11594 10159
  10225  4742  3883  9674  7495  8974  8816
   6660 10624  9514  5011  7463  8353  3928
   8486  1780  5937 12700  8717 11589  9933
   5389  9910 12093  6531  8883  3715 12596
   7626  8451]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.460 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.460  292.460 simple.py:52(score)
        3    0.000    0.000  292.457   97.486 profilehooks.py:257(new_fn)
        3    0.132    0.044  292.457   97.486 profilehooks.py:348(__call__)
        3    0.002    0.001  291.634   97.211 kb.py:122(neighbors)
        9  290.948   32.328  290.950   32.328 nms.py:31(build)
        2    0.097    0.048  194.162   97.081 kb.py:75(score)
        1    0.000    0.000   98.205   98.205 simple.py:29(hop)
        1    0.044    0.044   98.163   98.163 kb.py:156(forward)
       18    0.889    0.049    0.889    0.049 {built-in method cat}
    18/15    0.001    0.000    0.202    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.199    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.199    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
       13    0.199    0.015    0.199    0.015 {built-in method embedding}
        3    0.133    0.044    0.134    0.045 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.001    0.000 linear.py:92(forward)
        3    0.000    0.000    0.001    0.000 functional.py:1669(linear)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method max}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.401 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.401  295.401 simple.py:52(score)
        3    0.000    0.000  295.397   98.466 profilehooks.py:257(new_fn)
        3    0.139    0.046  295.397   98.466 profilehooks.py:348(__call__)
        3    0.002    0.001  294.529   98.176 kb.py:122(neighbors)
        9  293.841   32.649  293.843   32.649 nms.py:31(build)
        2    0.114    0.057  197.678   98.839 kb.py:75(score)
        1    0.000    0.000   97.622   97.622 simple.py:29(hop)
        1    0.045    0.045   97.580   97.580 kb.py:156(forward)
       18    0.901    0.050    0.901    0.050 {built-in method cat}
    18/15    0.001    0.000    0.196    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.149    0.050    0.149    0.050 nms.py:51(query)
        3    0.003    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


[[12711  6785  3035  8111  9568  2942 13963
   6269   544  4374  4912  5035  2558   129
    919   722  4598  7265  7034  6431 12001
   7979 13198 10763  1209 11325 10290 13572
   1300  5901  2780  5112  5483  6044  1167
    737  8876  3386  1460  2870   506  1546
  11101  8042   530  2880 13960  2725 10214
   3744  7666  7956 10961   472  2548   957
   9596  5443  4759  6193 12411   529  3930
   9339 13130 14056  1636  1065  8083 12623
   5835   725  6347  5092  7237  2405  9526
  11529  6607 13454  4319  9377   661  4816
   7024  5089  1038   663  2793  7761  6759
  10706  5240  7867  9765  3172  8745  7757
   5913  3260]]

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.548 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.548  294.548 simple.py:52(score)
        3    0.000    0.000  294.545   98.182 profilehooks.py:257(new_fn)
        3    0.154    0.051  294.545   98.182 profilehooks.py:348(__call__)
        3    0.002    0.001  293.623   97.874 kb.py:122(neighbors)
        9  292.949   32.550  292.950   32.550 nms.py:31(build)
        2    0.137    0.069  196.019   98.009 kb.py:75(score)
        1    0.000    0.000   98.414   98.414 simple.py:29(hop)
        1    0.043    0.043   98.372   98.372 kb.py:156(forward)
       18    0.926    0.051    0.926    0.051 {built-in method cat}
    18/15    0.001    0.000    0.212    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.209    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.208    0.016 functional.py:1774(embedding)
        3    0.000    0.000    0.208    0.069 kb.py:68(generate_facts)
       13    0.208    0.016    0.208    0.016 {built-in method embedding}
        3    0.111    0.037    0.112    0.037 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        9    0.001    0.000    0.001    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.399 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.399  290.399 simple.py:52(score)
        3    0.000    0.000  290.395   96.798 profilehooks.py:257(new_fn)
        3    0.135    0.045  290.395   96.798 profilehooks.py:348(__call__)
        3    0.002    0.001  289.622   96.541 kb.py:122(neighbors)
        9  288.970   32.108  288.971   32.108 nms.py:31(build)
        2    0.116    0.058  192.581   96.290 kb.py:75(score)
        1    0.000    0.000   97.715   97.715 simple.py:29(hop)
        1    0.036    0.036   97.679   97.679 kb.py:156(forward)
       18    0.804    0.045    0.804    0.045 {built-in method cat}
    18/15    0.001    0.000    0.185    0.012 module.py:715(_call_impl)
       13    0.000    0.000    0.181    0.014 sparse.py:123(forward)
        3    0.000    0.000    0.181    0.060 kb.py:68(generate_facts)
       13    0.000    0.000    0.181    0.014 functional.py:1774(embedding)
       13    0.181    0.014    0.181    0.014 {built-in method embedding}
        3    0.137    0.046    0.137    0.046 nms.py:51(query)
        3    0.002    0.001    0.004    0.001 gaussian.py:28(__call__)
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001