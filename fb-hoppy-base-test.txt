nohup: ignoring input
Your CPU supports instructions that this binary was not compiled to use: SSE4.1 SSE4.2 AVX
For maximum performance, you can install NMSLIB from sources 
pip install --no-binary :all: nmslib
./bin/hoppy-transe-cli.py --train /home/baadalvm/data/fb15k-237/train.csv --test /home/baadalvm/data/fb15k-237/test.csv --dev /home/baadalvm/data/fb15k-237/valid.csv -e 0 -b 1000 --seed 1 --index nms --eval-batch-size 500 --save fb-hoppy-base-params-2.txt -k 100 --transe-eval --load-transe fb-transe-params-2.txt
{'GNTP_R': None,
 'N2': None,
 'N3': None,
 'batch_size': 1000,
 'dev': '/home/baadalvm/data/fb15k-237/valid.csv',
 'embedding_size': 100,
 'epochs': 0,
 'eval_batch_size': 500,
 'freeze_entities': None,
 'hops': ['1', '2'],
 'index_type': 'nms',
 'init': 'uniform',
 'init_size': 1.0,
 'input_type': 'standard',
 'k_max': 3,
 'learning_rate': 0.001,
 'load': None,
 'load_transe': 'fb-transe-params-2.txt',
 'lower_bound': -1.0,
 'nb_negatives': 1,
 'nb_rules': 4,
 'optimizer': 'adam',
 'quiet': False,
 'ref_init': 'uniform',
 'reformulator': 'linear',
 'refresh_interval': None,
 'save': 'fb-hoppy-base-params-2.txt',
 'seed': 1,
 'test': '/home/baadalvm/data/fb15k-237/test.csv',
 'test_i': None,
 'test_ii': None,
 'train': '/home/baadalvm/data/fb15k-237/train.csv',
 'transe_eval': True,
 'upper_bound': 1.0,
 'validate_every': None}
INFO:hoppy-transe-cli.py:Device: cpu
triples reading and predicates.. Done!
size of training triples is  272115
reciprocals.. Done!
Read all test, train, dev triples..!
size of all triples is  310116
entity indexes are set!
for loop is done..!
INFO:hoppy-transe-cli.py:	torch.Size([100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([14541, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([237, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100, 100])	cpu
INFO:hoppy-transe-cli.py:	torch.Size([100, 100])	cpu

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 254.113 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  254.113  254.113 simple.py:52(score)
        3    0.000    0.000  254.102   84.701 profilehooks.py:257(new_fn)
        3    0.127    0.042  254.102   84.701 profilehooks.py:348(__call__)
        3    0.011    0.004  253.138   84.379 kb.py:122(neighbors)
        9  250.440   27.827  250.441   27.827 nms.py:31(build)
        2    0.085    0.042  170.125   85.062 kb.py:75(score)
        1    0.000    0.000   83.891   83.891 simple.py:29(hop)
        1    0.042    0.042   83.850   83.850 kb.py:156(forward)
        3    2.110    0.703    2.126    0.709 nms.py:51(query)
       18    0.904    0.050    0.904    0.050 {built-in method cat}
    18/15    0.001    0.000    0.278    0.019 module.py:715(_call_impl)
       13    0.000    0.000    0.271    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.271    0.021 functional.py:1774(embedding)
       13    0.271    0.021    0.271    0.021 {built-in method embedding}
        3    0.000    0.000    0.223    0.074 kb.py:68(generate_facts)
        3    0.056    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.028    0.003    0.028    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.014    0.005    0.014    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.002    0.001    0.002    0.001 {built-in method sqrt}
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        1    0.001    0.001    0.001    0.001 {built-in method min}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 257.821 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  257.821  257.821 simple.py:52(score)
        3    0.000    0.000  257.814   85.938 profilehooks.py:257(new_fn)
        3    0.134    0.045  257.814   85.938 profilehooks.py:348(__call__)
        3    0.011    0.004  256.880   85.627 kb.py:122(neighbors)
        9  253.950   28.217  253.951   28.217 nms.py:31(build)
        2    0.114    0.057  172.260   86.130 kb.py:75(score)
        1    0.000    0.000   85.461   85.461 simple.py:29(hop)
        1    0.042    0.042   85.421   85.421 kb.py:156(forward)
        3    2.398    0.799    2.414    0.805 nms.py:51(query)
       18    0.858    0.048    0.858    0.048 {built-in method cat}
    18/15    0.001    0.000    0.215    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.210    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.210    0.016 functional.py:1774(embedding)
       13    0.210    0.016    0.210    0.016 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:08:35.986354

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 259.122 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  259.122  259.122 simple.py:52(score)
        3    0.000    0.000  259.113   86.371 profilehooks.py:257(new_fn)
        3    0.136    0.045  259.113   86.371 profilehooks.py:348(__call__)
        3    0.011    0.004  258.062   86.021 kb.py:122(neighbors)
        9  255.332   28.370  255.333   28.370 nms.py:31(build)
        2    0.090    0.045  172.966   86.483 kb.py:75(score)
        1    0.000    0.000   86.061   86.061 simple.py:29(hop)
        1    0.071    0.071   86.011   86.011 kb.py:156(forward)
        3    2.182    0.727    2.199    0.733 nms.py:51(query)
       18    0.922    0.051    0.922    0.051 {built-in method cat}
    18/15    0.001    0.000    0.272    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.266    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.265    0.020 functional.py:1774(embedding)
       13    0.265    0.020    0.265    0.020 {built-in method embedding}
        3    0.000    0.000    0.239    0.080 kb.py:68(generate_facts)
        3    0.053    0.018    0.057    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 260.035 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  260.035  260.035 simple.py:52(score)
        3    0.000    0.000  260.027   86.676 profilehooks.py:257(new_fn)
        3    0.136    0.045  260.027   86.676 profilehooks.py:348(__call__)
        3    0.011    0.004  259.036   86.345 kb.py:122(neighbors)
        9  256.031   28.448  256.032   28.448 nms.py:31(build)
        2    0.116    0.058  173.929   86.964 kb.py:75(score)
        1    0.000    0.000   86.003   86.003 simple.py:29(hop)
        1    0.042    0.042   85.962   85.962 kb.py:156(forward)
        3    2.454    0.818    2.469    0.823 nms.py:51(query)
       18    0.901    0.050    0.901    0.050 {built-in method cat}
    18/15    0.001    0.000    0.238    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.233    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.233    0.018 functional.py:1774(embedding)
       13    0.233    0.018    0.233    0.018 {built-in method embedding}
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


Time taken for this batch: 0:08:43.096125

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 261.055 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  261.055  261.055 simple.py:52(score)
        3    0.000    0.000  261.047   87.016 profilehooks.py:257(new_fn)
        3    0.129    0.043  261.047   87.016 profilehooks.py:348(__call__)
        3    0.011    0.004  260.074   86.691 kb.py:122(neighbors)
        9  257.282   28.587  257.284   28.587 nms.py:31(build)
        2    0.084    0.042  174.978   87.489 kb.py:75(score)
        1    0.000    0.000   85.981   85.981 simple.py:29(hop)
        1    0.043    0.043   85.940   85.940 kb.py:156(forward)
        3    2.247    0.749    2.263    0.754 nms.py:51(query)
       18    0.870    0.048    0.870    0.048 {built-in method cat}
    18/15    0.001    0.000    0.259    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.253    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.253    0.019 functional.py:1774(embedding)
       13    0.253    0.019    0.253    0.019 {built-in method embedding}
        3    0.000    0.000    0.226    0.075 kb.py:68(generate_facts)
        3    0.078    0.026    0.082    0.027 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 263.799 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  263.799  263.799 simple.py:52(score)
        3    0.000    0.000  263.791   87.930 profilehooks.py:257(new_fn)
        3    0.142    0.047  263.791   87.930 profilehooks.py:348(__call__)
        3    0.011    0.004  262.776   87.592 kb.py:122(neighbors)
        9  259.584   28.843  259.586   28.843 nms.py:31(build)
        2    0.108    0.054  176.105   88.053 kb.py:75(score)
        1    0.000    0.000   87.585   87.585 simple.py:29(hop)
        1    0.042    0.042   87.543   87.543 kb.py:156(forward)
        3    2.658    0.886    2.674    0.891 nms.py:51(query)
       18    0.939    0.052    0.939    0.052 {built-in method cat}
    18/15    0.001    0.000    0.213    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.207    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.207    0.016 functional.py:1774(embedding)
       13    0.207    0.016    0.207    0.016 {built-in method embedding}
        3    0.000    0.000    0.182    0.061 kb.py:68(generate_facts)
        3    0.050    0.017    0.055    0.018 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:08:48.831668

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 265.243 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  265.243  265.243 simple.py:52(score)
        3    0.000    0.000  265.235   88.412 profilehooks.py:257(new_fn)
        3    0.140    0.047  265.235   88.412 profilehooks.py:348(__call__)
        3    0.010    0.003  264.333   88.111 kb.py:122(neighbors)
        9  261.692   29.077  261.694   29.077 nms.py:31(build)
        2    0.107    0.054  177.180   88.590 kb.py:75(score)
        1    0.000    0.000   87.961   87.961 simple.py:29(hop)
        1    0.041    0.041   87.914   87.914 kb.py:156(forward)
        3    2.083    0.694    2.099    0.700 nms.py:51(query)
       18    0.836    0.046    0.836    0.046 {built-in method cat}
    18/15    0.001    0.000    0.231    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.226    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.226    0.017 functional.py:1774(embedding)
       13    0.226    0.017    0.226    0.017 {built-in method embedding}
        3    0.000    0.000    0.207    0.069 kb.py:68(generate_facts)
        3    0.056    0.019    0.060    0.020 gaussian.py:28(__call__)
        9    0.016    0.002    0.016    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 268.264 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  268.264  268.264 simple.py:52(score)
        3    0.000    0.000  268.256   89.419 profilehooks.py:257(new_fn)
        3    0.126    0.042  268.256   89.419 profilehooks.py:348(__call__)
        3    0.011    0.004  267.268   89.089 kb.py:122(neighbors)
        9  264.055   29.339  264.057   29.340 nms.py:31(build)
        2    0.082    0.041  179.086   89.543 kb.py:75(score)
        1    0.000    0.000   89.087   89.087 simple.py:29(hop)
        1    0.041    0.041   89.045   89.045 kb.py:156(forward)
        3    2.674    0.891    2.690    0.897 nms.py:51(query)
       18    0.965    0.054    0.965    0.054 {built-in method cat}
    18/15    0.001    0.000    0.211    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.206    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.206    0.016 functional.py:1774(embedding)
       13    0.206    0.016    0.206    0.016 {built-in method embedding}
        3    0.000    0.000    0.184    0.061 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.017    0.002    0.017    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.003    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:08:57.235914

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 268.804 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  268.804  268.804 simple.py:52(score)
        3    0.000    0.000  268.794   89.598 profilehooks.py:257(new_fn)
        3    0.134    0.045  268.794   89.598 profilehooks.py:348(__call__)
        3    0.011    0.004  267.773   89.258 kb.py:122(neighbors)
        9  264.946   29.438  264.947   29.439 nms.py:31(build)
        2    0.113    0.056  179.829   89.915 kb.py:75(score)
        1    0.000    0.000   88.873   88.873 simple.py:29(hop)
        1    0.042    0.042   88.831   88.831 kb.py:156(forward)
        3    2.233    0.744    2.249    0.750 nms.py:51(query)
       18    0.948    0.053    0.948    0.053 {built-in method cat}
    18/15    0.001    0.000    0.277    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.270    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.270    0.021 functional.py:1774(embedding)
       13    0.270    0.021    0.270    0.021 {built-in method embedding}
        3    0.000    0.000    0.249    0.083 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 272.819 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  272.819  272.819 simple.py:52(score)
        3    0.000    0.000  272.810   90.937 profilehooks.py:257(new_fn)
        3    0.145    0.048  272.810   90.937 profilehooks.py:348(__call__)
        3    0.011    0.004  271.715   90.572 kb.py:122(neighbors)
        9  268.497   29.833  268.499   29.833 nms.py:31(build)
        2    0.134    0.067  182.408   91.204 kb.py:75(score)
        1    0.000    0.000   90.299   90.299 simple.py:29(hop)
        1    0.046    0.046   90.257   90.257 kb.py:156(forward)
        3    2.651    0.884    2.670    0.890 nms.py:51(query)
       18    1.002    0.056    1.002    0.056 {built-in method cat}
    18/15    0.001    0.000    0.224    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.219    0.017 functional.py:1774(embedding)
       13    0.219    0.017    0.219    0.017 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.018    0.006    0.018    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:05.364725

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 272.633 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  272.633  272.633 simple.py:52(score)
        3    0.000    0.000  272.622   90.874 profilehooks.py:257(new_fn)
        3    0.139    0.046  272.622   90.874 profilehooks.py:348(__call__)
        3    0.011    0.004  271.625   90.542 kb.py:122(neighbors)
        9  268.901   29.878  268.903   29.878 nms.py:31(build)
        2    0.121    0.061  182.009   91.005 kb.py:75(score)
        1    0.000    0.000   90.515   90.515 simple.py:29(hop)
        1    0.043    0.043   90.473   90.473 kb.py:156(forward)
        3    2.171    0.724    2.187    0.729 nms.py:51(query)
       18    0.885    0.049    0.885    0.049 {built-in method cat}
    18/15    0.001    0.000    0.261    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.254    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.253    0.019 functional.py:1774(embedding)
       13    0.253    0.019    0.253    0.019 {built-in method embedding}
        3    0.000    0.000    0.233    0.078 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.018    0.002    0.018    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.003 base.py:142(forward)
        2    0.000    0.000    0.007    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 274.133 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  274.133  274.133 simple.py:52(score)
        3    0.000    0.000  274.125   91.375 profilehooks.py:257(new_fn)
        3    0.137    0.046  274.125   91.375 profilehooks.py:348(__call__)
        3    0.011    0.004  273.164   91.055 kb.py:122(neighbors)
        9  270.107   30.012  270.108   30.012 nms.py:31(build)
        2    0.105    0.053  183.231   91.615 kb.py:75(score)
        1    0.000    0.000   90.805   90.805 simple.py:29(hop)
        1    0.061    0.061   90.757   90.757 kb.py:156(forward)
        3    2.524    0.841    2.541    0.847 nms.py:51(query)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.214    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.209    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.208    0.016 functional.py:1774(embedding)
       13    0.208    0.016    0.208    0.016 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.059    0.020    0.063    0.021 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:11.081218

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.317 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  276.317  276.317 simple.py:52(score)
        3    0.000    0.000  276.308   92.103 profilehooks.py:257(new_fn)
        3    0.140    0.047  276.307   92.102 profilehooks.py:348(__call__)
        3    0.012    0.004  275.291   91.764 kb.py:122(neighbors)
        9  272.519   30.280  272.520   30.280 nms.py:31(build)
        2    0.093    0.047  184.492   92.246 kb.py:75(score)
        1    0.000    0.000   91.732   91.732 simple.py:29(hop)
        1    0.084    0.084   91.676   91.676 kb.py:156(forward)
        3    2.210    0.737    2.225    0.742 nms.py:51(query)
       18    0.887    0.049    0.887    0.049 {built-in method cat}
    18/15    0.001    0.000    0.272    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.265    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.265    0.020 functional.py:1774(embedding)
       13    0.265    0.020    0.265    0.020 {built-in method embedding}
        3    0.000    0.000    0.244    0.081 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.018    0.002    0.018    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 275.909 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  275.909  275.909 simple.py:52(score)
        3    0.000    0.000  275.900   91.967 profilehooks.py:257(new_fn)
        3    0.141    0.047  275.900   91.967 profilehooks.py:348(__call__)
        3    0.011    0.004  274.894   91.631 kb.py:122(neighbors)
        9  271.712   30.190  271.714   30.190 nms.py:31(build)
        2    0.122    0.061  184.171   92.086 kb.py:75(score)
        1    0.000    0.000   91.630   91.630 simple.py:29(hop)
        1    0.046    0.046   91.589   91.589 kb.py:156(forward)
        3    2.616    0.872    2.633    0.878 nms.py:51(query)
       18    0.942    0.052    0.942    0.052 {built-in method cat}
    18/15    0.001    0.000    0.220    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.214    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.213    0.016 functional.py:1774(embedding)
       13    0.213    0.016    0.213    0.016 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.053    0.018    0.057    0.019 gaussian.py:28(__call__)
        9    0.017    0.002    0.017    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.002    0.001    0.002    0.001 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:15.971025

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.424 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  276.424  276.424 simple.py:52(score)
        3    0.000    0.000  276.415   92.138 profilehooks.py:257(new_fn)
        3    0.126    0.042  276.415   92.138 profilehooks.py:348(__call__)
        3    0.012    0.004  275.511   91.837 kb.py:122(neighbors)
        9  272.783   30.309  272.784   30.309 nms.py:31(build)
        2    0.092    0.046  184.567   92.283 kb.py:75(score)
        1    0.000    0.000   91.764   91.764 simple.py:29(hop)
        1    0.041    0.041   91.723   91.723 kb.py:156(forward)
        3    2.178    0.726    2.197    0.732 nms.py:51(query)
       18    0.845    0.047    0.845    0.047 {built-in method cat}
    18/15    0.001    0.000    0.239    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.233    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.233    0.018 functional.py:1774(embedding)
       13    0.233    0.018    0.233    0.018 {built-in method embedding}
        3    0.000    0.000    0.210    0.070 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.018    0.002    0.018    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.017    0.006    0.017    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 276.761 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  276.761  276.761 simple.py:52(score)
        3    0.000    0.000  276.753   92.251 profilehooks.py:257(new_fn)
        3    0.133    0.044  276.753   92.251 profilehooks.py:348(__call__)
        3    0.011    0.004  275.872   91.957 kb.py:122(neighbors)
        9  272.765   30.307  272.766   30.307 nms.py:31(build)
        2    0.114    0.057  184.713   92.357 kb.py:75(score)
        1    0.000    0.000   91.949   91.949 simple.py:29(hop)
        1    0.042    0.042   91.907   91.907 kb.py:156(forward)
        3    2.534    0.845    2.550    0.850 nms.py:51(query)
       18    0.849    0.047    0.849    0.047 {built-in method cat}
    18/15    0.001    0.000    0.209    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.204    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.203    0.016 functional.py:1774(embedding)
       13    0.203    0.016    0.203    0.016 {built-in method embedding}
        3    0.000    0.000    0.181    0.060 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.017    0.002    0.017    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.009    0.003 kb.py:62(to_tnsr)
        3    0.009    0.003    0.009    0.003 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:17.093864

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.638 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  277.638  277.638 simple.py:52(score)
        3    0.000    0.000  277.628   92.543 profilehooks.py:257(new_fn)
        3    0.141    0.047  277.628   92.543 profilehooks.py:348(__call__)
        3    0.012    0.004  276.582   92.194 kb.py:122(neighbors)
        9  273.861   30.429  273.862   30.429 nms.py:31(build)
        2    0.130    0.065  185.395   92.697 kb.py:75(score)
        1    0.000    0.000   92.136   92.136 simple.py:29(hop)
        1    0.041    0.041   92.093   92.093 kb.py:156(forward)
        3    2.148    0.716    2.165    0.722 nms.py:51(query)
       18    0.936    0.052    0.936    0.052 {built-in method cat}
    18/15    0.001    0.000    0.259    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.253    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.253    0.019 functional.py:1774(embedding)
       13    0.253    0.019    0.253    0.019 {built-in method embedding}
        3    0.000    0.000    0.228    0.076 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.000    0.000    0.003    0.001 kb.py:62(to_tnsr)
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        3    0.003    0.001    0.003    0.001 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.643 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  279.643  279.643 simple.py:52(score)
        3    0.000    0.000  279.634   93.211 profilehooks.py:257(new_fn)
        3    0.140    0.047  279.634   93.211 profilehooks.py:348(__call__)
        3    0.011    0.004  278.635   92.878 kb.py:122(neighbors)
        9  275.413   30.601  275.415   30.602 nms.py:31(build)
        2    0.126    0.063  187.203   93.602 kb.py:75(score)
        1    0.000    0.000   92.333   92.333 simple.py:29(hop)
        1    0.041    0.041   92.291   92.291 kb.py:156(forward)
        3    2.660    0.887    2.676    0.892 nms.py:51(query)
       18    0.932    0.052    0.932    0.052 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.054    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.017    0.002    0.017    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:21.122569

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.524 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  279.524  279.524 simple.py:52(score)
        3    0.000    0.000  279.515   93.172 profilehooks.py:257(new_fn)
        3    0.138    0.046  279.515   93.172 profilehooks.py:348(__call__)
        3    0.011    0.004  278.526   92.842 kb.py:122(neighbors)
        9  275.759   30.640  275.760   30.640 nms.py:31(build)
        2    0.085    0.042  186.652   93.326 kb.py:75(score)
        1    0.000    0.000   92.773   92.773 simple.py:29(hop)
        1    0.067    0.067   92.725   92.725 kb.py:156(forward)
        3    2.183    0.728    2.200    0.733 nms.py:51(query)
       18    0.927    0.052    0.927    0.052 {built-in method cat}
    18/15    0.001    0.000    0.241    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.235    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.235    0.018 functional.py:1774(embedding)
       13    0.235    0.018    0.235    0.018 {built-in method embedding}
        3    0.000    0.000    0.214    0.071 kb.py:68(generate_facts)
        3    0.055    0.018    0.069    0.023 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        3    0.010    0.003    0.010    0.003 {built-in method clamp}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 279.875 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  279.875  279.875 simple.py:52(score)
        3    0.000    0.000  279.866   93.289 profilehooks.py:257(new_fn)
        3    0.137    0.046  279.866   93.289 profilehooks.py:348(__call__)
        3    0.011    0.004  278.892   92.964 kb.py:122(neighbors)
        9  275.661   30.629  275.662   30.629 nms.py:31(build)
        2    0.083    0.042  187.262   93.631 kb.py:75(score)
        1    0.000    0.000   92.518   92.518 simple.py:29(hop)
        1    0.071    0.071   92.466   92.466 kb.py:156(forward)
        3    2.649    0.883    2.665    0.888 nms.py:51(query)
       18    0.942    0.052    0.942    0.052 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:23.828694

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.756 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.756  278.756 simple.py:52(score)
        3    0.000    0.000  278.747   92.916 profilehooks.py:257(new_fn)
        3    0.139    0.046  278.747   92.916 profilehooks.py:348(__call__)
        3    0.011    0.004  277.814   92.605 kb.py:122(neighbors)
        9  275.156   30.573  275.158   30.573 nms.py:31(build)
        2    0.111    0.055  185.903   92.952 kb.py:75(score)
        1    0.000    0.000   92.748   92.748 simple.py:29(hop)
        1    0.043    0.043   92.705   92.705 kb.py:156(forward)
        3    2.121    0.707    2.138    0.713 nms.py:51(query)
       18    0.828    0.046    0.828    0.046 {built-in method cat}
    18/15    0.001    0.000    0.238    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.232    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.232    0.018 functional.py:1774(embedding)
       13    0.231    0.018    0.231    0.018 {built-in method embedding}
        3    0.000    0.000    0.210    0.070 kb.py:68(generate_facts)
        3    0.062    0.021    0.067    0.022 gaussian.py:28(__call__)
        9    0.018    0.002    0.018    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.328 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  277.328  277.328 simple.py:52(score)
        3    0.000    0.000  277.321   92.440 profilehooks.py:257(new_fn)
        3    0.134    0.045  277.321   92.440 profilehooks.py:348(__call__)
        3    0.011    0.004  276.445   92.148 kb.py:122(neighbors)
        9  273.419   30.380  273.420   30.380 nms.py:31(build)
        2    0.085    0.042  185.387   92.694 kb.py:75(score)
        1    0.000    0.000   91.842   91.842 simple.py:29(hop)
        1    0.041    0.041   91.799   91.799 kb.py:156(forward)
        3    2.471    0.824    2.486    0.829 nms.py:51(query)
       18    0.847    0.047    0.847    0.047 {built-in method cat}
    18/15    0.001    0.000    0.214    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.209    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.209    0.016 functional.py:1774(embedding)
       13    0.209    0.016    0.209    0.016 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.059    0.020    0.063    0.021 gaussian.py:28(__call__)
        9    0.017    0.002    0.017    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        3    0.000    0.000    0.003    0.001 kb.py:62(to_tnsr)
        3    0.003    0.001    0.003    0.001 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:19.768109

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 277.258 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  277.258  277.258 simple.py:52(score)
        3    0.000    0.000  277.248   92.416 profilehooks.py:257(new_fn)
        3    0.141    0.047  277.248   92.416 profilehooks.py:348(__call__)
        3    0.010    0.003  276.333   92.111 kb.py:122(neighbors)
        9  273.631   30.403  273.632   30.404 nms.py:31(build)
        2    0.124    0.062  185.096   92.548 kb.py:75(score)
        1    0.000    0.000   92.053   92.053 simple.py:29(hop)
        1    0.041    0.041   92.011   92.011 kb.py:156(forward)
        3    2.173    0.724    2.188    0.729 nms.py:51(query)
       18    0.783    0.044    0.783    0.044 {built-in method cat}
    18/15    0.001    0.000    0.258    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.251    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.251    0.019 functional.py:1774(embedding)
       13    0.251    0.019    0.251    0.019 {built-in method embedding}
        3    0.000    0.000    0.230    0.077 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.017    0.002    0.017    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 278.983 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  278.983  278.983 simple.py:52(score)
        3    0.000    0.000  278.976   92.992 profilehooks.py:257(new_fn)
        3    0.129    0.043  278.976   92.992 profilehooks.py:348(__call__)
        3    0.011    0.004  278.171   92.724 kb.py:122(neighbors)
        9  275.152   30.572  275.153   30.573 nms.py:31(build)
        2    0.084    0.042  186.476   93.238 kb.py:75(score)
        1    0.000    0.000   92.413   92.413 simple.py:29(hop)
        1    0.042    0.042   92.371   92.371 kb.py:156(forward)
        3    2.494    0.831    2.513    0.838 nms.py:51(query)
       18    0.750    0.042    0.750    0.042 {built-in method cat}
    18/15    0.001    0.000    0.223    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.218    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.217    0.017 functional.py:1774(embedding)
       13    0.217    0.017    0.217    0.017 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.049    0.016    0.053    0.018 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.017    0.006    0.017    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.002    0.001    0.002    0.001 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:19.977371

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.107 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  280.107  280.107 simple.py:52(score)
        3    0.000    0.000  280.098   93.366 profilehooks.py:257(new_fn)
        3    0.138    0.046  280.098   93.366 profilehooks.py:348(__call__)
        3    0.011    0.004  279.065   93.022 kb.py:122(neighbors)
        9  276.252   30.695  276.254   30.695 nms.py:31(build)
        2    0.083    0.042  186.532   93.266 kb.py:75(score)
        1    0.000    0.000   93.479   93.479 simple.py:29(hop)
        1    0.074    0.074   93.427   93.427 kb.py:156(forward)
        3    2.233    0.744    2.249    0.750 nms.py:51(query)
       18    0.965    0.054    0.965    0.054 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.243    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.243    0.019 functional.py:1774(embedding)
       13    0.243    0.019    0.243    0.019 {built-in method embedding}
        3    0.000    0.000    0.221    0.074 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.341 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  281.341  281.341 simple.py:52(score)
        3    0.000    0.000  281.332   93.777 profilehooks.py:257(new_fn)
        3    0.141    0.047  281.332   93.777 profilehooks.py:348(__call__)
        3    0.011    0.004  280.346   93.449 kb.py:122(neighbors)
        9  277.162   30.796  277.164   30.796 nms.py:31(build)
        2    0.090    0.045  188.242   94.121 kb.py:75(score)
        1    0.000    0.000   93.004   93.004 simple.py:29(hop)
        1    0.079    0.079   92.949   92.949 kb.py:156(forward)
        3    2.617    0.872    2.633    0.878 nms.py:51(query)
       18    0.915    0.051    0.915    0.051 {built-in method cat}
    18/15    0.001    0.000    0.221    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.215    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.215    0.017 functional.py:1774(embedding)
       13    0.215    0.017    0.215    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:25.409316

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 280.722 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  280.722  280.722 simple.py:52(score)
        3    0.000    0.000  280.712   93.571 profilehooks.py:257(new_fn)
        3    0.146    0.049  280.712   93.571 profilehooks.py:348(__call__)
        3    0.011    0.004  279.688   93.229 kb.py:122(neighbors)
        9  276.888   30.765  276.890   30.766 nms.py:31(build)
        2    0.083    0.042  186.604   93.302 kb.py:75(score)
        1    0.000    0.000   94.020   94.020 simple.py:29(hop)
        1    0.086    0.086   93.963   93.963 kb.py:156(forward)
        3    2.224    0.741    2.240    0.747 nms.py:51(query)
       18    0.920    0.051    0.920    0.051 {built-in method cat}
    18/15    0.001    0.000    0.250    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.243    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.220    0.073 kb.py:68(generate_facts)
        3    0.054    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.009    0.003 kb.py:62(to_tnsr)
        3    0.009    0.003    0.009    0.003 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.432 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  281.432  281.432 simple.py:52(score)
        3    0.000    0.000  281.424   93.808 profilehooks.py:257(new_fn)
        3    0.143    0.048  281.424   93.808 profilehooks.py:348(__call__)
        3    0.011    0.004  280.482   93.494 kb.py:122(neighbors)
        9  277.224   30.803  277.225   30.803 nms.py:31(build)
        2    0.130    0.065  187.533   93.767 kb.py:75(score)
        1    0.000    0.000   93.789   93.789 simple.py:29(hop)
        1    0.042    0.042   93.747   93.747 kb.py:156(forward)
        3    2.628    0.876    2.644    0.881 nms.py:51(query)
       18    0.931    0.052    0.931    0.052 {built-in method cat}
    18/15    0.001    0.000    0.220    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.214    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.214    0.016 functional.py:1774(embedding)
       13    0.214    0.016    0.214    0.016 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:26.251353

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.269 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.269  282.269 simple.py:52(score)
        3    0.000    0.000  282.260   94.087 profilehooks.py:257(new_fn)
        3    0.143    0.048  282.260   94.087 profilehooks.py:348(__call__)
        3    0.011    0.004  281.269   93.756 kb.py:122(neighbors)
        9  278.579   30.953  278.580   30.953 nms.py:31(build)
        2    0.127    0.063  188.160   94.080 kb.py:75(score)
        1    0.000    0.000   93.999   93.999 simple.py:29(hop)
        1    0.043    0.043   93.957   93.957 kb.py:156(forward)
        3    2.120    0.707    2.136    0.712 nms.py:51(query)
       18    0.895    0.050    0.895    0.050 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.237    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.236    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.213    0.071 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.599 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  281.599  281.599 simple.py:52(score)
        3    0.000    0.000  281.592   93.864 profilehooks.py:257(new_fn)
        3    0.143    0.048  281.592   93.864 profilehooks.py:348(__call__)
        3    0.011    0.004  280.636   93.545 kb.py:122(neighbors)
        9  277.559   30.840  277.560   30.840 nms.py:31(build)
        2    0.122    0.061  187.712   93.856 kb.py:75(score)
        1    0.000    0.000   93.778   93.778 simple.py:29(hop)
        1    0.042    0.042   93.736   93.736 kb.py:156(forward)
        3    2.504    0.835    2.520    0.840 nms.py:51(query)
       18    0.883    0.049    0.883    0.049 {built-in method cat}
    18/15    0.001    0.000    0.232    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.226    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.226    0.017 functional.py:1774(embedding)
       13    0.226    0.017    0.226    0.017 {built-in method embedding}
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:27.519887

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.353 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  283.353  283.353 simple.py:52(score)
        3    0.000    0.000  283.345   94.448 profilehooks.py:257(new_fn)
        3    0.143    0.048  283.345   94.448 profilehooks.py:348(__call__)
        3    0.012    0.004  282.335   94.112 kb.py:122(neighbors)
        9  279.700   31.078  279.702   31.078 nms.py:31(build)
        2    0.135    0.068  189.772   94.886 kb.py:75(score)
        1    0.000    0.000   93.472   93.472 simple.py:29(hop)
        1    0.043    0.043   93.430   93.430 kb.py:156(forward)
        3    2.066    0.689    2.083    0.694 nms.py:51(query)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.243    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.243    0.019 functional.py:1774(embedding)
       13    0.243    0.019    0.243    0.019 {built-in method embedding}
        3    0.000    0.000    0.219    0.073 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.721 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  282.721  282.721 simple.py:52(score)
        3    0.000    0.000  282.712   94.237 profilehooks.py:257(new_fn)
        3    0.138    0.046  282.712   94.237 profilehooks.py:348(__call__)
        3    0.011    0.004  281.752   93.917 kb.py:122(neighbors)
        9  278.587   30.954  278.588   30.954 nms.py:31(build)
        2    0.104    0.052  189.151   94.575 kb.py:75(score)
        1    0.000    0.000   93.467   93.467 simple.py:29(hop)
        1    0.043    0.043   93.424   93.424 kb.py:156(forward)
        3    2.585    0.862    2.601    0.867 nms.py:51(query)
       18    0.914    0.051    0.914    0.051 {built-in method cat}
    18/15    0.001    0.000    0.229    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.223    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.223    0.017 functional.py:1774(embedding)
       13    0.223    0.017    0.223    0.017 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:29.808322

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 281.989 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  281.989  281.989 simple.py:52(score)
        3    0.000    0.000  281.980   93.993 profilehooks.py:257(new_fn)
        3    0.132    0.044  281.980   93.993 profilehooks.py:348(__call__)
        3    0.011    0.004  280.991   93.664 kb.py:122(neighbors)
        9  278.191   30.910  278.192   30.910 nms.py:31(build)
        2    0.089    0.044  188.393   94.196 kb.py:75(score)
        1    0.000    0.000   93.497   93.497 simple.py:29(hop)
        1    0.042    0.042   93.455   93.455 kb.py:156(forward)
        3    2.225    0.742    2.242    0.747 nms.py:51(query)
       18    0.949    0.053    0.949    0.053 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.237    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.236    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.214    0.071 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.961 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  284.961  284.961 simple.py:52(score)
        3    0.000    0.000  284.952   94.984 profilehooks.py:257(new_fn)
        3    0.149    0.050  284.952   94.984 profilehooks.py:348(__call__)
        3    0.011    0.004  283.978   94.659 kb.py:122(neighbors)
        9  280.703   31.189  280.704   31.189 nms.py:31(build)
        2    0.110    0.055  190.656   95.328 kb.py:75(score)
        1    0.000    0.000   94.199   94.199 simple.py:29(hop)
        1    0.044    0.044   94.147   94.147 kb.py:156(forward)
        3    2.721    0.907    2.738    0.913 nms.py:51(query)
       18    0.894    0.050    0.894    0.050 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:31.349412

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.987 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  284.987  284.987 simple.py:52(score)
        3    0.000    0.000  284.978   94.993 profilehooks.py:257(new_fn)
        3    0.144    0.048  284.978   94.993 profilehooks.py:348(__call__)
        3    0.011    0.004  283.883   94.628 kb.py:122(neighbors)
        9  281.160   31.240  281.161   31.240 nms.py:31(build)
        2    0.113    0.056  189.621   94.810 kb.py:75(score)
        1    0.000    0.000   95.261   95.261 simple.py:29(hop)
        1    0.041    0.041   95.214   95.214 kb.py:156(forward)
        3    2.176    0.725    2.194    0.731 nms.py:51(query)
       18    0.986    0.055    0.986    0.055 {built-in method cat}
    18/15    0.001    0.000    0.248    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.242    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.217    0.072 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.747 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  283.747  283.747 simple.py:52(score)
        3    0.000    0.000  283.739   94.580 profilehooks.py:257(new_fn)
        3    0.141    0.047  283.739   94.580 profilehooks.py:348(__call__)
        3    0.011    0.004  282.799   94.266 kb.py:122(neighbors)
        9  279.664   31.074  279.666   31.074 nms.py:31(build)
        2    0.117    0.058  190.118   95.059 kb.py:75(score)
        1    0.000    0.000   93.521   93.521 simple.py:29(hop)
        1    0.043    0.043   93.479   93.479 kb.py:156(forward)
        3    2.591    0.864    2.607    0.869 nms.py:51(query)
       18    0.844    0.047    0.844    0.047 {built-in method cat}
    18/15    0.001    0.000    0.232    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.226    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.225    0.017 functional.py:1774(embedding)
       13    0.225    0.017    0.225    0.017 {built-in method embedding}
        3    0.000    0.000    0.201    0.067 kb.py:68(generate_facts)
        3    0.054    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:32.476210

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.015 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.015  283.015 simple.py:52(score)
        3    0.000    0.000  283.003   94.334 profilehooks.py:257(new_fn)
        3    0.139    0.046  283.003   94.334 profilehooks.py:348(__call__)
        3    0.010    0.003  282.035   94.012 kb.py:122(neighbors)
        9  279.413   31.046  279.414   31.046 nms.py:31(build)
        2    0.108    0.054  189.207   94.603 kb.py:75(score)
        1    0.000    0.000   93.700   93.700 simple.py:29(hop)
        1    0.042    0.042   93.657   93.657 kb.py:156(forward)
        3    2.073    0.691    2.089    0.696 nms.py:51(query)
       18    0.886    0.049    0.886    0.049 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.234    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.234    0.018 functional.py:1774(embedding)
       13    0.234    0.018    0.234    0.018 {built-in method embedding}
        3    0.000    0.000    0.211    0.070 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.008    0.004 base.py:142(forward)
        2    0.000    0.000    0.008    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.008    0.003 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.007    0.002    0.007    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.117 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.117  283.117 simple.py:52(score)
        3    0.000    0.000  283.109   94.370 profilehooks.py:257(new_fn)
        3    0.130    0.043  283.109   94.370 profilehooks.py:348(__call__)
        3    0.024    0.008  282.243   94.081 kb.py:122(neighbors)
        9  278.995   30.999  278.996   31.000 nms.py:31(build)
        2    0.083    0.042  188.826   94.413 kb.py:75(score)
        1    0.000    0.000   94.195   94.195 simple.py:29(hop)
        1    0.042    0.042   94.154   94.154 kb.py:156(forward)
        3    2.686    0.895    2.703    0.901 nms.py:51(query)
       18    0.848    0.047    0.848    0.047 {built-in method cat}
    18/15    0.001    0.000    0.211    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.206    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.206    0.016 functional.py:1774(embedding)
       13    0.206    0.016    0.206    0.016 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.050    0.017    0.054    0.018 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:30.314481

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.576 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  283.576  283.576 simple.py:52(score)
        3    0.000    0.000  283.569   94.523 profilehooks.py:257(new_fn)
        3    0.145    0.048  283.569   94.523 profilehooks.py:348(__call__)
        3    0.010    0.003  282.628   94.209 kb.py:122(neighbors)
        9  279.782   31.087  279.784   31.087 nms.py:31(build)
        2    0.122    0.061  190.469   95.235 kb.py:75(score)
        1    0.000    0.000   92.998   92.998 simple.py:29(hop)
        1    0.042    0.042   92.955   92.955 kb.py:156(forward)
        3    2.293    0.764    2.309    0.770 nms.py:51(query)
       18    0.845    0.047    0.845    0.047 {built-in method cat}
    18/15    0.001    0.000    0.240    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.235    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.235    0.018 functional.py:1774(embedding)
       13    0.235    0.018    0.235    0.018 {built-in method embedding}
        3    0.000    0.000    0.213    0.071 kb.py:68(generate_facts)
        3    0.051    0.017    0.055    0.018 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.293 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.293  284.293 simple.py:52(score)
        3    0.000    0.000  284.286   94.762 profilehooks.py:257(new_fn)
        3    0.137    0.046  284.286   94.762 profilehooks.py:348(__call__)
        3    0.011    0.004  283.393   94.464 kb.py:122(neighbors)
        9  280.174   31.130  280.175   31.131 nms.py:31(build)
        2    0.084    0.042  189.860   94.930 kb.py:75(score)
        1    0.000    0.000   94.336   94.336 simple.py:29(hop)
        1    0.047    0.047   94.289   94.289 kb.py:156(forward)
        3    2.657    0.886    2.674    0.891 nms.py:51(query)
       18    0.858    0.048    0.858    0.048 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.217    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.217    0.017 functional.py:1774(embedding)
       13    0.217    0.017    0.217    0.017 {built-in method embedding}
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.005    0.002 kb.py:62(to_tnsr)
        3    0.004    0.001    0.004    0.001 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:31.562996

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.664 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.664  283.664 simple.py:52(score)
        3    0.000    0.000  283.653   94.551 profilehooks.py:257(new_fn)
        3    0.130    0.043  283.653   94.551 profilehooks.py:348(__call__)
        3    0.010    0.003  282.689   94.230 kb.py:122(neighbors)
        9  279.907   31.101  279.909   31.101 nms.py:31(build)
        2    0.085    0.042  189.824   94.912 kb.py:75(score)
        1    0.000    0.000   93.742   93.742 simple.py:29(hop)
        1    0.042    0.042   93.700   93.700 kb.py:156(forward)
        3    2.239    0.746    2.255    0.752 nms.py:51(query)
       18    0.893    0.050    0.893    0.050 {built-in method cat}
    18/15    0.001    0.000    0.257    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.250    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.250    0.019 functional.py:1774(embedding)
       13    0.250    0.019    0.250    0.019 {built-in method embedding}
        3    0.000    0.000    0.229    0.076 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.035 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.035  285.035 simple.py:52(score)
        3    0.000    0.000  285.027   95.009 profilehooks.py:257(new_fn)
        3    0.138    0.046  285.027   95.009 profilehooks.py:348(__call__)
        3    0.011    0.004  284.017   94.672 kb.py:122(neighbors)
        9  280.822   31.202  280.824   31.203 nms.py:31(build)
        2    0.110    0.055  190.081   95.041 kb.py:75(score)
        1    0.000    0.000   94.850   94.850 simple.py:29(hop)
        1    0.042    0.042   94.808   94.808 kb.py:156(forward)
        3    2.643    0.881    2.659    0.886 nms.py:51(query)
       18    0.945    0.052    0.945    0.052 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:32.047797

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.828 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  285.828  285.828 simple.py:52(score)
        3    0.000    0.000  285.819   95.273 profilehooks.py:257(new_fn)
        3    0.139    0.046  285.819   95.273 profilehooks.py:348(__call__)
        3    0.011    0.004  284.771   94.924 kb.py:122(neighbors)
        9  281.947   31.327  281.948   31.328 nms.py:31(build)
        2    0.116    0.058  190.700   95.350 kb.py:75(score)
        1    0.000    0.000   95.024   95.024 simple.py:29(hop)
        1    0.042    0.042   94.981   94.981 kb.py:156(forward)
        3    2.242    0.747    2.259    0.753 nms.py:51(query)
       18    0.926    0.051    0.926    0.051 {built-in method cat}
    18/15    0.001    0.000    0.299    0.020 module.py:715(_call_impl)
       13    0.000    0.000    0.292    0.022 sparse.py:123(forward)
       13    0.000    0.000    0.292    0.022 functional.py:1774(embedding)
       13    0.292    0.022    0.292    0.022 {built-in method embedding}
        3    0.000    0.000    0.263    0.088 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.844 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  285.844  285.844 simple.py:52(score)
        3    0.000    0.000  285.835   95.278 profilehooks.py:257(new_fn)
        3    0.140    0.047  285.835   95.278 profilehooks.py:348(__call__)
        3    0.010    0.003  284.858   94.953 kb.py:122(neighbors)
        9  281.578   31.286  281.579   31.287 nms.py:31(build)
        2    0.113    0.057  191.437   95.719 kb.py:75(score)
        1    0.000    0.000   94.301   94.301 simple.py:29(hop)
        1    0.042    0.042   94.258   94.258 kb.py:156(forward)
        3    2.728    0.909    2.744    0.915 nms.py:51(query)
       18    0.915    0.051    0.915    0.051 {built-in method cat}
    18/15    0.001    0.000    0.214    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.208    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.207    0.016 functional.py:1774(embedding)
       13    0.207    0.016    0.207    0.016 {built-in method embedding}
        3    0.000    0.000    0.183    0.061 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:35.719343

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.917 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.917  286.917 simple.py:52(score)
        3    0.000    0.000  286.910   95.637 profilehooks.py:257(new_fn)
        3    0.140    0.047  286.910   95.637 profilehooks.py:348(__call__)
        3    0.011    0.004  285.910   95.303 kb.py:122(neighbors)
        9  283.132   31.459  283.134   31.459 nms.py:31(build)
        2    0.119    0.059  191.306   95.653 kb.py:75(score)
        1    0.000    0.000   95.505   95.505 simple.py:29(hop)
        1    0.042    0.042   95.464   95.464 kb.py:156(forward)
        3    2.225    0.742    2.241    0.747 nms.py:51(query)
       18    0.925    0.051    0.925    0.051 {built-in method cat}
    18/15    0.001    0.000    0.217    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.614 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.614  287.614 simple.py:52(score)
        3    0.000    0.000  287.606   95.869 profilehooks.py:257(new_fn)
        3    0.145    0.048  287.606   95.869 profilehooks.py:348(__call__)
        3    0.011    0.004  286.590   95.530 kb.py:122(neighbors)
        9  283.343   31.483  283.344   31.483 nms.py:31(build)
        2    0.123    0.062  192.287   96.143 kb.py:75(score)
        1    0.000    0.000   95.218   95.218 simple.py:29(hop)
        1    0.042    0.042   95.174   95.174 kb.py:156(forward)
        3    2.706    0.902    2.722    0.907 nms.py:51(query)
       18    0.897    0.050    0.897    0.050 {built-in method cat}
    18/15    0.001    0.000    0.240    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.235    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.234    0.018 functional.py:1774(embedding)
       13    0.234    0.018    0.234    0.018 {built-in method embedding}
        3    0.000    0.000    0.207    0.069 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:38.219581

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.204 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  283.204  283.204 simple.py:52(score)
        3    0.000    0.000  283.196   94.399 profilehooks.py:257(new_fn)
        3    0.144    0.048  283.196   94.399 profilehooks.py:348(__call__)
        3    0.011    0.004  282.192   94.064 kb.py:122(neighbors)
        9  279.377   31.042  279.379   31.042 nms.py:31(build)
        2    0.087    0.044  188.583   94.291 kb.py:75(score)
        1    0.000    0.000   94.525   94.525 simple.py:29(hop)
        1    0.083    0.083   94.469   94.469 kb.py:156(forward)
        3    2.251    0.750    2.268    0.756 nms.py:51(query)
       18    0.897    0.050    0.897    0.050 {built-in method cat}
    18/15    0.001    0.000    0.227    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.222    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.221    0.017 functional.py:1774(embedding)
       13    0.221    0.017    0.221    0.017 {built-in method embedding}
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
        3    0.076    0.025    0.080    0.027 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.802 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.802  285.802 simple.py:52(score)
        3    0.000    0.000  285.795   95.265 profilehooks.py:257(new_fn)
        3    0.162    0.054  285.795   95.265 profilehooks.py:348(__call__)
        3    0.011    0.004  284.859   94.953 kb.py:122(neighbors)
        9  281.719   31.302  281.721   31.302 nms.py:31(build)
        2    0.111    0.055  190.740   95.370 kb.py:75(score)
        1    0.000    0.000   94.934   94.934 simple.py:29(hop)
        1    0.042    0.042   94.893   94.893 kb.py:156(forward)
        3    2.576    0.859    2.593    0.864 nms.py:51(query)
       18    0.846    0.047    0.846    0.047 {built-in method cat}
    18/15    0.001    0.000    0.221    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.215    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.215    0.017 functional.py:1774(embedding)
       13    0.215    0.017    0.215    0.017 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.030    0.003    0.030    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:32.571567

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 282.976 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  282.976  282.976 simple.py:52(score)
        3    0.000    0.000  282.968   94.323 profilehooks.py:257(new_fn)
        3    0.130    0.043  282.968   94.323 profilehooks.py:348(__call__)
        3    0.010    0.003  282.047   94.016 kb.py:122(neighbors)
        9  279.375   31.042  279.376   31.042 nms.py:31(build)
        2    0.086    0.043  188.462   94.231 kb.py:75(score)
        1    0.000    0.000   94.418   94.418 simple.py:29(hop)
        1    0.043    0.043   94.376   94.376 kb.py:156(forward)
        3    2.120    0.707    2.136    0.712 nms.py:51(query)
       18    0.871    0.048    0.871    0.048 {built-in method cat}
    18/15    0.001    0.000    0.236    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.230    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.230    0.018 functional.py:1774(embedding)
       13    0.230    0.018    0.230    0.018 {built-in method embedding}
        3    0.000    0.000    0.210    0.070 kb.py:68(generate_facts)
        3    0.056    0.019    0.060    0.020 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.420 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.420  285.420 simple.py:52(score)
        3    0.000    0.000  285.414   95.138 profilehooks.py:257(new_fn)
        3    0.132    0.044  285.414   95.138 profilehooks.py:348(__call__)
        3    0.010    0.003  284.552   94.851 kb.py:122(neighbors)
        9  281.406   31.267  281.407   31.267 nms.py:31(build)
        2    0.084    0.042  190.508   95.254 kb.py:75(score)
        1    0.000    0.000   94.818   94.818 simple.py:29(hop)
        1    0.042    0.042   94.774   94.774 kb.py:156(forward)
        3    2.604    0.868    2.619    0.873 nms.py:51(query)
       18    0.825    0.046    0.825    0.046 {built-in method cat}
    18/15    0.001    0.000    0.219    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.214    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.214    0.016 functional.py:1774(embedding)
       13    0.214    0.016    0.214    0.016 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.049    0.016    0.053    0.018 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.003    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:32.553872

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.711 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.007    0.007  286.711  286.711 simple.py:52(score)
        3    0.000    0.000  286.696   95.565 profilehooks.py:257(new_fn)
        3    0.136    0.045  286.696   95.565 profilehooks.py:348(__call__)
        3    0.011    0.004  285.648   95.216 kb.py:122(neighbors)
        9  282.797   31.422  282.799   31.422 nms.py:31(build)
        2    0.085    0.042  190.708   95.354 kb.py:75(score)
        1    0.000    0.000   95.901   95.901 simple.py:29(hop)
        1    0.072    0.072   95.851   95.851 kb.py:156(forward)
        3    2.303    0.768    2.320    0.773 nms.py:51(query)
       18    0.918    0.051    0.918    0.051 {built-in method cat}
    18/15    0.001    0.000    0.275    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.269    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.269    0.021 functional.py:1774(embedding)
       13    0.269    0.021    0.269    0.021 {built-in method embedding}
        3    0.000    0.000    0.245    0.082 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.849 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  286.849  286.849 simple.py:52(score)
        3    0.000    0.000  286.840   95.613 profilehooks.py:257(new_fn)
        3    0.137    0.046  286.840   95.613 profilehooks.py:348(__call__)
        3    0.011    0.004  285.829   95.276 kb.py:122(neighbors)
        9  282.646   31.405  282.648   31.405 nms.py:31(build)
        2    0.087    0.043  191.526   95.763 kb.py:75(score)
        1    0.000    0.000   95.226   95.226 simple.py:29(hop)
        1    0.067    0.067   95.178   95.178 kb.py:156(forward)
        3    2.609    0.870    2.626    0.875 nms.py:51(query)
       18    0.959    0.053    0.959    0.053 {built-in method cat}
    18/15    0.001    0.000    0.223    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.217    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.216    0.017 functional.py:1774(embedding)
       13    0.216    0.017    0.216    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:37.303826

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.507 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.507  284.507 simple.py:52(score)
        3    0.000    0.000  284.499   94.833 profilehooks.py:257(new_fn)
        3    0.142    0.047  284.499   94.833 profilehooks.py:348(__call__)
        3    0.010    0.003  283.529   94.510 kb.py:122(neighbors)
        9  280.792   31.199  280.794   31.199 nms.py:31(build)
        2    0.116    0.058  190.444   95.222 kb.py:75(score)
        1    0.000    0.000   93.955   93.955 simple.py:29(hop)
        1    0.042    0.042   93.913   93.913 kb.py:156(forward)
        3    2.165    0.722    2.180    0.727 nms.py:51(query)
       18    0.907    0.050    0.907    0.050 {built-in method cat}
    18/15    0.001    0.000    0.233    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.227    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.227    0.017 functional.py:1774(embedding)
       13    0.226    0.017    0.226    0.017 {built-in method embedding}
        3    0.000    0.000    0.205    0.068 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.351 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.351  286.351 simple.py:52(score)
        3    0.000    0.000  286.342   95.447 profilehooks.py:257(new_fn)
        3    0.143    0.048  286.342   95.447 profilehooks.py:348(__call__)
        3    0.011    0.004  285.177   95.059 kb.py:122(neighbors)
        9  282.036   31.337  282.038   31.338 nms.py:31(build)
        2    0.129    0.065  191.091   95.546 kb.py:75(score)
        1    0.000    0.000   95.150   95.150 simple.py:29(hop)
        1    0.043    0.043   95.108   95.108 kb.py:156(forward)
        3    2.534    0.845    2.551    0.850 nms.py:51(query)
       18    1.021    0.057    1.021    0.057 {built-in method cat}
    18/15    0.001    0.000    0.307    0.020 module.py:715(_call_impl)
       13    0.000    0.000    0.300    0.023 sparse.py:123(forward)
       13    0.000    0.000    0.299    0.023 functional.py:1774(embedding)
       13    0.299    0.023    0.299    0.023 {built-in method embedding}
        3    0.000    0.000    0.269    0.090 kb.py:68(generate_facts)
        3    0.065    0.022    0.070    0.023 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.009    0.003 kb.py:62(to_tnsr)
        3    0.008    0.003    0.008    0.003 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:34.956576

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.016 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.016  286.016 simple.py:52(score)
        3    0.000    0.000  286.008   95.336 profilehooks.py:257(new_fn)
        3    0.143    0.048  286.008   95.336 profilehooks.py:348(__call__)
        3    0.011    0.004  285.029   95.010 kb.py:122(neighbors)
        9  282.236   31.360  282.238   31.360 nms.py:31(build)
        2    0.123    0.062  190.834   95.417 kb.py:75(score)
        1    0.000    0.000   95.073   95.073 simple.py:29(hop)
        1    0.043    0.043   95.031   95.031 kb.py:156(forward)
        3    2.214    0.738    2.231    0.744 nms.py:51(query)
       18    0.896    0.050    0.896    0.050 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.237    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.237    0.018 functional.py:1774(embedding)
       13    0.237    0.018    0.237    0.018 {built-in method embedding}
        3    0.000    0.000    0.210    0.070 kb.py:68(generate_facts)
        3    0.056    0.019    0.060    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.663 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  285.663  285.663 simple.py:52(score)
        3    0.000    0.000  285.655   95.218 profilehooks.py:257(new_fn)
        3    0.130    0.043  285.655   95.218 profilehooks.py:348(__call__)
        3    0.011    0.004  284.687   94.896 kb.py:122(neighbors)
        9  281.453   31.273  281.454   31.273 nms.py:31(build)
        2    0.086    0.043  190.789   95.394 kb.py:75(score)
        1    0.000    0.000   94.778   94.778 simple.py:29(hop)
        1    0.042    0.042   94.736   94.736 kb.py:156(forward)
        3    2.623    0.874    2.639    0.880 nms.py:51(query)
       18    0.985    0.055    0.985    0.055 {built-in method cat}
    18/15    0.001    0.000    0.230    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.224    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.224    0.017 functional.py:1774(embedding)
       13    0.224    0.017    0.224    0.017 {built-in method embedding}
        3    0.000    0.000    0.200    0.067 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:36.032504

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 284.347 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  284.347  284.347 simple.py:52(score)
        3    0.000    0.000  284.337   94.779 profilehooks.py:257(new_fn)
        3    0.144    0.048  284.337   94.779 profilehooks.py:348(__call__)
        3    0.010    0.003  283.337   94.446 kb.py:122(neighbors)
        9  280.600   31.178  280.602   31.178 nms.py:31(build)
        2    0.084    0.042  189.396   94.698 kb.py:75(score)
        1    0.000    0.000   94.852   94.852 simple.py:29(hop)
        1    0.080    0.080   94.797   94.797 kb.py:156(forward)
        3    2.190    0.730    2.205    0.735 nms.py:51(query)
       18    0.857    0.048    0.857    0.048 {built-in method cat}
    18/15    0.001    0.000    0.252    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.246    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.246    0.019 functional.py:1774(embedding)
       13    0.246    0.019    0.246    0.019 {built-in method embedding}
        3    0.000    0.000    0.224    0.075 kb.py:68(generate_facts)
        3    0.080    0.027    0.085    0.028 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.014    0.005    0.014    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 283.713 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  283.713  283.713 simple.py:52(score)
        3    0.000    0.000  283.705   94.568 profilehooks.py:257(new_fn)
        3    0.129    0.043  283.705   94.568 profilehooks.py:348(__call__)
        3    0.011    0.004  282.817   94.272 kb.py:122(neighbors)
        9  279.682   31.076  279.683   31.076 nms.py:31(build)
        2    0.084    0.042  190.052   95.026 kb.py:75(score)
        1    0.000    0.000   93.565   93.565 simple.py:29(hop)
        1    0.042    0.042   93.524   93.524 kb.py:156(forward)
        3    2.587    0.862    2.603    0.868 nms.py:51(query)
       18    0.854    0.047    0.854    0.047 {built-in method cat}
    18/15    0.001    0.000    0.225    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.220    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.220    0.017 functional.py:1774(embedding)
       13    0.220    0.017    0.220    0.017 {built-in method embedding}
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:31.668299

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.589 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  285.589  285.589 simple.py:52(score)
        3    0.000    0.000  285.582   95.194 profilehooks.py:257(new_fn)
        3    0.145    0.048  285.582   95.194 profilehooks.py:348(__call__)
        3    0.010    0.003  284.584   94.861 kb.py:122(neighbors)
        9  281.950   31.328  281.952   31.328 nms.py:31(build)
        2    0.084    0.042  189.790   94.895 kb.py:75(score)
        1    0.000    0.000   95.704   95.704 simple.py:29(hop)
        1    0.079    0.079   95.648   95.648 kb.py:156(forward)
        3    2.049    0.683    2.064    0.688 nms.py:51(query)
       18    0.933    0.052    0.933    0.052 {built-in method cat}
    18/15    0.001    0.000    0.239    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.234    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.234    0.018 functional.py:1774(embedding)
       13    0.234    0.018    0.234    0.018 {built-in method embedding}
        3    0.000    0.000    0.212    0.071 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.258 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.258  285.258 simple.py:52(score)
        3    0.000    0.000  285.251   95.084 profilehooks.py:257(new_fn)
        3    0.130    0.043  285.251   95.084 profilehooks.py:348(__call__)
        3    0.010    0.003  284.382   94.794 kb.py:122(neighbors)
        9  281.363   31.263  281.365   31.263 nms.py:31(build)
        2    0.084    0.042  190.268   95.134 kb.py:75(score)
        1    0.000    0.000   94.895   94.895 simple.py:29(hop)
        1    0.045    0.045   94.852   94.852 kb.py:156(forward)
        3    2.470    0.823    2.486    0.829 nms.py:51(query)
       18    0.838    0.047    0.838    0.047 {built-in method cat}
    18/15    0.001    0.000    0.217    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:34.270481

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.389 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.389  285.389 simple.py:52(score)
        3    0.000    0.000  285.381   95.127 profilehooks.py:257(new_fn)
        3    0.143    0.048  285.381   95.127 profilehooks.py:348(__call__)
        3    0.010    0.003  284.451   94.817 kb.py:122(neighbors)
        9  281.850   31.317  281.851   31.317 nms.py:31(build)
        2    0.117    0.058  190.192   95.096 kb.py:75(score)
        1    0.000    0.000   95.089   95.089 simple.py:29(hop)
        1    0.042    0.042   95.047   95.047 kb.py:156(forward)
        3    2.058    0.686    2.074    0.691 nms.py:51(query)
       18    0.802    0.045    0.802    0.045 {built-in method cat}
    18/15    0.001    0.000    0.267    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.262    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.262    0.020 functional.py:1774(embedding)
       13    0.261    0.020    0.261    0.020 {built-in method embedding}
        3    0.000    0.000    0.239    0.080 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.716 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.716  285.716 simple.py:52(score)
        3    0.000    0.000  285.710   95.237 profilehooks.py:257(new_fn)
        3    0.131    0.044  285.710   95.237 profilehooks.py:348(__call__)
        3    0.010    0.003  284.811   94.937 kb.py:122(neighbors)
        9  281.858   31.318  281.859   31.318 nms.py:31(build)
        2    0.094    0.047  190.640   95.320 kb.py:75(score)
        1    0.000    0.000   94.982   94.982 simple.py:29(hop)
        1    0.042    0.042   94.939   94.939 kb.py:156(forward)
        3    2.422    0.807    2.438    0.813 nms.py:51(query)
       18    0.849    0.047    0.849    0.047 {built-in method cat}
    18/15    0.001    0.000    0.214    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.209    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.209    0.016 functional.py:1774(embedding)
       13    0.209    0.016    0.209    0.016 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.051    0.017    0.055    0.018 gaussian.py:28(__call__)
        9    0.018    0.002    0.018    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.003    0.001 linear.py:92(forward)
        3    0.000    0.000    0.003    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:34.589420

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.537 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.537  285.537 simple.py:52(score)
        3    0.000    0.000  285.529   95.176 profilehooks.py:257(new_fn)
        3    0.141    0.047  285.529   95.176 profilehooks.py:348(__call__)
        3    0.012    0.004  284.608   94.869 kb.py:122(neighbors)
        9  282.017   31.335  282.019   31.335 nms.py:31(build)
        2    0.085    0.043  190.961   95.480 kb.py:75(score)
        1    0.000    0.000   94.481   94.481 simple.py:29(hop)
        1    0.075    0.075   94.427   94.427 kb.py:156(forward)
        3    2.054    0.685    2.071    0.690 nms.py:51(query)
       18    0.834    0.046    0.834    0.046 {built-in method cat}
    18/15    0.001    0.000    0.214    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.208    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.208    0.016 functional.py:1774(embedding)
       13    0.208    0.016    0.208    0.016 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.670 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.670  286.670 simple.py:52(score)
        3    0.000    0.000  286.663   95.554 profilehooks.py:257(new_fn)
        3    0.132    0.044  286.663   95.554 profilehooks.py:348(__call__)
        3    0.010    0.003  285.834   95.278 kb.py:122(neighbors)
        9  282.765   31.418  282.767   31.419 nms.py:31(build)
        2    0.083    0.042  192.403   96.201 kb.py:75(score)
        1    0.000    0.000   94.170   94.170 simple.py:29(hop)
        1    0.042    0.042   94.128   94.128 kb.py:156(forward)
        3    2.512    0.837    2.527    0.842 nms.py:51(query)
       18    0.780    0.043    0.780    0.043 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.238    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.238    0.018 functional.py:1774(embedding)
       13    0.238    0.018    0.238    0.018 {built-in method embedding}
        3    0.000    0.000    0.198    0.066 kb.py:68(generate_facts)
        3    0.053    0.018    0.057    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.014    0.005    0.014    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:35.780961

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.781 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.781  285.781 simple.py:52(score)
        3    0.000    0.000  285.773   95.258 profilehooks.py:257(new_fn)
        3    0.128    0.043  285.773   95.258 profilehooks.py:348(__call__)
        3    0.010    0.003  284.847   94.949 kb.py:122(neighbors)
        9  282.157   31.351  282.158   31.351 nms.py:31(build)
        2    0.083    0.041  190.953   95.476 kb.py:75(score)
        1    0.000    0.000   94.732   94.732 simple.py:29(hop)
        1    0.043    0.043   94.692   94.692 kb.py:156(forward)
        3    2.112    0.704    2.128    0.709 nms.py:51(query)
       18    0.908    0.050    0.908    0.050 {built-in method cat}
    18/15    0.001    0.000    0.248    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.242    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.222    0.074 kb.py:68(generate_facts)
        3    0.049    0.016    0.053    0.018 gaussian.py:28(__call__)
        9    0.018    0.002    0.018    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.001    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.428 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.428  286.428 simple.py:52(score)
        3    0.000    0.000  286.421   95.474 profilehooks.py:257(new_fn)
        3    0.148    0.049  286.421   95.474 profilehooks.py:348(__call__)
        3    0.011    0.004  285.491   95.164 kb.py:122(neighbors)
        9  282.307   31.367  282.309   31.368 nms.py:31(build)
        2    0.128    0.064  192.046   96.023 kb.py:75(score)
        1    0.000    0.000   94.268   94.268 simple.py:29(hop)
        1    0.044    0.044   94.226   94.226 kb.py:156(forward)
        3    2.644    0.881    2.661    0.887 nms.py:51(query)
       18    0.823    0.046    0.823    0.046 {built-in method cat}
    18/15    0.001    0.000    0.223    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.218    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.217    0.017 functional.py:1774(embedding)
       13    0.217    0.017    0.217    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        3    0.003    0.001    0.003    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:36.119403

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.394 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  289.394  289.394 simple.py:52(score)
        3    0.000    0.000  289.384   96.461 profilehooks.py:257(new_fn)
        3    0.147    0.049  289.384   96.461 profilehooks.py:348(__call__)
        3    0.011    0.004  288.259   96.086 kb.py:122(neighbors)
        9  285.412   31.712  285.414   31.713 nms.py:31(build)
        2    0.085    0.042  193.288   96.644 kb.py:75(score)
        1    0.000    0.000   96.001   96.001 simple.py:29(hop)
        1    0.085    0.085   95.949   95.949 kb.py:156(forward)
        3    2.266    0.755    2.283    0.761 nms.py:51(query)
       18    0.996    0.055    0.996    0.055 {built-in method cat}
    18/15    0.001    0.000    0.280    0.019 module.py:715(_call_impl)
       13    0.000    0.000    0.272    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.272    0.021 functional.py:1774(embedding)
       13    0.272    0.021    0.272    0.021 {built-in method embedding}
        3    0.000    0.000    0.242    0.081 kb.py:68(generate_facts)
        3    0.059    0.020    0.064    0.021 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.173 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  288.173  288.173 simple.py:52(score)
        3    0.000    0.000  288.165   96.055 profilehooks.py:257(new_fn)
        3    0.143    0.048  288.164   96.055 profilehooks.py:348(__call__)
        3    0.011    0.004  287.177   95.726 kb.py:122(neighbors)
        9  284.074   31.564  284.075   31.564 nms.py:31(build)
        2    0.085    0.043  192.406   96.203 kb.py:75(score)
        1    0.000    0.000   95.669   95.669 simple.py:29(hop)
        1    0.085    0.085   95.615   95.615 kb.py:156(forward)
        3    2.535    0.845    2.551    0.850 nms.py:51(query)
       18    0.907    0.050    0.907    0.050 {built-in method cat}
    18/15    0.001    0.000    0.223    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.217    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.217    0.017 functional.py:1774(embedding)
       13    0.217    0.017    0.217    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:41.688247

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.902 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  288.902  288.902 simple.py:52(score)
        3    0.000    0.000  288.892   96.297 profilehooks.py:257(new_fn)
        3    0.140    0.047  288.892   96.297 profilehooks.py:348(__call__)
        3    0.011    0.004  287.814   95.938 kb.py:122(neighbors)
        9  285.028   31.670  285.029   31.670 nms.py:31(build)
        2    0.086    0.043  192.477   96.239 kb.py:75(score)
        1    0.000    0.000   96.327   96.327 simple.py:29(hop)
        1    0.068    0.068   96.275   96.275 kb.py:156(forward)
        3    2.240    0.747    2.257    0.752 nms.py:51(query)
       18    0.949    0.053    0.949    0.053 {built-in method cat}
    18/15    0.001    0.000    0.262    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.255    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.255    0.020 functional.py:1774(embedding)
       13    0.255    0.020    0.255    0.020 {built-in method embedding}
        3    0.000    0.000    0.224    0.075 kb.py:68(generate_facts)
        3    0.060    0.020    0.065    0.022 gaussian.py:28(__call__)
        9    0.028    0.003    0.028    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.823 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.823  289.823 simple.py:52(score)
        3    0.000    0.000  289.815   96.605 profilehooks.py:257(new_fn)
        3    0.146    0.049  289.815   96.605 profilehooks.py:348(__call__)
        3    0.011    0.004  288.823   96.274 kb.py:122(neighbors)
        9  285.657   31.740  285.658   31.740 nms.py:31(build)
        2    0.085    0.043  193.026   96.513 kb.py:75(score)
        1    0.000    0.000   96.695   96.695 simple.py:29(hop)
        1    0.080    0.080   96.643   96.643 kb.py:156(forward)
        3    2.594    0.865    2.610    0.870 nms.py:51(query)
       18    0.923    0.051    0.923    0.051 {built-in method cat}
    18/15    0.001    0.000    0.213    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.208    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.208    0.016 functional.py:1774(embedding)
       13    0.207    0.016    0.207    0.016 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.064    0.021    0.068    0.023 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:42.721610

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.094 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.093  286.093 simple.py:52(score)
        3    0.000    0.000  286.090   95.363 profilehooks.py:257(new_fn)
        3    0.120    0.040  286.090   95.363 profilehooks.py:348(__call__)
        3    0.002    0.001  285.306   95.102 kb.py:122(neighbors)
        9  284.310   31.590  284.311   31.590 nms.py:31(build)
        2    0.088    0.044  190.588   95.294 kb.py:75(score)
        1    0.000    0.000   95.421   95.421 simple.py:29(hop)
        1    0.042    0.042   95.382   95.382 kb.py:156(forward)
       18    0.846    0.047    0.846    0.047 {built-in method cat}
        3    0.478    0.159    0.480    0.160 nms.py:51(query)
    18/15    0.001    0.000    0.192    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.189    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.189    0.015 functional.py:1774(embedding)
       13    0.189    0.015    0.189    0.015 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.003    0.001    0.005    0.002 gaussian.py:28(__call__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sum}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 287.187 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  287.187  287.187 simple.py:52(score)
        3    0.000    0.000  287.183   95.728 profilehooks.py:257(new_fn)
        3    0.134    0.045  287.183   95.728 profilehooks.py:348(__call__)
        3    0.002    0.001  286.430   95.477 kb.py:122(neighbors)
        9  285.438   31.715  285.440   31.716 nms.py:31(build)
        2    0.113    0.056  192.619   96.309 kb.py:75(score)
        1    0.000    0.000   94.471   94.471 simple.py:29(hop)
        1    0.042    0.042   94.430   94.430 kb.py:156(forward)
       18    0.795    0.044    0.795    0.044 {built-in method cat}
        3    0.451    0.150    0.452    0.151 nms.py:51(query)
    18/15    0.001    0.000    0.195    0.013 module.py:715(_call_impl)
       13    0.000    0.000    0.192    0.015 sparse.py:123(forward)
       13    0.000    0.000    0.192    0.015 functional.py:1774(embedding)
       13    0.192    0.015    0.192    0.015 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.004    0.001    0.005    0.002 gaussian.py:28(__call__)
        9    0.002    0.000    0.002    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.002    0.001 base.py:142(forward)
        2    0.000    0.000    0.002    0.001 base.py:143(<listcomp>)
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        3    0.000    0.000    0.002    0.001 linear.py:92(forward)
        3    0.000    0.000    0.002    0.001 functional.py:1669(linear)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method addmm}
        3    0.001    0.000    0.001    0.000 {built-in method numpy.array}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sum}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method exp}


Time taken for this batch: 0:09:33.392613
INFO:hoppy-transe-cli.py:Final 	dev results	MRR 0.670154	H@1 0.501055	H@3 0.812889	H@5 0.942601	H@10 0.992044

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.478 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.478  289.478 simple.py:52(score)
        3    0.000    0.000  289.468   96.489 profilehooks.py:257(new_fn)
        3    0.136    0.045  289.468   96.489 profilehooks.py:348(__call__)
        3    0.011    0.004  288.478   96.159 kb.py:122(neighbors)
        9  285.647   31.739  285.648   31.739 nms.py:31(build)
        2    0.084    0.042  193.049   96.525 kb.py:75(score)
        1    0.000    0.000   96.331   96.331 simple.py:29(hop)
        1    0.067    0.067   96.282   96.282 kb.py:156(forward)
        3    2.240    0.747    2.255    0.752 nms.py:51(query)
       18    0.912    0.051    0.912    0.051 {built-in method cat}
    18/15    0.001    0.000    0.274    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.268    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.267    0.021 functional.py:1774(embedding)
       13    0.267    0.021    0.267    0.021 {built-in method embedding}
        3    0.000    0.000    0.241    0.080 kb.py:68(generate_facts)
        3    0.056    0.019    0.060    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.524 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.524  288.524 simple.py:52(score)
        3    0.000    0.000  288.515   96.172 profilehooks.py:257(new_fn)
        3    0.140    0.047  288.515   96.172 profilehooks.py:348(__call__)
        3    0.011    0.004  287.536   95.845 kb.py:122(neighbors)
        9  284.498   31.611  284.500   31.611 nms.py:31(build)
        2    0.115    0.057  191.515   95.758 kb.py:75(score)
        1    0.000    0.000   96.903   96.903 simple.py:29(hop)
        1    0.042    0.042   96.860   96.860 kb.py:156(forward)
        3    2.489    0.830    2.505    0.835 nms.py:51(query)
       18    0.873    0.049    0.873    0.049 {built-in method cat}
    18/15    0.001    0.000    0.248    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.243    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.243    0.019 functional.py:1774(embedding)
       13    0.243    0.019    0.243    0.019 {built-in method embedding}
        3    0.000    0.000    0.216    0.072 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:41.453026

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.169 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.169  290.169 simple.py:52(score)
        3    0.000    0.000  290.160   96.720 profilehooks.py:257(new_fn)
        3    0.144    0.048  290.160   96.720 profilehooks.py:348(__call__)
        3    0.011    0.004  289.167   96.389 kb.py:122(neighbors)
        9  286.421   31.825  286.423   31.825 nms.py:31(build)
        2    0.117    0.058  193.084   96.542 kb.py:75(score)
        1    0.000    0.000   96.972   96.972 simple.py:29(hop)
        1    0.042    0.042   96.932   96.932 kb.py:156(forward)
        3    2.135    0.712    2.151    0.717 nms.py:51(query)
       18    0.959    0.053    0.959    0.053 {built-in method cat}
    18/15    0.001    0.000    0.226    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.219    0.017 functional.py:1774(embedding)
       13    0.219    0.017    0.219    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.007    0.002 kb.py:62(to_tnsr)
        3    0.006    0.002    0.006    0.002 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.509 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.509  290.509 simple.py:52(score)
        3    0.000    0.000  290.501   96.834 profilehooks.py:257(new_fn)
        3    0.142    0.047  290.501   96.834 profilehooks.py:348(__call__)
        3    0.011    0.004  289.585   96.528 kb.py:122(neighbors)
        9  286.465   31.829  286.466   31.830 nms.py:31(build)
        2    0.118    0.059  193.407   96.703 kb.py:75(score)
        1    0.000    0.000   96.993   96.993 simple.py:29(hop)
        1    0.042    0.042   96.953   96.953 kb.py:156(forward)
        3    2.553    0.851    2.569    0.856 nms.py:51(query)
       18    0.844    0.047    0.844    0.047 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.216    0.017 functional.py:1774(embedding)
       13    0.215    0.017    0.215    0.017 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.059    0.020    0.064    0.021 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


Time taken for this batch: 0:09:44.706276

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.927 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.927  288.927 simple.py:52(score)
        3    0.000    0.000  288.919   96.306 profilehooks.py:257(new_fn)
        3    0.137    0.046  288.919   96.306 profilehooks.py:348(__call__)
        3    0.011    0.004  287.952   95.984 kb.py:122(neighbors)
        9  285.161   31.685  285.163   31.685 nms.py:31(build)
        2    0.118    0.059  192.578   96.289 kb.py:75(score)
        1    0.000    0.000   96.242   96.242 simple.py:29(hop)
        1    0.042    0.042   96.203   96.203 kb.py:156(forward)
        3    2.224    0.741    2.240    0.747 nms.py:51(query)
       18    0.876    0.049    0.876    0.049 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.242    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.214    0.071 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.315 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.315  288.315 simple.py:52(score)
        3    0.000    0.000  288.307   96.102 profilehooks.py:257(new_fn)
        3    0.141    0.047  288.307   96.102 profilehooks.py:348(__call__)
        3    0.011    0.004  287.307   95.769 kb.py:122(neighbors)
        9  284.167   31.574  284.168   31.574 nms.py:31(build)
        2    0.121    0.060  193.459   96.730 kb.py:75(score)
        1    0.000    0.000   94.747   94.747 simple.py:29(hop)
        1    0.042    0.042   94.707   94.707 kb.py:156(forward)
        3    2.548    0.849    2.564    0.855 nms.py:51(query)
       18    0.959    0.053    0.959    0.053 {built-in method cat}
    18/15    0.001    0.000    0.225    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.219    0.017 functional.py:1774(embedding)
       13    0.219    0.017    0.219    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:40.717197

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 288.430 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  288.430  288.430 simple.py:52(score)
        3    0.000    0.000  288.421   96.140 profilehooks.py:257(new_fn)
        3    0.136    0.045  288.421   96.140 profilehooks.py:348(__call__)
        3    0.011    0.004  287.464   95.821 kb.py:122(neighbors)
        9  284.719   31.635  284.721   31.636 nms.py:31(build)
        2    0.086    0.043  192.202   96.101 kb.py:75(score)
        1    0.000    0.000   96.130   96.130 simple.py:29(hop)
        1    0.044    0.044   96.082   96.082 kb.py:156(forward)
        3    2.204    0.735    2.220    0.740 nms.py:51(query)
       18    0.879    0.049    0.879    0.049 {built-in method cat}
    18/15    0.001    0.000    0.244    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.238    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.238    0.018 functional.py:1774(embedding)
       13    0.238    0.018    0.238    0.018 {built-in method embedding}
        3    0.000    0.000    0.211    0.070 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.299 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  289.299  289.299 simple.py:52(score)
        3    0.000    0.000  289.290   96.430 profilehooks.py:257(new_fn)
        3    0.141    0.047  289.290   96.430 profilehooks.py:348(__call__)
        3    0.011    0.004  288.380   96.127 kb.py:122(neighbors)
        9  285.100   31.678  285.101   31.678 nms.py:31(build)
        2    0.110    0.055  193.490   96.745 kb.py:75(score)
        1    0.000    0.000   95.699   95.699 simple.py:29(hop)
        1    0.043    0.043   95.659   95.659 kb.py:156(forward)
        3    2.734    0.911    2.750    0.917 nms.py:51(query)
       18    0.833    0.046    0.833    0.046 {built-in method cat}
    18/15    0.001    0.000    0.224    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.218    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.218    0.017 functional.py:1774(embedding)
       13    0.218    0.017    0.218    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:41.281365

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.354 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.354  290.354 simple.py:52(score)
        3    0.000    0.000  290.342   96.781 profilehooks.py:257(new_fn)
        3    0.153    0.051  290.342   96.781 profilehooks.py:348(__call__)
        3    0.014    0.005  289.246   96.415 kb.py:122(neighbors)
        9  286.468   31.830  286.470   31.830 nms.py:31(build)
        2    0.126    0.063  193.745   96.872 kb.py:75(score)
        1    0.000    0.000   96.490   96.490 simple.py:29(hop)
        1    0.044    0.044   96.444   96.444 kb.py:156(forward)
        3    2.181    0.727    2.198    0.733 nms.py:51(query)
       18    0.992    0.055    0.992    0.055 {built-in method cat}
    18/15    0.001    0.000    0.266    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.257    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.257    0.020 functional.py:1774(embedding)
       13    0.257    0.020    0.257    0.020 {built-in method embedding}
        3    0.000    0.000    0.230    0.077 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.004 base.py:142(forward)
        2    0.000    0.000    0.007    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.164 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.164  290.164 simple.py:52(score)
        3    0.000    0.000  290.155   96.718 profilehooks.py:257(new_fn)
        3    0.149    0.050  290.155   96.718 profilehooks.py:348(__call__)
        3    0.011    0.004  289.182   96.394 kb.py:122(neighbors)
        9  286.057   31.784  286.059   31.784 nms.py:31(build)
        2    0.122    0.061  193.785   96.893 kb.py:75(score)
        1    0.000    0.000   96.268   96.268 simple.py:29(hop)
        1    0.042    0.042   96.220   96.220 kb.py:156(forward)
        3    2.557    0.852    2.573    0.858 nms.py:51(query)
       18    0.878    0.049    0.878    0.049 {built-in method cat}
    18/15    0.001    0.000    0.238    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.232    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.232    0.018 functional.py:1774(embedding)
       13    0.232    0.018    0.232    0.018 {built-in method embedding}
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:44.999587

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.017 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  289.017  289.017 simple.py:52(score)
        3    0.000    0.000  289.007   96.336 profilehooks.py:257(new_fn)
        3    0.145    0.048  289.007   96.336 profilehooks.py:348(__call__)
        3    0.011    0.004  287.971   95.990 kb.py:122(neighbors)
        9  285.295   31.699  285.296   31.700 nms.py:31(build)
        2    0.125    0.062  192.682   96.341 kb.py:75(score)
        1    0.000    0.000   96.221   96.221 simple.py:29(hop)
        1    0.048    0.048   96.180   96.180 kb.py:156(forward)
        3    2.114    0.705    2.131    0.710 nms.py:51(query)
       18    0.917    0.051    0.917    0.051 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.236    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.235    0.018 functional.py:1774(embedding)
       13    0.235    0.018    0.235    0.018 {built-in method embedding}
        3    0.000    0.000    0.211    0.070 kb.py:68(generate_facts)
        3    0.064    0.021    0.069    0.023 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.293 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  289.293  289.293 simple.py:52(score)
        3    0.000    0.000  289.284   96.428 profilehooks.py:257(new_fn)
        3    0.140    0.047  289.284   96.428 profilehooks.py:348(__call__)
        3    0.011    0.004  288.311   96.104 kb.py:122(neighbors)
        9  285.116   31.680  285.118   31.680 nms.py:31(build)
        2    0.119    0.059  193.306   96.653 kb.py:75(score)
        1    0.000    0.000   95.880   95.880 simple.py:29(hop)
        1    0.042    0.042   95.838   95.838 kb.py:156(forward)
        3    2.634    0.878    2.650    0.883 nms.py:51(query)
       18    0.895    0.050    0.895    0.050 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.215    0.017 functional.py:1774(embedding)
       13    0.215    0.017    0.215    0.017 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.058    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:42.178249

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.637 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.637  290.637 simple.py:52(score)
        3    0.000    0.000  290.628   96.876 profilehooks.py:257(new_fn)
        3    0.138    0.046  290.628   96.876 profilehooks.py:348(__call__)
        3    0.011    0.004  289.567   96.522 kb.py:122(neighbors)
        9  286.845   31.872  286.847   31.872 nms.py:31(build)
        2    0.109    0.055  193.036   96.518 kb.py:75(score)
        1    0.000    0.000   97.495   97.495 simple.py:29(hop)
        1    0.044    0.044   97.454   97.454 kb.py:156(forward)
        3    2.142    0.714    2.158    0.719 nms.py:51(query)
       18    0.987    0.055    0.987    0.055 {built-in method cat}
    18/15    0.001    0.000    0.253    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.247    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.246    0.019 functional.py:1774(embedding)
       13    0.246    0.019    0.246    0.019 {built-in method embedding}
        3    0.000    0.000    0.222    0.074 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.519 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  289.519  289.519 simple.py:52(score)
        3    0.000    0.000  289.510   96.503 profilehooks.py:257(new_fn)
        3    0.148    0.049  289.510   96.503 profilehooks.py:348(__call__)
        3    0.011    0.004  288.518   96.173 kb.py:122(neighbors)
        9  285.487   31.721  285.489   31.721 nms.py:31(build)
        2    0.109    0.055  193.552   96.776 kb.py:75(score)
        1    0.000    0.000   95.851   95.851 simple.py:29(hop)
        1    0.042    0.042   95.810   95.810 kb.py:156(forward)
        3    2.468    0.823    2.483    0.828 nms.py:51(query)
       18    0.902    0.050    0.902    0.050 {built-in method cat}
    18/15    0.001    0.000    0.227    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.220    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.220    0.017 functional.py:1774(embedding)
       13    0.220    0.017    0.220    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.017    0.006 kb.py:62(to_tnsr)
        3    0.017    0.006    0.017    0.006 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:43.832116

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 289.068 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  289.068  289.068 simple.py:52(score)
        3    0.000    0.000  289.058   96.353 profilehooks.py:257(new_fn)
        3    0.138    0.046  289.058   96.353 profilehooks.py:348(__call__)
        3    0.011    0.004  288.052   96.017 kb.py:122(neighbors)
        9  285.195   31.688  285.196   31.688 nms.py:31(build)
        2    0.119    0.059  192.804   96.402 kb.py:75(score)
        1    0.000    0.000   96.157   96.157 simple.py:29(hop)
        1    0.042    0.042   96.116   96.116 kb.py:156(forward)
        3    2.322    0.774    2.338    0.779 nms.py:51(query)
       18    0.894    0.050    0.894    0.050 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.236    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.236    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.213    0.071 kb.py:68(generate_facts)
        3    0.053    0.018    0.057    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.425 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.425  290.425 simple.py:52(score)
        3    0.000    0.000  290.417   96.806 profilehooks.py:257(new_fn)
        3    0.143    0.048  290.417   96.806 profilehooks.py:348(__call__)
        3    0.011    0.004  289.419   96.473 kb.py:122(neighbors)
        9  286.415   31.824  286.417   31.824 nms.py:31(build)
        2    0.123    0.062  193.782   96.891 kb.py:75(score)
        1    0.000    0.000   96.534   96.534 simple.py:29(hop)
        1    0.042    0.042   96.492   96.492 kb.py:156(forward)
        3    2.450    0.817    2.466    0.822 nms.py:51(query)
       18    0.906    0.050    0.906    0.050 {built-in method cat}
    18/15    0.001    0.000    0.224    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.218    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.218    0.017 functional.py:1774(embedding)
       13    0.218    0.017    0.218    0.017 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:43.035452

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.185 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.185  290.185 simple.py:52(score)
        3    0.000    0.000  290.175   96.725 profilehooks.py:257(new_fn)
        3    0.144    0.048  290.175   96.725 profilehooks.py:348(__call__)
        3    0.011    0.004  289.135   96.378 kb.py:122(neighbors)
        9  286.405   31.823  286.407   31.823 nms.py:31(build)
        2    0.122    0.061  193.944   96.972 kb.py:75(score)
        1    0.000    0.000   96.130   96.130 simple.py:29(hop)
        1    0.042    0.042   96.086   96.086 kb.py:156(forward)
        3    2.149    0.716    2.165    0.722 nms.py:51(query)
       18    0.932    0.052    0.932    0.052 {built-in method cat}
    18/15    0.001    0.000    0.268    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.261    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.261    0.020 functional.py:1774(embedding)
       13    0.261    0.020    0.261    0.020 {built-in method embedding}
        3    0.000    0.000    0.235    0.078 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.116 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  291.116  291.116 simple.py:52(score)
        3    0.000    0.000  291.108   97.036 profilehooks.py:257(new_fn)
        3    0.143    0.048  291.108   97.036 profilehooks.py:348(__call__)
        3    0.011    0.004  290.133   96.711 kb.py:122(neighbors)
        9  287.025   31.892  287.027   31.892 nms.py:31(build)
        2    0.128    0.064  194.286   97.143 kb.py:75(score)
        1    0.000    0.000   96.721   96.721 simple.py:29(hop)
        1    0.047    0.047   96.679   96.679 kb.py:156(forward)
        3    2.558    0.853    2.575    0.858 nms.py:51(query)
       18    0.876    0.049    0.876    0.049 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:45.159961

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.930 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.930  290.930 simple.py:52(score)
        3    0.000    0.000  290.920   96.973 profilehooks.py:257(new_fn)
        3    0.154    0.051  290.920   96.973 profilehooks.py:348(__call__)
        3    0.011    0.004  289.812   96.604 kb.py:122(neighbors)
        9  286.847   31.872  286.849   31.872 nms.py:31(build)
        2    0.117    0.058  194.764   97.382 kb.py:75(score)
        1    0.000    0.000   96.044   96.044 simple.py:29(hop)
        1    0.044    0.044   96.001   96.001 kb.py:156(forward)
        3    2.390    0.797    2.407    0.802 nms.py:51(query)
       18    0.990    0.055    0.990    0.055 {built-in method cat}
    18/15    0.001    0.000    0.262    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.255    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.255    0.020 functional.py:1774(embedding)
       13    0.255    0.020    0.255    0.020 {built-in method embedding}
        3    0.000    0.000    0.228    0.076 kb.py:68(generate_facts)
        3    0.058    0.019    0.063    0.021 gaussian.py:28(__call__)
        9    0.026    0.003    0.026    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.935 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  291.935  291.935 simple.py:52(score)
        3    0.000    0.000  291.926   97.309 profilehooks.py:257(new_fn)
        3    0.145    0.048  291.926   97.309 profilehooks.py:348(__call__)
        3    0.012    0.004  290.853   96.951 kb.py:122(neighbors)
        9  287.574   31.953  287.575   31.953 nms.py:31(build)
        2    0.140    0.070  194.934   97.467 kb.py:75(score)
        1    0.000    0.000   96.889   96.889 simple.py:29(hop)
        1    0.044    0.044   96.847   96.847 kb.py:156(forward)
        3    2.716    0.905    2.734    0.911 nms.py:51(query)
       18    0.965    0.054    0.965    0.054 {built-in method cat}
    18/15    0.001    0.000    0.226    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.220    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.220    0.017 functional.py:1774(embedding)
       13    0.219    0.017    0.219    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.058    0.019    0.063    0.021 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:47.026170

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.281 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.281  290.281 simple.py:52(score)
        3    0.000    0.000  290.271   96.757 profilehooks.py:257(new_fn)
        3    0.146    0.049  290.271   96.757 profilehooks.py:348(__call__)
        3    0.011    0.004  289.226   96.409 kb.py:122(neighbors)
        9  286.556   31.840  286.558   31.840 nms.py:31(build)
        2    0.139    0.070  193.758   96.879 kb.py:75(score)
        1    0.000    0.000   96.408   96.408 simple.py:29(hop)
        1    0.042    0.042   96.366   96.366 kb.py:156(forward)
        3    2.121    0.707    2.136    0.712 nms.py:51(query)
       18    0.900    0.050    0.900    0.050 {built-in method cat}
    18/15    0.001    0.000    0.255    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.248    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.247    0.019 functional.py:1774(embedding)
       13    0.247    0.019    0.247    0.019 {built-in method embedding}
        3    0.000    0.000    0.222    0.074 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.029 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  291.029  291.029 simple.py:52(score)
        3    0.000    0.000  291.020   97.007 profilehooks.py:257(new_fn)
        3    0.143    0.048  291.020   97.007 profilehooks.py:348(__call__)
        3    0.011    0.004  289.986   96.662 kb.py:122(neighbors)
        9  286.849   31.872  286.851   31.872 nms.py:31(build)
        2    0.120    0.060  194.349   97.174 kb.py:75(score)
        1    0.000    0.000   96.568   96.568 simple.py:29(hop)
        1    0.042    0.042   96.529   96.529 kb.py:156(forward)
        3    2.564    0.855    2.580    0.860 nms.py:51(query)
       18    0.929    0.052    0.929    0.052 {built-in method cat}
    18/15    0.001    0.000    0.261    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.255    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.255    0.020 functional.py:1774(embedding)
       13    0.255    0.020    0.255    0.020 {built-in method embedding}
        3    0.000    0.000    0.225    0.075 kb.py:68(generate_facts)
        3    0.058    0.019    0.063    0.021 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:45.257718

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 285.708 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  285.708  285.708 simple.py:52(score)
        3    0.000    0.000  285.700   95.233 profilehooks.py:257(new_fn)
        3    0.130    0.043  285.700   95.233 profilehooks.py:348(__call__)
        3    0.011    0.004  284.682   94.894 kb.py:122(neighbors)
        9  281.970   31.330  281.972   31.330 nms.py:31(build)
        2    0.085    0.042  189.137   94.568 kb.py:75(score)
        1    0.000    0.000   96.474   96.474 simple.py:29(hop)
        1    0.042    0.042   96.433   96.433 kb.py:156(forward)
        3    2.168    0.723    2.183    0.728 nms.py:51(query)
       18    0.953    0.053    0.953    0.053 {built-in method cat}
    18/15    0.001    0.000    0.244    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.238    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.238    0.018 functional.py:1774(embedding)
       13    0.238    0.018    0.238    0.018 {built-in method embedding}
        3    0.000    0.000    0.210    0.070 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.086 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.086  292.086 simple.py:52(score)
        3    0.000    0.000  292.077   97.359 profilehooks.py:257(new_fn)
        3    0.136    0.045  292.077   97.359 profilehooks.py:348(__call__)
        3    0.011    0.004  291.190   97.063 kb.py:122(neighbors)
        9  288.120   32.013  288.122   32.014 nms.py:31(build)
        2    0.111    0.056  195.447   97.723 kb.py:75(score)
        1    0.000    0.000   96.536   96.536 simple.py:29(hop)
        1    0.042    0.042   96.494   96.494 kb.py:156(forward)
        3    2.527    0.842    2.544    0.848 nms.py:51(query)
       18    0.813    0.045    0.813    0.045 {built-in method cat}
    18/15    0.001    0.000    0.216    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.210    0.016 functional.py:1774(embedding)
       13    0.210    0.016    0.210    0.016 {built-in method embedding}
        3    0.000    0.000    0.184    0.061 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


Time taken for this batch: 0:09:41.411076

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.524 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  292.524  292.524 simple.py:52(score)
        3    0.000    0.000  292.515   97.505 profilehooks.py:257(new_fn)
        3    0.141    0.047  292.515   97.505 profilehooks.py:348(__call__)
        3    0.011    0.004  291.550   97.183 kb.py:122(neighbors)
        9  288.892   32.099  288.894   32.099 nms.py:31(build)
        2    0.122    0.061  195.527   97.763 kb.py:75(score)
        1    0.000    0.000   96.888   96.888 simple.py:29(hop)
        1    0.042    0.042   96.846   96.846 kb.py:156(forward)
        3    2.096    0.699    2.111    0.704 nms.py:51(query)
       18    0.863    0.048    0.863    0.048 {built-in method cat}
    18/15    0.001    0.000    0.248    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.242    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.215    0.072 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.786 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  291.786  291.786 simple.py:52(score)
        3    0.000    0.000  291.778   97.259 profilehooks.py:257(new_fn)
        3    0.139    0.046  291.778   97.259 profilehooks.py:348(__call__)
        3    0.011    0.004  290.797   96.932 kb.py:122(neighbors)
        9  287.648   31.961  287.650   31.961 nms.py:31(build)
        2    0.122    0.061  195.115   97.558 kb.py:75(score)
        1    0.000    0.000   96.563   96.563 simple.py:29(hop)
        1    0.042    0.042   96.523   96.523 kb.py:156(forward)
        3    2.560    0.853    2.576    0.859 nms.py:51(query)
       18    0.912    0.051    0.912    0.051 {built-in method cat}
    18/15    0.001    0.000    0.239    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.233    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.232    0.018 functional.py:1774(embedding)
       13    0.232    0.018    0.232    0.018 {built-in method embedding}
        3    0.000    0.000    0.192    0.064 kb.py:68(generate_facts)
        3    0.061    0.020    0.066    0.022 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:48.326611

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.256 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  292.256  292.256 simple.py:52(score)
        3    0.000    0.000  292.246   97.415 profilehooks.py:257(new_fn)
        3    0.141    0.047  292.246   97.415 profilehooks.py:348(__call__)
        3    0.011    0.004  291.213   97.071 kb.py:122(neighbors)
        9  288.521   32.058  288.522   32.058 nms.py:31(build)
        2    0.118    0.059  194.927   97.463 kb.py:75(score)
        1    0.000    0.000   97.221   97.221 simple.py:29(hop)
        1    0.044    0.044   97.178   97.178 kb.py:156(forward)
        3    2.106    0.702    2.123    0.708 nms.py:51(query)
       18    0.962    0.053    0.962    0.053 {built-in method cat}
    18/15    0.001    0.000    0.245    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.238    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.238    0.018 functional.py:1774(embedding)
       13    0.238    0.018    0.238    0.018 {built-in method embedding}
        3    0.000    0.000    0.205    0.068 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.387 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.387  292.387 simple.py:52(score)
        3    0.000    0.000  292.378   97.459 profilehooks.py:257(new_fn)
        3    0.139    0.046  292.378   97.459 profilehooks.py:348(__call__)
        3    0.011    0.004  291.355   97.118 kb.py:122(neighbors)
        9  288.162   32.018  288.164   32.018 nms.py:31(build)
        2    0.122    0.061  195.755   97.878 kb.py:75(score)
        1    0.000    0.000   96.525   96.525 simple.py:29(hop)
        1    0.044    0.044   96.483   96.483 kb.py:156(forward)
        3    2.640    0.880    2.656    0.885 nms.py:51(query)
       18    0.916    0.051    0.916    0.051 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.216    0.017 functional.py:1774(embedding)
       13    0.216    0.017    0.216    0.017 {built-in method embedding}
        3    0.000    0.000    0.182    0.061 kb.py:68(generate_facts)
        3    0.071    0.024    0.076    0.025 gaussian.py:28(__call__)
        9    0.030    0.003    0.030    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:48.341571

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.959 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.959  290.959 simple.py:52(score)
        3    0.000    0.000  290.946   96.982 profilehooks.py:257(new_fn)
        3    0.137    0.046  290.946   96.982 profilehooks.py:348(__call__)
        3    0.011    0.004  289.960   96.653 kb.py:122(neighbors)
        9  287.289   31.921  287.291   31.921 nms.py:31(build)
        2    0.111    0.056  193.910   96.955 kb.py:75(score)
        1    0.000    0.000   96.941   96.941 simple.py:29(hop)
        1    0.044    0.044   96.899   96.899 kb.py:156(forward)
        3    2.070    0.690    2.086    0.695 nms.py:51(query)
       18    0.917    0.051    0.917    0.051 {built-in method cat}
    18/15    0.001    0.000    0.261    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.253    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.253    0.019 functional.py:1774(embedding)
       13    0.253    0.019    0.253    0.019 {built-in method embedding}
        3    0.000    0.000    0.225    0.075 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.027    0.003    0.027    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.003 base.py:142(forward)
        2    0.000    0.000    0.007    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.000    0.000    0.006    0.002 kb.py:62(to_tnsr)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.006    0.002    0.006    0.002 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.015 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.015  290.015 simple.py:52(score)
        3    0.000    0.000  290.006   96.669 profilehooks.py:257(new_fn)
        3    0.136    0.045  290.006   96.669 profilehooks.py:348(__call__)
        3    0.011    0.004  289.133   96.378 kb.py:122(neighbors)
        9  286.067   31.785  286.068   31.785 nms.py:31(build)
        2    0.110    0.055  193.573   96.786 kb.py:75(score)
        1    0.000    0.000   96.338   96.338 simple.py:29(hop)
        1    0.042    0.042   96.297   96.297 kb.py:156(forward)
        3    2.507    0.836    2.523    0.841 nms.py:51(query)
       18    0.812    0.045    0.812    0.045 {built-in method cat}
    18/15    0.001    0.000    0.226    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.220    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.220    0.017 functional.py:1774(embedding)
       13    0.220    0.017    0.220    0.017 {built-in method embedding}
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.014    0.005    0.014    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


Time taken for this batch: 0:09:45.085288

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.838 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.838  291.838 simple.py:52(score)
        3    0.000    0.000  291.828   97.276 profilehooks.py:257(new_fn)
        3    0.142    0.047  291.828   97.276 profilehooks.py:348(__call__)
        3    0.011    0.004  290.796   96.932 kb.py:122(neighbors)
        9  288.097   32.011  288.099   32.011 nms.py:31(build)
        2    0.123    0.061  195.329   97.664 kb.py:75(score)
        1    0.000    0.000   96.400   96.400 simple.py:29(hop)
        1    0.043    0.043   96.357   96.357 kb.py:156(forward)
        3    2.136    0.712    2.153    0.718 nms.py:51(query)
       18    0.925    0.051    0.925    0.051 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.243    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.213    0.071 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.787 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.787  292.787 simple.py:52(score)
        3    0.000    0.000  292.778   97.593 profilehooks.py:257(new_fn)
        3    0.143    0.048  292.778   97.593 profilehooks.py:348(__call__)
        3    0.011    0.004  291.847   97.282 kb.py:122(neighbors)
        9  288.872   32.097  288.874   32.097 nms.py:31(build)
        2    0.122    0.061  195.414   97.707 kb.py:75(score)
        1    0.000    0.000   97.263   97.263 simple.py:29(hop)
        1    0.045    0.045   97.221   97.221 kb.py:156(forward)
        3    2.416    0.805    2.433    0.811 nms.py:51(query)
       18    0.846    0.047    0.846    0.047 {built-in method cat}
    18/15    0.001    0.000    0.219    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.213    0.016 functional.py:1774(embedding)
       13    0.213    0.016    0.213    0.016 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.054    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.007    0.002 kb.py:62(to_tnsr)
        3    0.007    0.002    0.007    0.002 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:48.373625

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.650 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.650  293.650 simple.py:52(score)
        3    0.000    0.000  293.640   97.880 profilehooks.py:257(new_fn)
        3    0.134    0.045  293.640   97.880 profilehooks.py:348(__call__)
        3    0.011    0.004  292.611   97.537 kb.py:122(neighbors)
        9  289.858   32.206  289.860   32.207 nms.py:31(build)
        2    0.099    0.049  195.277   97.638 kb.py:75(score)
        1    0.000    0.000   98.275   98.275 simple.py:29(hop)
        1    0.080    0.080   98.229   98.229 kb.py:156(forward)
        3    2.180    0.727    2.196    0.732 nms.py:51(query)
       18    0.956    0.053    0.956    0.053 {built-in method cat}
    18/15    0.001    0.000    0.224    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.216    0.017 functional.py:1774(embedding)
       13    0.216    0.017    0.216    0.017 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.056    0.019    0.060    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.610 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.610  293.610 simple.py:52(score)
        3    0.000    0.000  293.600   97.867 profilehooks.py:257(new_fn)
        3    0.154    0.051  293.600   97.867 profilehooks.py:348(__call__)
        3    0.011    0.004  292.617   97.539 kb.py:122(neighbors)
        9  289.487   32.165  289.488   32.165 nms.py:31(build)
        2    0.127    0.064  195.986   97.993 kb.py:75(score)
        1    0.000    0.000   97.506   97.506 simple.py:29(hop)
        1    0.045    0.045   97.460   97.460 kb.py:156(forward)
        3    2.589    0.863    2.605    0.868 nms.py:51(query)
       18    0.860    0.048    0.860    0.048 {built-in method cat}
    18/15    0.001    0.000    0.226    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.220    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.219    0.017 functional.py:1774(embedding)
       13    0.219    0.017    0.219    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:50.955234

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.075 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.075  293.075 simple.py:52(score)
        3    0.000    0.000  293.064   97.688 profilehooks.py:257(new_fn)
        3    0.141    0.047  293.064   97.688 profilehooks.py:348(__call__)
        3    0.011    0.004  292.026   97.342 kb.py:122(neighbors)
        9  289.257   32.140  289.258   32.140 nms.py:31(build)
        2    0.105    0.053  195.517   97.758 kb.py:75(score)
        1    0.000    0.000   97.452   97.452 simple.py:29(hop)
        1    0.065    0.065   97.406   97.406 kb.py:156(forward)
        3    2.182    0.727    2.198    0.733 nms.py:51(query)
       18    0.938    0.052    0.938    0.052 {built-in method cat}
    18/15    0.001    0.000    0.265    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.257    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.257    0.020 functional.py:1774(embedding)
       13    0.256    0.020    0.256    0.020 {built-in method embedding}
        3    0.000    0.000    0.229    0.076 kb.py:68(generate_facts)
        3    0.057    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.026    0.003    0.026    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.003 base.py:142(forward)
        2    0.000    0.000    0.007    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.459 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  292.459  292.459 simple.py:52(score)
        3    0.000    0.000  292.450   97.483 profilehooks.py:257(new_fn)
        3    0.136    0.045  292.450   97.483 profilehooks.py:348(__call__)
        3    0.011    0.004  291.504   97.168 kb.py:122(neighbors)
        9  288.431   32.048  288.433   32.048 nms.py:31(build)
        2    0.086    0.043  195.672   97.836 kb.py:75(score)
        1    0.000    0.000   96.690   96.690 simple.py:29(hop)
        1    0.069    0.069   96.641   96.641 kb.py:156(forward)
        3    2.502    0.834    2.518    0.839 nms.py:51(query)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.243    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.243    0.019 functional.py:1774(embedding)
       13    0.243    0.019    0.243    0.019 {built-in method embedding}
        3    0.000    0.000    0.218    0.073 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


Time taken for this batch: 0:09:49.109454

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.892 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  290.892  290.892 simple.py:52(score)
        3    0.000    0.000  290.884   96.961 profilehooks.py:257(new_fn)
        3    0.137    0.046  290.884   96.961 profilehooks.py:348(__call__)
        3    0.011    0.004  289.860   96.620 kb.py:122(neighbors)
        9  287.039   31.893  287.040   31.893 nms.py:31(build)
        2    0.085    0.043  194.156   97.078 kb.py:75(score)
        1    0.000    0.000   96.638   96.638 simple.py:29(hop)
        1    0.071    0.071   96.591   96.591 kb.py:156(forward)
        3    2.257    0.752    2.273    0.758 nms.py:51(query)
       18    0.946    0.053    0.946    0.053 {built-in method cat}
    18/15    0.001    0.000    0.219    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.213    0.016 functional.py:1774(embedding)
       13    0.213    0.016    0.213    0.016 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.072    0.024    0.079    0.026 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.684 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  292.684  292.684 simple.py:52(score)
        3    0.000    0.000  292.674   97.558 profilehooks.py:257(new_fn)
        3    0.152    0.051  292.674   97.558 profilehooks.py:348(__call__)
        3    0.011    0.004  291.628   97.209 kb.py:122(neighbors)
        9  288.488   32.054  288.490   32.054 nms.py:31(build)
        2    0.085    0.043  195.679   97.840 kb.py:75(score)
        1    0.000    0.000   96.896   96.896 simple.py:29(hop)
        1    0.079    0.079   96.843   96.843 kb.py:156(forward)
        3    2.544    0.848    2.560    0.853 nms.py:51(query)
       18    0.992    0.055    0.992    0.055 {built-in method cat}
    18/15    0.001    0.000    0.223    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.216    0.017 functional.py:1774(embedding)
       13    0.216    0.017    0.216    0.017 {built-in method embedding}
        3    0.000    0.000    0.189    0.063 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:47.230244

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.268 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.268  293.268 simple.py:52(score)
        3    0.000    0.000  293.258   97.753 profilehooks.py:257(new_fn)
        3    0.138    0.046  293.258   97.753 profilehooks.py:348(__call__)
        3    0.011    0.004  292.185   97.395 kb.py:122(neighbors)
        9  289.485   32.165  289.487   32.165 nms.py:31(build)
        2    0.085    0.043  195.249   97.624 kb.py:75(score)
        1    0.000    0.000   97.922   97.922 simple.py:29(hop)
        1    0.079    0.079   97.872   97.872 kb.py:156(forward)
        3    2.137    0.712    2.153    0.718 nms.py:51(query)
       18    0.955    0.053    0.955    0.053 {built-in method cat}
    18/15    0.001    0.000    0.270    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.262    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.262    0.020 functional.py:1774(embedding)
       13    0.262    0.020    0.262    0.020 {built-in method embedding}
        3    0.000    0.000    0.234    0.078 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.400 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.400  292.400 simple.py:52(score)
        3    0.000    0.000  292.392   97.464 profilehooks.py:257(new_fn)
        3    0.141    0.047  292.392   97.464 profilehooks.py:348(__call__)
        3    0.011    0.004  291.457   97.152 kb.py:122(neighbors)
        9  288.382   32.042  288.383   32.043 nms.py:31(build)
        2    0.091    0.046  194.752   97.376 kb.py:75(score)
        1    0.000    0.000   97.552   97.552 simple.py:29(hop)
        1    0.080    0.080   97.500   97.500 kb.py:156(forward)
        3    2.524    0.841    2.541    0.847 nms.py:51(query)
       18    0.839    0.047    0.839    0.047 {built-in method cat}
    18/15    0.001    0.000    0.225    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.219    0.017 functional.py:1774(embedding)
       13    0.218    0.017    0.218    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:49.588852

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 292.701 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  292.701  292.701 simple.py:52(score)
        3    0.000    0.000  292.692   97.564 profilehooks.py:257(new_fn)
        3    0.141    0.047  292.692   97.564 profilehooks.py:348(__call__)
        3    0.011    0.004  291.656   97.219 kb.py:122(neighbors)
        9  288.975   32.108  288.977   32.109 nms.py:31(build)
        2    0.120    0.060  195.826   97.913 kb.py:75(score)
        1    0.000    0.000   96.766   96.766 simple.py:29(hop)
        1    0.043    0.043   96.725   96.725 kb.py:156(forward)
        3    2.136    0.712    2.152    0.717 nms.py:51(query)
       18    0.891    0.049    0.891    0.049 {built-in method cat}
    18/15    0.001    0.000    0.273    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.267    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.267    0.021 functional.py:1774(embedding)
       13    0.267    0.021    0.267    0.021 {built-in method embedding}
        3    0.000    0.000    0.220    0.073 kb.py:68(generate_facts)
        3    0.055    0.018    0.061    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.401 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.401  293.401 simple.py:52(score)
        3    0.000    0.000  293.393   97.798 profilehooks.py:257(new_fn)
        3    0.141    0.047  293.393   97.798 profilehooks.py:348(__call__)
        3    0.011    0.004  292.367   97.456 kb.py:122(neighbors)
        9  289.135   32.126  289.137   32.126 nms.py:31(build)
        2    0.115    0.057  196.073   98.037 kb.py:75(score)
        1    0.000    0.000   97.219   97.219 simple.py:29(hop)
        1    0.050    0.050   97.179   97.179 kb.py:156(forward)
        3    2.684    0.895    2.700    0.900 nms.py:51(query)
       18    0.939    0.052    0.939    0.052 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.183    0.061 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


Time taken for this batch: 0:09:50.270293

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.897 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.897  293.897 simple.py:52(score)
        3    0.000    0.000  293.886   97.962 profilehooks.py:257(new_fn)
        3    0.145    0.048  293.886   97.962 profilehooks.py:348(__call__)
        3    0.011    0.004  292.806   97.602 kb.py:122(neighbors)
        9  290.015   32.224  290.016   32.224 nms.py:31(build)
        2    0.121    0.061  195.794   97.897 kb.py:75(score)
        1    0.000    0.000   97.994   97.994 simple.py:29(hop)
        1    0.048    0.048   97.947   97.947 kb.py:156(forward)
        3    2.211    0.737    2.228    0.743 nms.py:51(query)
       18    0.988    0.055    0.988    0.055 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.242    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.219    0.073 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.003    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.953 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.953  293.953 simple.py:52(score)
        3    0.000    0.000  293.943   97.981 profilehooks.py:257(new_fn)
        3    0.143    0.048  293.943   97.981 profilehooks.py:348(__call__)
        3    0.011    0.004  292.916   97.639 kb.py:122(neighbors)
        9  289.720   32.191  289.721   32.191 nms.py:31(build)
        2    0.112    0.056  196.155   98.077 kb.py:75(score)
        1    0.000    0.000   97.685   97.685 simple.py:29(hop)
        1    0.042    0.042   97.645   97.645 kb.py:156(forward)
        3    2.626    0.875    2.642    0.881 nms.py:51(query)
       18    0.962    0.053    0.962    0.053 {built-in method cat}
    18/15    0.001    0.000    0.219    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.212    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.066    0.022    0.072    0.024 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        3    0.000    0.000    0.000    0.000 {built-in method exp}


Time taken for this batch: 0:09:51.437926

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.683 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  294.683  294.683 simple.py:52(score)
        3    0.000    0.000  294.672   98.224 profilehooks.py:257(new_fn)
        3    0.134    0.045  294.672   98.224 profilehooks.py:348(__call__)
        3    0.015    0.005  293.600   97.867 kb.py:122(neighbors)
        9  290.725   32.303  290.727   32.303 nms.py:31(build)
        2    0.109    0.054  196.208   98.104 kb.py:75(score)
        1    0.000    0.000   98.370   98.370 simple.py:29(hop)
        1    0.044    0.044   98.330   98.330 kb.py:156(forward)
        3    2.279    0.760    2.296    0.765 nms.py:51(query)
       18    1.006    0.056    1.006    0.056 {built-in method cat}
    18/15    0.001    0.000    0.262    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.255    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.255    0.020 functional.py:1774(embedding)
       13    0.254    0.020    0.254    0.020 {built-in method embedding}
        3    0.000    0.000    0.232    0.077 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.887 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.887  293.887 simple.py:52(score)
        3    0.000    0.000  293.877   97.959 profilehooks.py:257(new_fn)
        3    0.149    0.050  293.877   97.959 profilehooks.py:348(__call__)
        3    0.012    0.004  292.885   97.628 kb.py:122(neighbors)
        9  289.763   32.196  289.765   32.196 nms.py:31(build)
        2    0.091    0.045  196.569   98.285 kb.py:75(score)
        1    0.000    0.000   97.222   97.222 simple.py:29(hop)
        1    0.080    0.080   97.159   97.159 kb.py:156(forward)
        3    2.535    0.845    2.553    0.851 nms.py:51(query)
       18    0.903    0.050    0.903    0.050 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.236    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.236    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.209    0.070 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.017    0.006    0.017    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:52.010540

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.608 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.608  293.608 simple.py:52(score)
        3    0.000    0.000  293.598   97.866 profilehooks.py:257(new_fn)
        3    0.144    0.048  293.598   97.866 profilehooks.py:348(__call__)
        3    0.011    0.004  292.467   97.489 kb.py:122(neighbors)
        9  289.582   32.176  289.583   32.176 nms.py:31(build)
        2    0.085    0.042  195.556   97.778 kb.py:75(score)
        1    0.000    0.000   97.951   97.951 simple.py:29(hop)
        1    0.079    0.079   97.898   97.898 kb.py:156(forward)
        3    2.328    0.776    2.344    0.781 nms.py:51(query)
       18    0.970    0.054    0.970    0.054 {built-in method cat}
    18/15    0.001    0.000    0.265    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.258    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.258    0.020 functional.py:1774(embedding)
       13    0.258    0.020    0.258    0.020 {built-in method embedding}
        3    0.000    0.000    0.218    0.073 kb.py:68(generate_facts)
        3    0.076    0.025    0.082    0.027 gaussian.py:28(__call__)
        9    0.036    0.004    0.036    0.004 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method sum}
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 296.927 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  296.927  296.927 simple.py:52(score)
        3    0.000    0.000  296.915   98.972 profilehooks.py:257(new_fn)
        3    0.136    0.045  296.915   98.972 profilehooks.py:348(__call__)
        3    0.011    0.004  295.821   98.607 kb.py:122(neighbors)
        9  292.392   32.488  292.394   32.488 nms.py:31(build)
        2    0.083    0.042  199.150   99.575 kb.py:75(score)
        1    0.000    0.000   97.677   97.677 simple.py:29(hop)
        1    0.063    0.063   97.629   97.629 kb.py:156(forward)
        3    2.703    0.901    2.720    0.907 nms.py:51(query)
       18    1.156    0.064    1.156    0.064 {built-in method cat}
    18/15    0.001    0.000    0.271    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.264    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.263    0.020 functional.py:1774(embedding)
       13    0.263    0.020    0.263    0.020 {built-in method embedding}
        3    0.000    0.000    0.239    0.080 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:53.842135

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.822 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  291.822  291.822 simple.py:52(score)
        3    0.000    0.000  291.810   97.270 profilehooks.py:257(new_fn)
        3    0.147    0.049  291.810   97.270 profilehooks.py:348(__call__)
        3    0.011    0.004  290.805   96.935 kb.py:122(neighbors)
        9  288.186   32.021  288.187   32.021 nms.py:31(build)
        2    0.140    0.070  195.370   97.685 kb.py:75(score)
        1    0.000    0.000   96.334   96.334 simple.py:29(hop)
        1    0.044    0.044   96.292   96.292 kb.py:156(forward)
        3    2.063    0.688    2.081    0.694 nms.py:51(query)
       18    0.870    0.048    0.870    0.048 {built-in method cat}
    18/15    0.001    0.000    0.249    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.242    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.242    0.019 functional.py:1774(embedding)
       13    0.242    0.019    0.242    0.019 {built-in method embedding}
        3    0.000    0.000    0.216    0.072 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.017    0.006    0.017    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.363 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.363  293.363 simple.py:52(score)
        3    0.000    0.000  293.352   97.784 profilehooks.py:257(new_fn)
        3    0.145    0.048  293.352   97.784 profilehooks.py:348(__call__)
        3    0.011    0.004  292.312   97.437 kb.py:122(neighbors)
        9  289.244   32.138  289.245   32.138 nms.py:31(build)
        2    0.118    0.059  196.916   98.458 kb.py:75(score)
        1    0.000    0.000   96.334   96.334 simple.py:29(hop)
        1    0.042    0.042   96.292   96.292 kb.py:156(forward)
        3    2.523    0.841    2.539    0.846 nms.py:51(query)
       18    0.952    0.053    0.952    0.053 {built-in method cat}
    18/15    0.001    0.000    0.219    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.213    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.213    0.016 functional.py:1774(embedding)
       13    0.212    0.016    0.212    0.016 {built-in method embedding}
        3    0.000    0.000    0.184    0.061 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:49.555708

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.848 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.848  293.848 simple.py:52(score)
        3    0.000    0.000  293.838   97.946 profilehooks.py:257(new_fn)
        3    0.145    0.048  293.837   97.946 profilehooks.py:348(__call__)
        3    0.011    0.004  292.896   97.632 kb.py:122(neighbors)
        9  290.221   32.247  290.223   32.247 nms.py:31(build)
        2    0.120    0.060  195.467   97.733 kb.py:75(score)
        1    0.000    0.000   98.269   98.269 simple.py:29(hop)
        1    0.043    0.043   98.226   98.226 kb.py:156(forward)
        3    2.112    0.704    2.127    0.709 nms.py:51(query)
       18    0.847    0.047    0.847    0.047 {built-in method cat}
    18/15    0.001    0.000    0.242    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.236    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.236    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.210    0.070 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.108 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.108  294.108 simple.py:52(score)
        3    0.000    0.000  294.099   98.033 profilehooks.py:257(new_fn)
        3    0.142    0.047  294.099   98.033 profilehooks.py:348(__call__)
        3    0.011    0.004  293.018   97.673 kb.py:122(neighbors)
        9  289.868   32.208  289.870   32.208 nms.py:31(build)
        2    0.119    0.060  196.664   98.332 kb.py:75(score)
        1    0.000    0.000   97.334   97.334 simple.py:29(hop)
        1    0.042    0.042   97.294   97.294 kb.py:156(forward)
        3    2.560    0.853    2.576    0.859 nms.py:51(query)
       18    1.030    0.057    1.030    0.057 {built-in method cat}
    18/15    0.001    0.000    0.229    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.223    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.223    0.017 functional.py:1774(embedding)
       13    0.223    0.017    0.223    0.017 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


Time taken for this batch: 0:09:52.035238

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.653 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.653  293.653 simple.py:52(score)
        3    0.000    0.000  293.642   97.881 profilehooks.py:257(new_fn)
        3    0.154    0.051  293.642   97.881 profilehooks.py:348(__call__)
        3    0.012    0.004  292.558   97.519 kb.py:122(neighbors)
        9  289.681   32.187  289.682   32.187 nms.py:31(build)
        2    0.118    0.059  196.011   98.005 kb.py:75(score)
        1    0.000    0.000   97.519   97.519 simple.py:29(hop)
        1    0.042    0.042   97.477   97.477 kb.py:156(forward)
        3    2.292    0.764    2.310    0.770 nms.py:51(query)
       18    0.998    0.055    0.998    0.055 {built-in method cat}
    18/15    0.001    0.000    0.242    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.235    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.235    0.018 functional.py:1774(embedding)
       13    0.235    0.018    0.235    0.018 {built-in method embedding}
        3    0.000    0.000    0.206    0.069 kb.py:68(generate_facts)
        3    0.055    0.018    0.061    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.017    0.006    0.017    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.668 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  294.668  294.668 simple.py:52(score)
        3    0.000    0.000  294.657   98.219 profilehooks.py:257(new_fn)
        3    0.165    0.055  294.657   98.219 profilehooks.py:348(__call__)
        3    0.011    0.004  293.588   97.863 kb.py:122(neighbors)
        9  290.567   32.285  290.569   32.285 nms.py:31(build)
        2    0.140    0.070  196.549   98.275 kb.py:75(score)
        1    0.000    0.000   97.999   97.999 simple.py:29(hop)
        1    0.043    0.043   97.943   97.943 kb.py:156(forward)
        3    2.435    0.812    2.451    0.817 nms.py:51(query)
       18    0.957    0.053    0.957    0.053 {built-in method cat}
    18/15    0.001    0.000    0.241    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.234    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.234    0.018 functional.py:1774(embedding)
       13    0.234    0.018    0.234    0.018 {built-in method embedding}
        3    0.000    0.000    0.204    0.068 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:52.312105

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.247 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.247  293.247 simple.py:52(score)
        3    0.000    0.000  293.237   97.746 profilehooks.py:257(new_fn)
        3    0.149    0.050  293.237   97.746 profilehooks.py:348(__call__)
        3    0.011    0.004  292.194   97.398 kb.py:122(neighbors)
        9  289.494   32.166  289.496   32.166 nms.py:31(build)
        2    0.118    0.059  195.846   97.923 kb.py:75(score)
        1    0.000    0.000   97.286   97.286 simple.py:29(hop)
        1    0.043    0.043   97.241   97.241 kb.py:156(forward)
        3    2.123    0.708    2.140    0.713 nms.py:51(query)
       18    0.972    0.054    0.972    0.054 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.185    0.062 kb.py:68(generate_facts)
        3    0.054    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.013    0.004 kb.py:62(to_tnsr)
        3    0.012    0.004    0.012    0.004 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 286.677 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  286.677  286.677 simple.py:52(score)
        3    0.000    0.000  286.669   95.556 profilehooks.py:257(new_fn)
        3    0.123    0.041  286.669   95.556 profilehooks.py:348(__call__)
        3    0.011    0.004  285.801   95.267 kb.py:122(neighbors)
        9  282.766   31.418  282.767   31.419 nms.py:31(build)
        2    0.083    0.042  191.913   95.957 kb.py:75(score)
        1    0.000    0.000   94.667   94.667 simple.py:29(hop)
        1    0.038    0.038   94.633   94.633 kb.py:156(forward)
        3    2.515    0.838    2.531    0.844 nms.py:51(query)
       18    0.827    0.046    0.827    0.046 {built-in method cat}
    18/15    0.001    0.000    0.211    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.206    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.205    0.016 functional.py:1774(embedding)
       13    0.205    0.016    0.205    0.016 {built-in method embedding}
        3    0.000    0.000    0.181    0.060 kb.py:68(generate_facts)
        3    0.055    0.018    0.059    0.020 gaussian.py:28(__call__)
        9    0.019    0.002    0.019    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:44.216954

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.120 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  294.120  294.120 simple.py:52(score)
        3    0.000    0.000  294.112   98.037 profilehooks.py:257(new_fn)
        3    0.146    0.049  294.112   98.037 profilehooks.py:348(__call__)
        3    0.011    0.004  293.124   97.708 kb.py:122(neighbors)
        9  290.363   32.263  290.365   32.263 nms.py:31(build)
        2    0.118    0.059  196.560   98.280 kb.py:75(score)
        1    0.000    0.000   97.448   97.448 simple.py:29(hop)
        1    0.044    0.044   97.406   97.406 kb.py:156(forward)
        3    2.179    0.726    2.195    0.732 nms.py:51(query)
       18    0.939    0.052    0.939    0.052 {built-in method cat}
    18/15    0.001    0.000    0.216    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.210    0.016 functional.py:1774(embedding)
       13    0.210    0.016    0.210    0.016 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.615 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.615  291.615 simple.py:52(score)
        3    0.000    0.000  291.608   97.203 profilehooks.py:257(new_fn)
        3    0.140    0.047  291.608   97.203 profilehooks.py:348(__call__)
        3    0.011    0.004  290.643   96.881 kb.py:122(neighbors)
        9  287.512   31.946  287.514   31.946 nms.py:31(build)
        2    0.105    0.053  195.017   97.509 kb.py:75(score)
        1    0.000    0.000   96.493   96.493 simple.py:29(hop)
        1    0.042    0.042   96.450   96.450 kb.py:156(forward)
        3    2.564    0.855    2.580    0.860 nms.py:51(query)
       18    0.918    0.051    0.918    0.051 {built-in method cat}
    18/15    0.001    0.000    0.221    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.216    0.017 functional.py:1774(embedding)
       13    0.216    0.017    0.216    0.017 {built-in method embedding}
        3    0.000    0.000    0.190    0.063 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.004    0.002 base.py:142(forward)
        2    0.000    0.000    0.004    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:49.558071

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 290.593 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  290.593  290.593 simple.py:52(score)
        3    0.000    0.000  290.584   96.861 profilehooks.py:257(new_fn)
        3    0.129    0.043  290.584   96.861 profilehooks.py:348(__call__)
        3    0.011    0.004  289.699   96.566 kb.py:122(neighbors)
        9  287.130   31.903  287.131   31.903 nms.py:31(build)
        2    0.089    0.044  194.196   97.098 kb.py:75(score)
        1    0.000    0.000   96.300   96.300 simple.py:29(hop)
        1    0.043    0.043   96.259   96.259 kb.py:156(forward)
        3    2.008    0.669    2.025    0.675 nms.py:51(query)
       18    0.837    0.047    0.837    0.047 {built-in method cat}
    18/15    0.001    0.000    0.241    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.235    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.235    0.018 functional.py:1774(embedding)
       13    0.235    0.018    0.235    0.018 {built-in method embedding}
        3    0.000    0.000    0.214    0.071 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.001    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.730 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.730  294.730 simple.py:52(score)
        3    0.000    0.000  294.722   98.241 profilehooks.py:257(new_fn)
        3    0.143    0.048  294.722   98.241 profilehooks.py:348(__call__)
        3    0.012    0.004  293.755   97.918 kb.py:122(neighbors)
        9  290.617   32.291  290.619   32.291 nms.py:31(build)
        2    0.113    0.056  196.726   98.363 kb.py:75(score)
        1    0.000    0.000   97.896   97.896 simple.py:29(hop)
        1    0.047    0.047   97.852   97.852 kb.py:156(forward)
        3    2.553    0.851    2.570    0.857 nms.py:51(query)
       18    0.908    0.050    0.908    0.050 {built-in method cat}
    18/15    0.001    0.000    0.229    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.223    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.222    0.017 functional.py:1774(embedding)
       13    0.222    0.017    0.222    0.017 {built-in method embedding}
        3    0.000    0.000    0.196    0.065 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.000    0.000    0.004    0.001 kb.py:62(to_tnsr)
        3    0.003    0.001    0.003    0.001 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}


Time taken for this batch: 0:09:49.203927

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.422 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  294.422  294.422 simple.py:52(score)
        3    0.000    0.000  294.411   98.137 profilehooks.py:257(new_fn)
        3    0.143    0.048  294.411   98.137 profilehooks.py:348(__call__)
        3    0.011    0.004  293.318   97.773 kb.py:122(neighbors)
        9  290.606   32.290  290.608   32.290 nms.py:31(build)
        2    0.112    0.056  196.929   98.464 kb.py:75(score)
        1    0.000    0.000   97.382   97.382 simple.py:29(hop)
        1    0.042    0.042   97.339   97.339 kb.py:156(forward)
        3    2.092    0.697    2.115    0.705 nms.py:51(query)
       18    1.020    0.057    1.020    0.057 {built-in method cat}
    18/15    0.001    0.000    0.273    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.266    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.266    0.020 functional.py:1774(embedding)
       13    0.266    0.020    0.266    0.020 {built-in method embedding}
        3    0.000    0.000    0.243    0.081 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.022    0.007    0.022    0.007 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.000    0.000    0.004    0.001 kb.py:62(to_tnsr)
        3    0.004    0.001    0.004    0.001 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.256 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  294.256  294.256 simple.py:52(score)
        3    0.000    0.000  294.248   98.083 profilehooks.py:257(new_fn)
        3    0.153    0.051  294.248   98.083 profilehooks.py:348(__call__)
        3    0.011    0.004  293.308   97.769 kb.py:122(neighbors)
        9  290.293   32.255  290.294   32.255 nms.py:31(build)
        2    0.114    0.057  196.447   98.224 kb.py:75(score)
        1    0.000    0.000   97.688   97.688 simple.py:29(hop)
        1    0.043    0.043   97.647   97.647 kb.py:156(forward)
        3    2.436    0.812    2.452    0.817 nms.py:51(query)
       18    0.870    0.048    0.870    0.048 {built-in method cat}
    18/15    0.001    0.000    0.225    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.219    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.218    0.017 functional.py:1774(embedding)
       13    0.218    0.017    0.218    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.057    0.019    0.062    0.021 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:52.567966

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 291.841 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  291.841  291.841 simple.py:52(score)
        3    0.000    0.000  291.831   97.277 profilehooks.py:257(new_fn)
        3    0.150    0.050  291.831   97.277 profilehooks.py:348(__call__)
        3    0.011    0.004  290.768   96.923 kb.py:122(neighbors)
        9  287.946   31.994  287.948   31.994 nms.py:31(build)
        2    0.149    0.075  195.331   97.665 kb.py:75(score)
        1    0.000    0.000   96.393   96.393 simple.py:29(hop)
        1    0.042    0.042   96.350   96.350 kb.py:156(forward)
        3    2.252    0.751    2.269    0.756 nms.py:51(query)
       18    0.931    0.052    0.931    0.052 {built-in method cat}
    18/15    0.001    0.000    0.251    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.245    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.245    0.019 functional.py:1774(embedding)
       13    0.245    0.019    0.245    0.019 {built-in method embedding}
        3    0.000    0.000    0.220    0.073 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.125 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.125  295.125 simple.py:52(score)
        3    0.000    0.000  295.115   98.372 profilehooks.py:257(new_fn)
        3    0.144    0.048  295.115   98.372 profilehooks.py:348(__call__)
        3    0.011    0.004  294.153   98.051 kb.py:122(neighbors)
        9  291.097   32.344  291.099   32.344 nms.py:31(build)
        2    0.116    0.058  197.498   98.749 kb.py:75(score)
        1    0.000    0.000   97.515   97.515 simple.py:29(hop)
        1    0.048    0.048   97.473   97.473 kb.py:156(forward)
        3    2.489    0.830    2.506    0.835 nms.py:51(query)
       18    0.889    0.049    0.889    0.049 {built-in method cat}
    18/15    0.001    0.000    0.223    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.217    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.217    0.017 functional.py:1774(embedding)
       13    0.217    0.017    0.217    0.017 {built-in method embedding}
        3    0.000    0.000    0.191    0.064 kb.py:68(generate_facts)
        3    0.054    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:50.721646

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.695 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.695  293.695 simple.py:52(score)
        3    0.000    0.000  293.684   97.895 profilehooks.py:257(new_fn)
        3    0.130    0.043  293.684   97.895 profilehooks.py:348(__call__)
        3    0.011    0.004  292.770   97.590 kb.py:122(neighbors)
        9  290.099   32.233  290.100   32.233 nms.py:31(build)
        2    0.083    0.041  195.882   97.941 kb.py:75(score)
        1    0.000    0.000   97.714   97.714 simple.py:29(hop)
        1    0.042    0.042   97.673   97.673 kb.py:156(forward)
        3    2.125    0.708    2.142    0.714 nms.py:51(query)
       18    0.864    0.048    0.864    0.048 {built-in method cat}
    18/15    0.001    0.000    0.236    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.230    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.229    0.018 functional.py:1774(embedding)
       13    0.229    0.018    0.229    0.018 {built-in method embedding}
        3    0.000    0.000    0.207    0.069 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.000    0.000    0.000    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.826 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.826  293.826 simple.py:52(score)
        3    0.000    0.000  293.817   97.939 profilehooks.py:257(new_fn)
        3    0.149    0.050  293.817   97.939 profilehooks.py:348(__call__)
        3    0.011    0.004  292.759   97.586 kb.py:122(neighbors)
        9  289.578   32.175  289.579   32.175 nms.py:31(build)
        2    0.116    0.058  196.394   98.197 kb.py:75(score)
        1    0.000    0.000   97.324   97.324 simple.py:29(hop)
        1    0.042    0.042   97.274   97.274 kb.py:156(forward)
        3    2.617    0.872    2.633    0.878 nms.py:51(query)
       18    0.961    0.053    0.961    0.053 {built-in method cat}
    18/15    0.001    0.000    0.233    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.226    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.226    0.017 functional.py:1774(embedding)
       13    0.226    0.017    0.226    0.017 {built-in method embedding}
        3    0.000    0.000    0.199    0.066 kb.py:68(generate_facts)
        3    0.068    0.023    0.073    0.024 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:51.836691

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.151 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.151  295.151 simple.py:52(score)
        3    0.000    0.000  295.140   98.380 profilehooks.py:257(new_fn)
        3    0.151    0.050  295.140   98.380 profilehooks.py:348(__call__)
        3    0.012    0.004  294.109   98.036 kb.py:122(neighbors)
        9  291.335   32.371  291.337   32.371 nms.py:31(build)
        2    0.146    0.073  196.879   98.440 kb.py:75(score)
        1    0.000    0.000   98.153   98.153 simple.py:29(hop)
        1    0.042    0.042   98.110   98.110 kb.py:156(forward)
        3    2.189    0.730    2.208    0.736 nms.py:51(query)
       18    0.933    0.052    0.933    0.052 {built-in method cat}
    18/15    0.001    0.000    0.229    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.222    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.222    0.017 functional.py:1774(embedding)
       13    0.222    0.017    0.222    0.017 {built-in method embedding}
        3    0.000    0.000    0.197    0.066 kb.py:68(generate_facts)
        3    0.056    0.019    0.061    0.020 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.017    0.006    0.017    0.006 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.378 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.378  293.378 simple.py:52(score)
        3    0.000    0.000  293.370   97.790 profilehooks.py:257(new_fn)
        3    0.143    0.048  293.370   97.790 profilehooks.py:348(__call__)
        3    0.011    0.004  292.428   97.476 kb.py:122(neighbors)
        9  289.391   32.155  289.393   32.155 nms.py:31(build)
        2    0.117    0.059  196.073   98.036 kb.py:75(score)
        1    0.000    0.000   97.194   97.194 simple.py:29(hop)
        1    0.042    0.042   97.154   97.154 kb.py:156(forward)
        3    2.474    0.825    2.490    0.830 nms.py:51(query)
       18    0.867    0.048    0.867    0.048 {built-in method cat}
    18/15    0.001    0.000    0.227    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.221    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.220    0.017 functional.py:1774(embedding)
       13    0.220    0.017    0.220    0.017 {built-in method embedding}
        3    0.000    0.000    0.195    0.065 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.004    0.001 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:52.101315

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.471 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  295.471  295.471 simple.py:52(score)
        3    0.000    0.000  295.459   98.486 profilehooks.py:257(new_fn)
        3    0.144    0.048  295.459   98.486 profilehooks.py:348(__call__)
        3    0.011    0.004  294.409   98.136 kb.py:122(neighbors)
        9  291.622   32.402  291.624   32.403 nms.py:31(build)
        2    0.117    0.058  197.013   98.507 kb.py:75(score)
        1    0.000    0.000   98.345   98.345 simple.py:29(hop)
        1    0.043    0.043   98.302   98.302 kb.py:156(forward)
        3    2.231    0.744    2.247    0.749 nms.py:51(query)
       18    0.927    0.051    0.927    0.051 {built-in method cat}
    18/15    0.001    0.000    0.271    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.263    0.020 sparse.py:123(forward)
       13    0.000    0.000    0.263    0.020 functional.py:1774(embedding)
       13    0.263    0.020    0.263    0.020 {built-in method embedding}
        3    0.000    0.000    0.235    0.078 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.248 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  294.248  294.248 simple.py:52(score)
        3    0.000    0.000  294.239   98.080 profilehooks.py:257(new_fn)
        3    0.142    0.047  294.239   98.080 profilehooks.py:348(__call__)
        3    0.011    0.004  293.254   97.751 kb.py:122(neighbors)
        9  290.134   32.237  290.135   32.237 nms.py:31(build)
        2    0.111    0.056  196.970   98.485 kb.py:75(score)
        1    0.000    0.000   97.169   97.169 simple.py:29(hop)
        1    0.042    0.042   97.127   97.127 kb.py:156(forward)
        3    2.567    0.856    2.583    0.861 nms.py:51(query)
       18    0.921    0.051    0.921    0.051 {built-in method cat}
    18/15    0.001    0.000    0.216    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.210    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.210    0.016 functional.py:1774(embedding)
       13    0.210    0.016    0.210    0.016 {built-in method embedding}
        3    0.000    0.000    0.187    0.062 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {built-in method exp}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}


Time taken for this batch: 0:09:53.927056

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.897 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.897  293.897 simple.py:52(score)
        3    0.000    0.000  293.885   97.962 profilehooks.py:257(new_fn)
        3    0.141    0.047  293.885   97.962 profilehooks.py:348(__call__)
        3    0.011    0.004  292.899   97.633 kb.py:122(neighbors)
        9  290.168   32.241  290.169   32.241 nms.py:31(build)
        2    0.111    0.056  196.045   98.022 kb.py:75(score)
        1    0.000    0.000   97.741   97.741 simple.py:29(hop)
        1    0.042    0.042   97.699   97.699 kb.py:156(forward)
        3    2.153    0.718    2.169    0.723 nms.py:51(query)
       18    0.889    0.049    0.889    0.049 {built-in method cat}
    18/15    0.001    0.000    0.276    0.018 module.py:715(_call_impl)
       13    0.000    0.000    0.269    0.021 sparse.py:123(forward)
       13    0.000    0.000    0.268    0.021 functional.py:1774(embedding)
       13    0.268    0.021    0.268    0.021 {built-in method embedding}
        3    0.000    0.000    0.237    0.079 kb.py:68(generate_facts)
        3    0.053    0.018    0.057    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.003 base.py:142(forward)
        2    0.000    0.000    0.007    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 294.989 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  294.989  294.989 simple.py:52(score)
        3    0.000    0.000  294.980   98.327 profilehooks.py:257(new_fn)
        3    0.153    0.051  294.979   98.326 profilehooks.py:348(__call__)
        3    0.012    0.004  293.971   97.990 kb.py:122(neighbors)
        9  290.773   32.308  290.775   32.308 nms.py:31(build)
        2    0.122    0.061  196.892   98.446 kb.py:75(score)
        1    0.000    0.000   97.977   97.977 simple.py:29(hop)
        1    0.044    0.044   97.935   97.935 kb.py:156(forward)
        3    2.624    0.875    2.641    0.880 nms.py:51(query)
       18    0.911    0.051    0.911    0.051 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.237    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.237    0.018 functional.py:1774(embedding)
       13    0.237    0.018    0.237    0.018 {built-in method embedding}
        3    0.000    0.000    0.212    0.071 kb.py:68(generate_facts)
        3    0.053    0.018    0.058    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:52.161992

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.826 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  293.826  293.826 simple.py:52(score)
        3    0.000    0.000  293.814   97.938 profilehooks.py:257(new_fn)
        3    0.143    0.048  293.814   97.938 profilehooks.py:348(__call__)
        3    0.011    0.004  292.704   97.568 kb.py:122(neighbors)
        9  289.978   32.220  289.980   32.220 nms.py:31(build)
        2    0.112    0.056  196.175   98.087 kb.py:75(score)
        1    0.000    0.000   97.538   97.538 simple.py:29(hop)
        1    0.042    0.042   97.495   97.495 kb.py:156(forward)
        3    2.157    0.719    2.172    0.724 nms.py:51(query)
       18    0.977    0.054    0.977    0.054 {built-in method cat}
    18/15    0.001    0.000    0.300    0.020 module.py:715(_call_impl)
       13    0.000    0.000    0.292    0.022 sparse.py:123(forward)
       13    0.000    0.000    0.292    0.022 functional.py:1774(embedding)
       13    0.292    0.022    0.292    0.022 {built-in method embedding}
        3    0.000    0.000    0.268    0.089 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.024    0.003    0.024    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.007    0.004 base.py:142(forward)
        2    0.000    0.000    0.007    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.006    0.002    0.006    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       12    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.160 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.160  295.160 simple.py:52(score)
        3    0.000    0.000  295.151   98.384 profilehooks.py:257(new_fn)
        3    0.151    0.050  295.151   98.384 profilehooks.py:348(__call__)
        3    0.011    0.004  294.171   98.057 kb.py:122(neighbors)
        9  290.766   32.307  290.768   32.308 nms.py:31(build)
        2    0.117    0.059  197.568   98.784 kb.py:75(score)
        1    0.000    0.000   97.475   97.475 simple.py:29(hop)
        1    0.044    0.044   97.432   97.432 kb.py:156(forward)
        3    2.853    0.951    2.869    0.956 nms.py:51(query)
       18    0.898    0.050    0.898    0.050 {built-in method cat}
    18/15    0.001    0.000    0.217    0.014 module.py:715(_call_impl)
       13    0.000    0.000    0.211    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.210    0.016 functional.py:1774(embedding)
       13    0.210    0.016    0.210    0.016 {built-in method embedding}
        3    0.000    0.000    0.186    0.062 kb.py:68(generate_facts)
        3    0.051    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:52.702069

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.624 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.624  293.624 simple.py:52(score)
        3    0.000    0.000  293.614   97.871 profilehooks.py:257(new_fn)
        3    0.130    0.043  293.614   97.871 profilehooks.py:348(__call__)
        3    0.011    0.004  292.688   97.563 kb.py:122(neighbors)
        9  289.989   32.221  289.991   32.221 nms.py:31(build)
        2    0.086    0.043  195.803   97.902 kb.py:75(score)
        1    0.000    0.000   97.723   97.723 simple.py:29(hop)
        1    0.045    0.045   97.681   97.681 kb.py:156(forward)
        3    2.145    0.715    2.162    0.721 nms.py:51(query)
       18    0.866    0.048    0.866    0.048 {built-in method cat}
    18/15    0.001    0.000    0.246    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.239    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.239    0.018 functional.py:1774(embedding)
       13    0.239    0.018    0.239    0.018 {built-in method embedding}
        3    0.000    0.000    0.214    0.071 kb.py:68(generate_facts)
        3    0.052    0.017    0.056    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.000    0.000    0.003    0.001 kb.py:62(to_tnsr)
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        3    0.003    0.001    0.003    0.001 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.896 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.896  293.896 simple.py:52(score)
        3    0.000    0.000  293.887   97.962 profilehooks.py:257(new_fn)
        3    0.142    0.047  293.887   97.962 profilehooks.py:348(__call__)
        3    0.011    0.004  292.889   97.630 kb.py:122(neighbors)
        9  289.726   32.192  289.727   32.192 nms.py:31(build)
        2    0.113    0.057  196.718   98.359 kb.py:75(score)
        1    0.000    0.000   97.069   97.069 simple.py:29(hop)
        1    0.041    0.041   97.027   97.027 kb.py:156(forward)
        3    2.598    0.866    2.613    0.871 nms.py:51(query)
       18    0.945    0.052    0.945    0.052 {built-in method cat}
    18/15    0.001    0.000    0.218    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.212    0.016 sparse.py:123(forward)
       13    0.000    0.000    0.211    0.016 functional.py:1774(embedding)
       13    0.211    0.016    0.211    0.016 {built-in method embedding}
        3    0.000    0.000    0.188    0.063 kb.py:68(generate_facts)
        3    0.053    0.018    0.057    0.019 gaussian.py:28(__call__)
        9    0.021    0.002    0.021    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.000    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)


Time taken for this batch: 0:09:51.791771

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 293.718 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  293.718  293.718 simple.py:52(score)
        3    0.000    0.000  293.705   97.902 profilehooks.py:257(new_fn)
        3    0.145    0.048  293.705   97.902 profilehooks.py:348(__call__)
        3    0.011    0.004  292.641   97.547 kb.py:122(neighbors)
        9  289.805   32.201  289.807   32.201 nms.py:31(build)
        2    0.118    0.059  196.881   98.441 kb.py:75(score)
        1    0.000    0.000   96.721   96.721 simple.py:29(hop)
        1    0.044    0.044   96.678   96.678 kb.py:156(forward)
        3    2.271    0.757    2.288    0.763 nms.py:51(query)
       18    0.956    0.053    0.956    0.053 {built-in method cat}
    18/15    0.001    0.000    0.262    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.252    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.252    0.019 functional.py:1774(embedding)
       13    0.252    0.019    0.252    0.019 {built-in method embedding}
        3    0.000    0.000    0.227    0.076 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.016    0.005    0.016    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.009    0.004 base.py:142(forward)
        2    0.000    0.000    0.009    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.009    0.003 linear.py:92(forward)
        3    0.000    0.000    0.009    0.003 functional.py:1669(linear)
        3    0.008    0.003    0.008    0.003 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 297.697 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  297.697  297.697 simple.py:52(score)
        3    0.000    0.000  297.689   99.230 profilehooks.py:257(new_fn)
        3    0.137    0.046  297.689   99.230 profilehooks.py:348(__call__)
        3    0.010    0.003  296.741   98.914 kb.py:122(neighbors)
        9  293.602   32.622  293.603   32.623 nms.py:31(build)
        2    0.086    0.043  199.425   99.712 kb.py:75(score)
        1    0.000    0.000   98.175   98.175 simple.py:29(hop)
        1    0.062    0.062   98.127   98.127 kb.py:156(forward)
        3    2.582    0.861    2.598    0.866 nms.py:51(query)
       18    0.888    0.049    0.888    0.049 {built-in method cat}
    18/15    0.001    0.000    0.228    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.222    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.222    0.017 functional.py:1774(embedding)
       13    0.221    0.017    0.221    0.017 {built-in method embedding}
        3    0.000    0.000    0.194    0.065 kb.py:68(generate_facts)
        3    0.052    0.017    0.057    0.019 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.002 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.004    0.001 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:55.429071

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.678 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.678  295.678 simple.py:52(score)
        3    0.000    0.000  295.669   98.556 profilehooks.py:257(new_fn)
        3    0.149    0.050  295.668   98.556 profilehooks.py:348(__call__)
        3    0.011    0.004  294.682   98.227 kb.py:122(neighbors)
        9  291.916   32.435  291.918   32.435 nms.py:31(build)
        2    0.084    0.042  197.816   98.908 kb.py:75(score)
        1    0.000    0.000   97.756   97.756 simple.py:29(hop)
        1    0.072    0.072   97.703   97.703 kb.py:156(forward)
        3    2.204    0.735    2.220    0.740 nms.py:51(query)
       18    0.889    0.049    0.889    0.049 {built-in method cat}
    18/15    0.001    0.000    0.243    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.237    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.237    0.018 functional.py:1774(embedding)
       13    0.236    0.018    0.236    0.018 {built-in method embedding}
        3    0.000    0.000    0.213    0.071 kb.py:68(generate_facts)
        3    0.055    0.018    0.060    0.020 gaussian.py:28(__call__)
        9    0.023    0.003    0.023    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.736 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  295.736  295.736 simple.py:52(score)
        3    0.000    0.000  295.725   98.575 profilehooks.py:257(new_fn)
        3    0.141    0.047  295.725   98.575 profilehooks.py:348(__call__)
        3    0.011    0.004  294.707   98.236 kb.py:122(neighbors)
        9  291.438   32.382  291.440   32.382 nms.py:31(build)
        2    0.085    0.042  197.228   98.614 kb.py:75(score)
        1    0.000    0.000   98.405   98.405 simple.py:29(hop)
        1    0.065    0.065   98.355   98.355 kb.py:156(forward)
        3    2.674    0.891    2.690    0.897 nms.py:51(query)
       18    0.951    0.053    0.951    0.053 {built-in method cat}
    18/15    0.001    0.000    0.256    0.017 module.py:715(_call_impl)
       13    0.000    0.000    0.249    0.019 sparse.py:123(forward)
       13    0.000    0.000    0.249    0.019 functional.py:1774(embedding)
       13    0.248    0.019    0.248    0.019 {built-in method embedding}
        3    0.000    0.000    0.220    0.073 kb.py:68(generate_facts)
        3    0.058    0.019    0.063    0.021 gaussian.py:28(__call__)
        9    0.025    0.003    0.025    0.003 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.015    0.005    0.015    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.006    0.003 base.py:142(forward)
        2    0.000    0.000    0.006    0.003 base.py:143(<listcomp>)
        3    0.000    0.000    0.006    0.002 linear.py:92(forward)
        3    0.000    0.000    0.006    0.002 functional.py:1669(linear)
        3    0.005    0.002    0.005    0.002 {built-in method addmm}
        3    0.004    0.001    0.004    0.001 {built-in method sum}
        4    0.000    0.000    0.003    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.001 sparse.py:92(__init__)
        3    0.000    0.000    0.002    0.001 kb.py:62(to_tnsr)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        5    0.001    0.000    0.001    0.000 {built-in method max}
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.001    0.000    0.001    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:55.058694

*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.543 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  295.543  295.543 simple.py:52(score)
        3    0.000    0.000  295.531   98.510 profilehooks.py:257(new_fn)
        3    0.153    0.051  295.531   98.510 profilehooks.py:348(__call__)
        3    0.010    0.003  294.569   98.190 kb.py:122(neighbors)
        9  291.955   32.439  291.956   32.440 nms.py:31(build)
        2    0.123    0.061  196.610   98.305 kb.py:75(score)
        1    0.000    0.000   98.814   98.814 simple.py:29(hop)
        1    0.042    0.042   98.768   98.768 kb.py:156(forward)
        3    2.020    0.673    2.035    0.678 nms.py:51(query)
       18    0.887    0.049    0.887    0.049 {built-in method cat}
    18/15    0.001    0.000    0.247    0.016 module.py:715(_call_impl)
       13    0.000    0.000    0.239    0.018 sparse.py:123(forward)
       13    0.000    0.000    0.238    0.018 functional.py:1774(embedding)
       13    0.238    0.018    0.238    0.018 {built-in method embedding}
        3    0.000    0.000    0.217    0.072 kb.py:68(generate_facts)
        3    0.047    0.016    0.052    0.017 gaussian.py:28(__call__)
        9    0.022    0.002    0.022    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.014    0.005    0.014    0.005 {built-in method numpy.array}
        3    0.000    0.000    0.009    0.003 kb.py:62(to_tnsr)
        3    0.009    0.003    0.009    0.003 {method 'type' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.007    0.004 base.py:142(forward)
        2    0.000    0.000    0.007    0.004 base.py:143(<listcomp>)
        3    0.000    0.000    0.007    0.002 linear.py:92(forward)
        3    0.000    0.000    0.007    0.002 functional.py:1669(linear)
        3    0.007    0.002    0.007    0.002 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.001 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
      198    0.000    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
        4    0.000    0.000    0.000    0.000 module.py:294(register_parameter)



*** PROFILER RESULTS ***
score (/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/ctp-0.9-py3.6.egg/kbcr/smart/simple.py:52)
function called 1 times

         1553 function calls (1550 primitive calls) in 295.258 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 75 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  295.257  295.257 simple.py:52(score)
        3    0.000    0.000  295.249   98.416 profilehooks.py:257(new_fn)
        3    0.150    0.050  295.249   98.416 profilehooks.py:348(__call__)
        3    0.010    0.003  294.209   98.070 kb.py:122(neighbors)
        9  291.169   32.352  291.171   32.352 nms.py:31(build)
        2    0.114    0.057  197.505   98.753 kb.py:75(score)
        1    0.000    0.000   97.638   97.638 simple.py:29(hop)
        1    0.042    0.042   97.594   97.594 kb.py:156(forward)
        3    2.478    0.826    2.493    0.831 nms.py:51(query)
       18    0.977    0.054    0.977    0.054 {built-in method cat}
    18/15    0.001    0.000    0.222    0.015 module.py:715(_call_impl)
       13    0.000    0.000    0.216    0.017 sparse.py:123(forward)
       13    0.000    0.000    0.215    0.017 functional.py:1774(embedding)
       13    0.215    0.017    0.215    0.017 {built-in method embedding}
        3    0.000    0.000    0.193    0.064 kb.py:68(generate_facts)
        3    0.047    0.016    0.052    0.017 gaussian.py:28(__call__)
        9    0.020    0.002    0.020    0.002 {method 'repeat' of 'torch._C._TensorBase' objects}
        3    0.014    0.005    0.014    0.005 {built-in method numpy.array}
        2    0.000    0.000    0.005    0.003 base.py:142(forward)
        2    0.000    0.000    0.005    0.002 base.py:143(<listcomp>)
        3    0.000    0.000    0.005    0.002 linear.py:92(forward)
        3    0.000    0.000    0.005    0.002 functional.py:1669(linear)
        3    0.004    0.001    0.004    0.001 {built-in method addmm}
        3    0.003    0.001    0.003    0.001 {built-in method sum}
        4    0.000    0.000    0.002    0.000 sparse.py:142(from_pretrained)
        4    0.000    0.000    0.002    0.000 sparse.py:92(__init__)
        3    0.000    0.000    0.001    0.000 kb.py:62(to_tnsr)
      198    0.000    0.000    0.001    0.000 __init__.py:1298(info)
       75    0.001    0.000    0.001    0.000 module.py:781(__setattr__)
        3    0.001    0.000    0.001    0.000 nms.py:55(<listcomp>)
        5    0.001    0.000    0.001    0.000 {built-in method max}
        3    0.001    0.000    0.001    0.000 {method 'type' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      198    0.001    0.000    0.001    0.000 __init__.py:1544(isEnabledFor)
        3    0.001    0.000    0.001    0.000 {built-in method sqrt}
        4    0.000    0.000    0.001    0.000 module.py:223(__init__)
        9    0.001    0.000    0.001    0.000 {built-in method nmslib.init}
        3    0.000    0.000    0.000    0.000 {built-in method clamp}
       44    0.000    0.000    0.000    0.000 module.py:765(__getattr__)


Time taken for this batch: 0:09:53.844248
INFO:hoppy-transe-cli.py:Final 	test results	MRR 0.678072	H@1 0.513412	H@3 0.816549	H@5 0.941146	H@10 0.992109
INFO:hoppy-transe-cli.py:Training finished
/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729128610/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() > 0
/home/baadalvm/anaconda3/envs/tf/lib/python3.6/site-packages/torch/nn/modules/container.py:434: UserWarning: Setting attributes on ParameterList is not supported.
  warnings.warn("Setting attributes on ParameterList is not supported.")
